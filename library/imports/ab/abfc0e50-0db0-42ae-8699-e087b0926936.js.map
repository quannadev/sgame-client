{"version":3,"sources":["assets/scripts/portal/UIPayment.js"],"names":["cc","Class","VozBaseComponent","properties","edit_user_re","EditBox","edit_user_re_again","edit_money","lbTyLe","Label","lbMyMoney","lbMoneyRev","lbTienTe","lbDesTrans","warningNode","Node","lbIsDaiLy","lbNickName","lbGold","lbDes","_area","_moneyConvert","_isDaiLy","listDaiLy","onEnable","SmartFoxSDK","PortalController","ZoneInstance","addEventListenerExtension","CasinoEvent","RESPONSE_NAME","LIST_AGENCY_RES","onListAgency","request","CasinoRequest","ListAgencyRequest","send","toSRequest","node","zIndex","lastZIndex","_data","nickname","setLastArea","area","updateDaiLyInfo","agName","active","getLastArea","updateTyLe","string","Utils","addDotToNumber","GameVariables","getChip","mySelf","onDisable","removeEventListenerExtension","event","mm","Loading","hide","ListAgencyEvent","fromEvent","changeMoney","editBox","Math","floor","parseFloat","eventClose","back","audio","playButton","username","clickTransferMoney","Toast","showToast","parseInt","showInfoWaring","agenName","undefined","eventShowDaiLys","show","pop","src","eventChangeArea","localStorage","sys","setItem","getItem","eventDongY","TransferMoneyRequest","setMoneyTransfer","setUserRecived","eventCancel","eventGetInfoDaiLy","nickName","length","i","name","zone"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.VozBaseComponent,\n\n    properties: {\n        edit_user_re: cc.EditBox,\n        edit_user_re_again: cc.EditBox,\n        edit_money: cc.EditBox,\n        lbTyLe: cc.Label,\n        lbMyMoney: cc.Label,\n        lbMoneyRev: cc.Label,\n        lbTienTe: cc.Label,\n        lbDesTrans: cc.Label,\n        warningNode: cc.Node,\n        lbIsDaiLy: cc.Label,\n        lbNickName: cc.Label,\n        lbGold: cc.Label,\n        lbDes: cc.Label,\n        _area: \"ja\",\n        _moneyConvert: 0,\n        _isDaiLy: false,\n        listDaiLy: []\n    },\n    onEnable(){\n        this.listDaiLy = [];\n        SmartFoxSDK.PortalController.ZoneInstance.addEventListenerExtension(CasinoEvent.RESPONSE_NAME.LIST_AGENCY_RES, this.onListAgency, this);\n        let request = new CasinoRequest.ListAgencyRequest();\n        SmartFoxSDK.PortalController.ZoneInstance.send(request.toSRequest());\n\n        if (this.node.zIndex <= cc.lastZIndex){\n            this.node.zIndex = cc.lastZIndex+1;\n        }\n        if (this._data.nickname != null){\n            this.setLastArea(this._data.area);\n            this.updateDaiLyInfo(this._data.nickname, this._data.agName);\n        }\n        this.warningNode.active = false;\n        this._area = this.getLastArea();\n        this.updateTyLe();\n        this.lbMyMoney.string = Utils.addDotToNumber(GameVariables.getChip(SmartFoxSDK.PortalController.ZoneInstance.mySelf));;\n    },\n    onDisable(){\n        SmartFoxSDK.PortalController.ZoneInstance.removeEventListenerExtension(CasinoEvent.RESPONSE_NAME.LIST_AGENCY_RES, this.onListAgency, this);\n    },\n    onListAgency(event){\n        mm.Loading.hide();\n        this.listDaiLy = new CasinoEvent.ListAgencyEvent().fromEvent(event);\n    },\n    changeMoney(editBox) {\n        if (editBox == \"\")\n            this.lbMoneyRev.string = \"0\";\n        else\n            this.lbMoneyRev.string = Utils.addDotToNumber(Math.floor(parseFloat(editBox))/this._moneyConvert);\n    },\n    eventClose(){\n        this.back();\n        mm.audio.playButton();\n    },\n    updateDaiLyInfo(username, agName) {\n        this.edit_user_re.string        = username;\n        this.edit_user_re_again.string  = username;\n        this.lbDesTrans.string  = \"Bán GOLD cho \"+agName;\n        this._data.agName = agName;\n    },\n    updateTyLe() {\n        if (this._area == \"ja\"){\n            this.lbTyLe.string   = \"Tỉ lệ quy đổi: 1YEN = 226.8\";\n            this.lbTienTe.string = \"YEN\";\n            this._moneyConvert   =  226.8;\n        }else {\n            this.lbTyLe.string = \"Tỉ lệ quy đổi: 1WON = 20.52\";\n            this.lbTienTe.string = \"WON\";\n            this._moneyConvert   = 20.52;\n        }\n    },\n    clickTransferMoney(event){\n        mm.audio.playButton();\n        if(this.edit_user_re.string == \"\"){\n            mm.Toast.showToast(1, \"Tên người nhận không được trống\");\n            return;\n        }\n        // if(this.edit_user_re.string != this.edit_user_re_again.string){\n        //     mm.Toast.showToast(1, \"Nickname không khớp\");\n        //     return;\n        // }\n        if(this.edit_money.string == \"\"){\n            mm.Toast.showToast(1, \"Tiền không được trống\");\n            return;\n        }\n        if(parseInt(this.edit_money.string) < 10000){\n            mm.Toast.showToast(1, \"Tiền phải lớn hơn 10.000\");\n            return;\n        }\n        this.showInfoWaring(this._data.agName);\n    },\n    showInfoWaring(agenName) {\n        if (agenName == undefined)\n            agenName = \"Không xác định!\";\n        this.warningNode.active = true;\n        this.lbIsDaiLy.node.active = !this._isDaiLy;\n        this.lbDes.string = \"Chuyên GOLD cho \"+agenName;\n        this.lbNickName.string = this.edit_user_re.string;\n        this.lbGold.string     = Utils.addDotToNumber(this.edit_money.string) + \" GOLD\";\n    },\n    eventShowDaiLys() {\n        this.show(\"UIDaiLy\", {pop: true, src: 'portal'});\n    },\n    eventChangeArea() {\n        if ( this._area == \"ja\")\n            this.setLastArea(\"ko\");\n        else\n            this.setLastArea(\"ja\");\n        this._area = this.getLastArea();\n        this.updateTyLe();\n        this.changeMoney(this.edit_money.string);\n    },\n    setLastArea(area) {\n        var localStorage = cc.sys.localStorage;\n        localStorage.setItem(\"last_area\", area);\n    },\n    getLastArea() {\n        let localStorage = cc.sys.localStorage;\n        if (localStorage.getItem(\"last_area\") === null || localStorage.getItem(\"last_area\") === undefined) {\n            localStorage.setItem(\"last_area\", \"ja\");\n        }\n        return localStorage.getItem(\"last_area\");\n    },\n    eventDongY() {\n        let request = new CasinoRequest.TransferMoneyRequest();\n        request.setMoneyTransfer(parseInt(this.edit_money.string));\n        request.setUserRecived(this.edit_user_re.string);\n        SmartFoxSDK.PortalController.ZoneInstance.send(request.toSRequest());\n        mm.Loading.show();\n        this.eventCancel();\n    },\n    eventCancel() {\n        this.warningNode.active = false;\n    },\n    eventGetInfoDaiLy() {\n        this._isDaiLy = false;\n        let nickName = this.edit_user_re.string;\n        if (this.listDaiLy.length > 0){\n            for (let i=0; i< this.listDaiLy.length; i++){\n                if (nickName == this.listDaiLy[i].name){\n                    this._isDaiLy = true;\n                    this._area = this.listDaiLy[i].zone;\n                    this.updateDaiLyInfo(this.listDaiLy[i].name, this.listDaiLy[i].agName);\n                    this.updateTyLe();\n                    this.lbMyMoney.string = Utils.addDotToNumber(GameVariables.getChip(SmartFoxSDK.PortalController.ZoneInstance.mySelf));;\n\n                }\n            }\n        }\n    }\n\n});\n"]}