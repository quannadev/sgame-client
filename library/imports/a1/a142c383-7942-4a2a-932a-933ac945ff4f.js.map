{"version":3,"sources":["assets/_smartfox/hotupdate/HoiXoayServer.js"],"names":["customManifestStr","JSON","stringify","cc","Class","Component","properties","manifestUrl","type","Asset","processLoad","ProgressBar","lbLoading","Label","lbUpdate","_updating","_canRetry","_storagePath","_addEventFinish","checkCb","event","getEventCode","jsb","EventAssetsManager","ERROR_NO_LOCAL_MANIFEST","ERROR_DOWNLOAD_MANIFEST","ERROR_PARSE_MANIFEST","ALREADY_UP_TO_DATE","NEW_VERSION_FOUND","progress","string","_am","setEventCallback","_checkListener","updateCb","needRestart","failed","UPDATE_PROGRESSION","percent","parseFloat","getPercent","isNaN","Math","floor","UPDATE_FINISHED","UPDATE_FAILED","ERROR_UPDATING","ERROR_DECOMPRESS","_updateListener","searchPaths","fileUtils","getSearchPaths","newPaths","getLocalManifest","Array","prototype","unshift","apply","sys","localStorage","setItem","setSearchPaths","audioEngine","stopAll","game","restart","loadCustomManifest","getState","AssetsManager","State","UNINITED","manifest","Manifest","loadLocalManifest","retry","downloadFailedAssets","checkUpdate","url","nativeUrl","loader","md5Pipe","transformURL","isLoaded","bind","hotUpdate","cb","isOke","_failCount","update","onLoad","isNative","getWritablePath","versionCompareHandle","versionA","versionB","vA","split","vB","i","length","a","parseInt","b","setVerifyCallback","path","asset","compressed","expectedMD5","md5","relativePath","size","os","OS_ANDROID","setMaxConcurrentTask","onDestroy"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Custom manifest removed the following assets:\n// 1. res/raw-assets/2a/2a40e5e7-4c4a-4350-9e5d-76757755cdd2.png\n// 2. res/raw-assets/2d/2d86a854-63c4-4b90-8b88-a4328b8526c2.png\n// So when custom manifest used, you should be able to find them in downloaded remote assets\nvar customManifestStr = JSON.stringify({\n    \"packageUrl\": \"http://192.168.50.220:5555/tutorial-hot-update/remote-assets/\",\n    \"remoteManifestUrl\": \"http://192.168.50.220:5555/tutorial-hot-update/remote-assets/project.manifest\",\n    \"remoteVersionUrl\": \"http://192.168.50.220:5555/tutorial-hot-update/remote-assets/version.manifest\",\n    \"version\": \"1.10\",\n    \"assets\": {\n        \"src/cocos2d-jsb.js\": {\n            \"size\": 3341465,\n            \"md5\": \"fafdde66bd0a81d1e096799fb8b7af95\"\n        },\n        \"src/project.dev.js\": {\n            \"size\": 97814,\n            \"md5\": \"ed7f5acd411a09d4d298db800b873b00\"\n        },\n        \"src/settings.js\": {\n            \"size\": 3849,\n            \"md5\": \"deb03998a4cfb8f8b468fba8575cb1c9\"\n        },\n        \"res/import/03/0379fb962.json\": {\n            \"size\": 1107,\n            \"md5\": \"d102d0f14ed6b6cb42cc28d88b3b9069\"\n        },\n        \"res/import/0c/0cd5de143.json\": {\n            \"size\": 80883,\n            \"md5\": \"f06347880038a1381043ed505d6f8a9a\"\n        },\n        \"res/import/0d/0d756af45.json\": {\n            \"size\": 10137,\n            \"md5\": \"02dc8b795e79b9fd62e00d4a2c70c8c1\"\n        },\n        \"res/import/0d/0dc6a4e59.json\": {\n            \"size\": 14970,\n            \"md5\": \"a500f696892df6869341dff5f31b1a33\"\n        },\n        \"res/import/41/4128b78b-00ae-4d8a-ae35-4e5ca5c5cde9.json\": {\n            \"size\": 76,\n            \"md5\": \"3f79d93ce8d42b186ecd43d868c8d023\"\n        },\n        \"res/import/49/49539cb0-3893-459a-b310-7cc1b7f6d335.json\": {\n            \"size\": 72,\n            \"md5\": \"8a36388cda7c3773b5bf7a53d8824535\"\n        },\n        \"res/import/9e/9e2ae507-fae5-4511-940b-f2e46f81b790.json\": {\n            \"size\": 74,\n            \"md5\": \"98f6b1d93a4ee3a1f2074be9ce00fbb2\"\n        },\n        \"res/raw-assets/0e/0ed8cf6e-8c04-4569-8d17-626a26e1099f.png\": {\n            \"size\": 4665,\n            \"md5\": \"9e8bf9af30ac7a9ea9d3b72f37a193e1\"\n        },\n        \"res/raw-assets/13/137d1ca6-e90c-440b-9fa2-4b9ffff569f7.png\": {\n            \"size\": 1627,\n            \"md5\": \"75060291e24294abd6a52553fa22317e\"\n        },\n        \"res/raw-assets/15/15d5f3f0-f965-4c00-945b-d2c8faee78b6.png\": {\n            \"size\": 3840,\n            \"md5\": \"cb525edab8063a845e6bd1e9d29b8cde\"\n        },\n        \"res/raw-assets/19/19509bb1-dc08-4cbf-ab8f-2460e207265c.png\": {\n            \"size\": 9638,\n            \"md5\": \"6e159c9cc1b971d3921bc8908071a70b\"\n        },\n        \"res/raw-assets/26/26e9a867-3d2f-4981-8a33-82d440de7aff.png\": {\n            \"size\": 6417,\n            \"md5\": \"5c139729708dd26bd461bcd3e8201823\"\n        },\n        \"res/raw-assets/2d/2ddfe005-2129-41d8-aeec-2b1f51f02962.png\": {\n            \"size\": 2290,\n            \"md5\": \"874dccfd88108a9f0188bda59c5df183\"\n        },\n        \"res/raw-assets/34/3459ab36-782c-4c4e-8aef-7280aff8b272.png\": {\n            \"size\": 18969,\n            \"md5\": \"3a810a636f3779b357e854155eafa4b6\"\n        },\n        \"res/raw-assets/36/36b6ea73-ff48-430e-a0c7-0e5e8defe341.png\": {\n            \"size\": 2711,\n            \"md5\": \"e64625aeb59a1de225e718a7126634ad\"\n        },\n        \"res/raw-assets/39/394bac82-54fb-472f-a27f-b5107821bfb8.png\": {\n            \"size\": 1641,\n            \"md5\": \"049d2201d7d99fc6dbdb017d8d8bd9b8\"\n        },\n        \"res/raw-assets/3c/3cedb8b4-8532-4037-a00e-b8d3e0013158.png\": {\n            \"size\": 94313,\n            \"md5\": \"a2e763866c1bdd6b189be69f3d37eedd\"\n        },\n        \"res/raw-assets/41/4128b78b-00ae-4d8a-ae35-4e5ca5c5cde9.manifest\": {\n            \"size\": 6358,\n            \"md5\": \"c1d18879851e567545ea04bf135a325f\"\n        },\n        \"res/raw-assets/49/49539cb0-3893-459a-b310-7cc1b7f6d335.mp3\": {\n            \"size\": 971644,\n            \"md5\": \"f45ec6666f06b729d8c0461bc89d4b94\"\n        },\n        \"res/raw-assets/4e/4e06c7f1-72ac-4e4e-90de-683e16905156.png\": {\n            \"size\": 2406,\n            \"md5\": \"5f0c28e0eed7ec0cb75e45f5937dd7c6\"\n        },\n        \"res/raw-assets/50/50da5486-dfa1-46d2-9d4f-686eb5527c1a.png\": {\n            \"size\": 6911,\n            \"md5\": \"51cf32529c923146f06019a58398c98d\"\n        },\n        \"res/raw-assets/52/5245e25c-010c-45fb-84a3-f3bce95793e7.png\": {\n            \"size\": 3963,\n            \"md5\": \"0f050ba45e09986b3d785b7b23ffcc1e\"\n        },\n        \"res/raw-assets/6d/6de06a23-d0de-4766-a9e1-a0314136d62e.png\": {\n            \"size\": 10878,\n            \"md5\": \"9f89eec7a1b0f615a3c1bab0857aefff\"\n        },\n        \"res/raw-assets/70/700faa17-11a6-46cd-aeb5-d6900bc264f8.png\": {\n            \"size\": 3765,\n            \"md5\": \"878e89a0a3e02b13beee9f3274f2ca39\"\n        },\n        \"res/raw-assets/71/71561142-4c83-4933-afca-cb7a17f67053.png\": {\n            \"size\": 1050,\n            \"md5\": \"c06a93f5f1a8a1c6edc4fd8b52e96cbf\"\n        },\n        \"res/raw-assets/80/8071df9d-029b-40e8-98f3-8eab08dbf6ca.png\": {\n            \"size\": 25205,\n            \"md5\": \"f688777a92fba11bfe85c3061a4476e5\"\n        },\n        \"res/raw-assets/82/82fe58d4-ae13-4806-9a41-2e73902ea811.png\": {\n            \"size\": 24298,\n            \"md5\": \"b807df8ffcb540f3dd20db75ac95b73b\"\n        },\n        \"res/raw-assets/83/83cc2086-d713-47a0-8d86-a8d6068b6258.png\": {\n            \"size\": 3782,\n            \"md5\": \"9827ce705349caa604e1aba1d53b0fd9\"\n        },\n        \"res/raw-assets/96/96e3e293-4e36-426d-a0a6-eb8d025c0d5b.png\": {\n            \"size\": 15379,\n            \"md5\": \"d6ce47aed38348a1ea0f003fa0063079\"\n        },\n        \"res/raw-assets/97/97a6316c-7fcb-4ffe-9045-35625bc6abf6.png\": {\n            \"size\": 2187,\n            \"md5\": \"f3f41b4c0783a751e561f1b84d91a70b\"\n        },\n        \"res/raw-assets/97/97bb9c9c-5568-4419-af04-4ed5a2969a02.png\": {\n            \"size\": 10370,\n            \"md5\": \"48ab94f1c34b0e9a047297cab1aeabc4\"\n        },\n        \"res/raw-assets/99/99170b0b-d210-46f1-b213-7d9e3f23098a.png\": {\n            \"size\": 1177,\n            \"md5\": \"d1118d133683bb4227d5e60c79c846b7\"\n        },\n        \"res/raw-assets/99/99acc716-33df-4c4c-879d-cc3407f0cd8c.png\": {\n            \"size\": 9754,\n            \"md5\": \"23e7221934021f3fbe6c6a52b023ded8\"\n        },\n        \"res/raw-assets/9e/9e2ae507-fae5-4511-940b-f2e46f81b790.mp3\": {\n            \"size\": 3179,\n            \"md5\": \"90d17b1a25200c90e292d9a3748c9fec\"\n        },\n        \"res/raw-assets/ac/ac11439d-3758-49f5-8728-81ed22c1ed96.png\": {\n            \"size\": 11935,\n            \"md5\": \"c20ae4a74c42b2aed28bb8c9247eb5d5\"\n        },\n        \"res/raw-assets/ae/ae4e2188-2b7b-42a9-85e1-8fb987600b04.png\": {\n            \"size\": 634171,\n            \"md5\": \"07b03f7145b75579708ae05ea2a2c029\"\n        },\n        \"res/raw-assets/af/afe329a6-e85e-46a0-98ed-8a34e128907b.png\": {\n            \"size\": 2209,\n            \"md5\": \"30ae2fe844c7c53f1d00291051230607\"\n        },\n        \"res/raw-assets/b2/b2037f34-04ff-4351-b9da-5be4bb557017.png\": {\n            \"size\": 1530,\n            \"md5\": \"bb96dacb8b09e0443d83462cc7b20095\"\n        },\n        \"res/raw-assets/b4/b43ff3c2-02bb-4874-81f7-f2dea6970f18.png\": {\n            \"size\": 1114,\n            \"md5\": \"83fcc9912e01ae5411c357651fb8b1cf\"\n        },\n        \"res/raw-assets/c3/c39ea496-96eb-4dc5-945a-e7c919b77c21.png\": {\n            \"size\": 2548,\n            \"md5\": \"ae7a04af25e238a5478170759b55a7ba\"\n        },\n        \"res/raw-assets/ca/caaaf9ff-5036-4232-a8a7-88b80b2e4c88.png\": {\n            \"size\": 1829,\n            \"md5\": \"94d761c4626df88053787f17fa09914d\"\n        },\n        \"res/raw-assets/ca/cacafa85-d8e9-4716-bcdb-7eba457e409c.png\": {\n            \"size\": 7380,\n            \"md5\": \"e6bb0f4d041257653f07da2dfe1edd09\"\n        },\n        \"res/raw-assets/ce/ce6d2de9-7056-4ba8-a1b1-40b00bb6f469.png\": {\n            \"size\": 10982,\n            \"md5\": \"52aa0df577edafe11de1cfdb44422895\"\n        },\n        \"res/raw-assets/cf/cfef78f1-c8df-49b7-8ed0-4c953ace2621.png\": {\n            \"size\": 1140,\n            \"md5\": \"a4b5953dffeb145b4b70072d91c4052b\"\n        },\n        \"res/raw-assets/d5/d5dfe6a8-eb19-4aae-a74f-83b71eaa57dc.png\": {\n            \"size\": 8755,\n            \"md5\": \"aeb1055ced334ce20fe030579e187494\"\n        },\n        \"res/raw-assets/da/da3e556f-1bce-4c31-87dc-897ea2d788e2.png\": {\n            \"size\": 11636,\n            \"md5\": \"d81124346c110eb1377f7b56346b31e4\"\n        },\n        \"res/raw-assets/e8/e851e89b-faa2-4484-bea6-5c01dd9f06e2.png\": {\n            \"size\": 1082,\n            \"md5\": \"90cf45d059d0408bec327f66eae5764c\"\n        },\n        \"res/raw-assets/ec/ec244ee5-6f1f-4920-9b69-d4df0e78ec2d.png\": {\n            \"size\": 55581,\n            \"md5\": \"68fdff7430b1b02f3a6e76bea92c6372\"\n        },\n        \"res/raw-assets/fc/fccc4d85-6ad4-496d-9b33-ea76e69da132.png\": {\n            \"size\": 82257,\n            \"md5\": \"df4359cdcb956f52f2e5b4ef777bbb7d\"\n        }\n    },\n    \"searchPaths\": []\n});\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        manifestUrl: {\n            type: cc.Asset,\n            default: null\n        },\n        processLoad: cc.ProgressBar,\n        lbLoading: cc.Label,\n        lbUpdate: cc.Label,\n        _updating: false,\n        _canRetry: false,\n        _storagePath: '',\n        _addEventFinish: null,\n    },\n\n    checkCb: function (event) {\n        // console.log('Code 123: ' + event.getEventCode());\n        switch (event.getEventCode())\n        {\n            case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:\n                // console.log(\"No local manifest file found, hot update skipped.\");\n                break;\n            case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:\n            case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:\n                // console.log( \"Fail to download manifest file, hot update skipped.\");\n                break;\n            case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:\n                // console.log( \"Already up to date with the latest remote version.\");\n                break;\n            case jsb.EventAssetsManager.NEW_VERSION_FOUND:\n                // console.log( 'New version found, please try to update. (' + this._am.getTotalBytes() + ')');\n                // process = 0;\n                this.processLoad.progress = 0;\n                this.lbLoading.string = \"Đang cập nhật tài nguyên!\";\n                break;\n            default:\n                return;\n        }\n\n        this._am.setEventCallback(null);\n        this._checkListener = null;\n        this._updating = false;\n    },\n\n    updateCb: function (event) {\n        var needRestart = false;\n        var failed = false;\n        switch (event.getEventCode())\n        {\n            case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:\n                // console.log('No local manifest file found, hot update skipped.');\n                failed = true;\n                break;\n            case jsb.EventAssetsManager.UPDATE_PROGRESSION:\n                // console.log(event.getPercent());\n                // console.log(event.getPercentByFile());\n                // console.log( event.getDownloadedFiles() + ' / ' + event.getTotalFiles())\n                // console.log( event.getDownloadedBytes() + ' / ' + event.getTotalBytes())\n                // var msg = event.getMessage();\n                let percent = parseFloat( event.getPercent());\n                if (!isNaN(percent)){\n                    this.processLoad.progress = percent;\n                    this.lbLoading.string     =  Math.floor(percent * 100) + \"%\";\n                }\n                break;\n            case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:\n            case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:\n                // console.log('Fail to download manifest file, hot update skipped.');\n                failed = true;\n                break;\n            case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:\n                // console.log('Already up to date with the latest remote version.');\n                failed = true;\n                break;\n            case jsb.EventAssetsManager.UPDATE_FINISHED:\n                // console.log('Update finished. ' + event.getMessage());\n                needRestart = true;\n                break;\n            case jsb.EventAssetsManager.UPDATE_FAILED:\n                // console.log( 'Update failed. ' + event.getMessage());\n                this._updating = false;\n                this._canRetry = true;\n                break;\n            case jsb.EventAssetsManager.ERROR_UPDATING:\n                // console.log(  'Asset update error: ' + event.getAssetId() + ', ' + event.getMessage());\n                break;\n            case jsb.EventAssetsManager.ERROR_DECOMPRESS:\n                // console.log(event.getMessage());\n                break;\n            default:\n                break;\n        }\n        if (failed) {\n            this._am.setEventCallback(null);\n            this._updateListener = null;\n            this._updating = false;\n            if (this._addEventFinish)\n                this._addEventFinish();\n        }\n\n        if (needRestart) {\n            this._am.setEventCallback(null);\n            this._updateListener = null;\n            // Prepend the manifest's search path\n            var searchPaths = jsb.fileUtils.getSearchPaths();\n            var newPaths = this._am.getLocalManifest().getSearchPaths();\n            // console.log(JSON.stringify(newPaths));\n            Array.prototype.unshift.apply(searchPaths, newPaths);\n            // This value will be retrieved and appended to the default search path during game startup,\n            // please refer to samples/js-tests/main.js for detailed usage.\n            // !!! Re-add the search paths in main.js is very important, otherwise, new scripts won't take effect.\n            cc.sys.localStorage.setItem('HotUpdateSearchPaths', JSON.stringify(searchPaths));\n            jsb.fileUtils.setSearchPaths(searchPaths);\n\n            cc.audioEngine.stopAll();\n            cc.game.restart();\n        }\n    },\n\n    loadCustomManifest: function () {\n        if (this._am.getState() === jsb.AssetsManager.State.UNINITED) {\n            var manifest = new jsb.Manifest(customManifestStr, this._storagePath);\n            this._am.loadLocalManifest(manifest, this._storagePath);\n            // console.log( 'Using custom manifest');\n        }\n    },\n\n    retry: function () {\n        if (!this._updating && this._canRetry) {\n            this._canRetry = false;\n            // console.log( 'Retry failed Assets...');\n            this._am.downloadFailedAssets();\n        }\n    },\n\n    checkUpdate: function () {\n        if (this._updating) {\n            // console.log('Checking or updating ...');\n            return;\n        }\n        if (this._am.getState() === jsb.AssetsManager.State.UNINITED) {\n            // Resolve md5 url\n            var url = this.manifestUrl.nativeUrl;\n            if (cc.loader.md5Pipe) {\n                url = cc.loader.md5Pipe.transformURL(url);\n            }\n            this._am.loadLocalManifest(url);\n        }\n        if (!this._am.getLocalManifest() || !this._am.getLocalManifest().isLoaded()) {\n            // console.log('Failed to load local manifest ...');\n            return;\n        }\n        this._am.setEventCallback(this.checkCb.bind(this));\n\n        this._am.checkUpdate();\n        this._updating = true;\n    },\n\n    hotUpdate: function (cb) {\n        this.lbUpdate.string = \"Cập nhật phiên bản mới!\";\n        let isOke = this._am && !this._updating;\n        if (this._am && !this._updating) {\n            this._am.setEventCallback(this.updateCb.bind(this));\n\n            if (this._am.getState() === jsb.AssetsManager.State.UNINITED) {\n                // Resolve md5 url\n                var url = this.manifestUrl.nativeUrl;\n                if (cc.loader.md5Pipe) {\n                    url = cc.loader.md5Pipe.transformURL(url);\n                }\n                this._am.loadLocalManifest(url);\n            }\n\n            this._failCount = 0;\n            this._am.update();\n            this._updating = true;\n        }\n        this._addEventFinish = cb;\n    },\n    // use this for initialization\n    onLoad: function () {\n        // Hot update is only available in Native build\n        if (!cc.sys.isNative) {\n            return;\n        }\n        this._storagePath = ((jsb.fileUtils ? jsb.fileUtils.getWritablePath() : '/') + 'blackjack-remote-asset');\n        // cc.log('Storage path for remote asset : ' + this._storagePath);\n\n        // Setup your own version compare handler, versionA and B is versions in string\n        // if the return value greater than 0, versionA is greater than B,\n        // if the return value equals 0, versionA equals to B,\n        // if the return value smaller than 0, versionA is smaller than B.\n        this.versionCompareHandle = function (versionA, versionB) {\n            // cc.log(\"JS Custom Version Compare: version A is \" + versionA + ', version B is ' + versionB);\n            var vA = versionA.split('.');\n            var vB = versionB.split('.');\n            for (var i = 0; i < vA.length; ++i) {\n                var a = parseInt(vA[i]);\n                var b = parseInt(vB[i] || 0);\n                if (a === b) {\n                    continue;\n                }\n                else {\n                    return a - b;\n                }\n            }\n            if (vB.length > vA.length) {\n                return -1;\n            }\n            else {\n                return 0;\n            }\n        };\n\n        // Init with empty manifest url for testing custom manifest\n        this._am = new jsb.AssetsManager('', this._storagePath, this.versionCompareHandle);\n        // Setup the verification callback, but we don't have md5 check function yet, so only print some message\n        // Return true if the verification passed, otherwise return false\n        this._am.setVerifyCallback(function (path, asset) {\n            // When asset is compressed, we don't need to check its md5, because zip file have been deleted.\n            var compressed = asset.compressed;\n            // Retrieve the correct md5 value.\n            var expectedMD5 = asset.md5;\n            // asset.path is relative path and path is absolute.\n            var relativePath = asset.path;\n            // The size of asset file, but this value could be absent.\n            var size = asset.size;\n            if (compressed) {\n                // console.log(\"Verification passed : \" + relativePath);\n                return true;\n            }\n            else {\n                // console.log(\"Verification passed : \" + relativePath + ' (' + expectedMD5 + ')');\n                return true;\n            }\n        });\n        // console.log('Hot update is ready, please check or directly update.');\n        if (cc.sys.os === cc.sys.OS_ANDROID) {\n            // Some Android device may slow down the download process when concurrent tasks is too much.\n            // The value may not be accurate, please do more test and find what's most suitable for your game.\n            this._am.setMaxConcurrentTask(2);\n        }\n    },\n\n    onDestroy: function () {\n        if (this._updateListener) {\n            this._am.setEventCallback(null);\n            this._updateListener = null;\n        }\n    }\n});\n"]}