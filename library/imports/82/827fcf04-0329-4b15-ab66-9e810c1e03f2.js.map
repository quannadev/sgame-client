{"version":3,"sources":["assets/scripts/candy/CandyReel.js"],"names":["cc","Class","Component","properties","HeightReel","onLoad","node","height","init","obj","data","CDV","icons","self","Promise","all","map","itemType","index","icon","instantiate","iconPrefab","addChild","getComponent","then","result","spin","isFast","timeDelay","timeMove","stopAllActions","d","moveTo","v2","x","easing","easeOut","p2","callFunc","copy","y","EF","runActionWon","runAction","sequence","delayTime","stop"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        HeightReel: 300\n    },\n    onLoad() {\n        this.HeightReel = this.node.height-5;\n    },\n    init(obj, data){\n        this.CDV = obj;\n        this.icons = [];\n        let self  = this;\n        Promise.all(data.map(function(itemType, index){\n            let icon = cc.instantiate(self.CDV.iconPrefab);\n            self.node.addChild(icon);\n            icon = icon.getComponent('CandyItem');\n            icon.init(self.CDV, itemType);\n            return icon;\n        })).then(result => {\n            this.icons = result;\n        });\n    },\n    spin: function(index, isFast){\n        let timeDelay = 0.4;\n        let timeMove  = 1;\n        if ( this.CDV.isFast){\n            timeDelay = 0.2;\n            timeMove  = 0.4;\n        }\n\n        this.node.stopAllActions();\n        let d = cc.moveTo(timeMove, cc.v2(this.node.x,-(this.node.height- this.HeightReel))).easing(cc.easeOut(1));\n        let p2 = cc.callFunc(function() {\n            if (index === 0) {\n                this.CDV.copy();\n            }\n            this.node.y = 0;\n        }, this);\n        if (index === 2){\n            let EF = cc.callFunc(function() {\n                this.node.y = 0;\n                this.CDV.runActionWon();\n            }, this);\n            this.node.runAction(cc.sequence(cc.delayTime(index*timeDelay), d, EF ));\n        } else{\n            this.node.runAction(cc.sequence(cc.delayTime(index*timeDelay), d, p2));\n        }\n\n    },\n    stop: function(){\n        this.node.stopAllActions();\n        this.CDV.copy();\n        this.node.y = 0;\n    },\n});\n"]}