{"version":3,"sources":["assets\\scripts\\sinbad\\SinbadController.js"],"names":["SinbadEvent","require","SinbadController","SmartFoxSDK","BaseController","extend","m_tableInfo","registerEvents","_super","ZoneInstance","addEventListenerExtension","RESPONSE_NAME","RESULT_RES","onUserResultEvent","removeEvents","removeEventListenerExtension","onEventLogin","event","_requestJoinRoom","zoneName","onEventRoomJoin","UIManger","show","pop","src","onUserVariablesUpdate","getUI","updateUserVariableSlot","onHistoryEvent","data","getSArray","items","i","size","sItem","get","getObject","item","session","getDouble","toFixed","time","getUtfString","stakes","win","resultMap","getByteArray","linewin","push","onLeaderBoardEvent","account","win_type","onEventUserExitRoom","user","isItMe","node","active","userBet","ResultEvent","fromEvent","SinbadRun","instance","getInstance","module","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["let SinbadEvent = require('SinbadEvent')\r\nlet SinbadController = SmartFoxSDK.BaseController.extend({\r\n    m_tableInfo: null,\r\n    registerEvents(){\r\n        this._super();\r\n        this.ZoneInstance.addEventListenerExtension(SinbadEvent.RESPONSE_NAME.RESULT_RES, this.onUserResultEvent, this);\r\n    },\r\n    removeEvents(){\r\n        this._super();\r\n        this.ZoneInstance.removeEventListenerExtension(SinbadEvent.RESPONSE_NAME.RESULT_RES, this.onUserResultEvent, this);\r\n    },\r\n    onEventLogin(event){\r\n        this._super(event);\r\n        this._requestJoinRoom(this.zoneName);\r\n    },\r\n    onEventRoomJoin(event){\r\n        this._super(event);\r\n        UIManger.show(\"UISinbadLobby\", {pop: true, src: \"sinbad\"});\r\n    },\r\n    onUserVariablesUpdate(event){\r\n        this._super(event);\r\n        if (this.getUI() != null)\r\n            this.getUI().updateUserVariableSlot(event);\r\n    },\r\n    onHistoryEvent(event){\r\n        let data = event.getSArray(\"d\");\r\n        let items = [];\r\n        for(let i = 0; i < data.size(); i++){\r\n            let sItem = data.get(i).getObject();\r\n            let item = {};\r\n            item.session = sItem.getDouble(\"id\").toFixed(0);\r\n            item.time = sItem.getUtfString(\"t\");\r\n            item.stakes = sItem.getDouble(\"b\");\r\n            item.win = sItem.getDouble(\"w\");\r\n            item.resultMap = sItem.getByteArray(\"rs\");\r\n            item.linewin = sItem.getByteArray(\"lw\");\r\n            items.push(item);\r\n        }\r\n        UIManger.show(\"UISinbadHistoryTransaction\", {pop: true, src: 'sinbad', data: {items: items}});\r\n    },\r\n    onLeaderBoardEvent(event){\r\n        let data = event.getSArray(\"d\");\r\n        let items = [];\r\n        for(let i = 0;i < data.size();i++){\r\n            let sItem = data.get(i).getObject();\r\n            let item = {};\r\n            item.session = i + 1;\r\n            item.account = sItem.getUtfString(\"dn\");\r\n            item.win = sItem.getDouble(\"m\");\r\n            item.time = sItem.getUtfString(\"t\");\r\n            item.win_type = \"Tháº¯ng\";\r\n            items.push(item);\r\n        }\r\n        UIManger.show(\"UISinbadRank\", {pop: true, src: 'sinbad', data: {items: items}});\r\n    },\r\n    onEventUserExitRoom(event){\r\n        let user = event.user;\r\n        if(user.isItMe){\r\n            if (this.getUI() != null)\r\n                this.getUI().node.active = false;\r\n            UIManger.show(\"UIHome\");\r\n        }\r\n    },\r\n    onUserResultEvent(event){\r\n        let userBet = new SinbadEvent.ResultEvent().fromEvent(event);\r\n        this.getUI().SinbadRun(userBet);\r\n    },\r\n\r\n});\r\nlet instance = null;\r\nlet getInstance = function () {\r\n    if(instance == null)\r\n        instance = new SinbadController(\"UISinbad\", \"sinbad\");\r\n    return instance;\r\n}\r\nSmartFoxSDK.SinbadController = module.exports = getInstance();\r\n"]}