{"version":3,"sources":["assets\\scripts\\portal\\UIDaiLy.js"],"names":["Listview","require","cc","Class","VozBaseComponent","properties","listview","listArea","Sprite","listBg","SpriteFrame","_listArea","onLoad","listDaiLy","numItems","length","onEnable","mm","Loading","show","SmartFoxSDK","PortalController","ZoneInstance","addEventListenerExtension","CasinoEvent","RESPONSE_NAME","LIST_AGENCY_RES","onListAgency","request","CasinoRequest","ListAgencyRequest","send","toSRequest","node","zIndex","lastZIndex","onDisable","removeEventListenerExtension","eventClose","audio","playButton","back","event","hide","listAgency","ListAgencyEvent","fromEvent","listBaseDaiLy","console","log","eventSelectArea","getLastArea","onListRender","item","idx","rank","getComponent","name","init","addEventSelect","dataSelect","pop","src","data","nickname","agName","area","zone","onListSelected","selectedId","lastSelectedId","val","list","listItem","_list","str","selectedMode","getDailyInArea","i","spriteFrame","posArea","push","localStorage","sys","getItem","undefined","setItem"],"mappings":"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","sourceRoot":"/","sourcesContent":["const Listview = require('Listview');\r\ncc.Class({\r\n    extends: cc.VozBaseComponent,\r\n\r\n    properties: {\r\n        listview    : Listview,\r\n        listArea    : [cc.Sprite],\r\n        listBg      : [cc.SpriteFrame],\r\n        _listArea  : []\r\n    },\r\n    onLoad() {\r\n        this.listDaiLy = [];\r\n        this._listArea = [\"ja\", \"ko\"];\r\n        this.listview.numItems = this.listDaiLy.length;\r\n    },\r\n    onEnable(){\r\n        mm.Loading.show();\r\n        SmartFoxSDK.PortalController.ZoneInstance.addEventListenerExtension(CasinoEvent.RESPONSE_NAME.LIST_AGENCY_RES, this.onListAgency, this);\r\n        let request = new CasinoRequest.ListAgencyRequest();\r\n        SmartFoxSDK.PortalController.ZoneInstance.send(request.toSRequest());\r\n        if (this.node.zIndex <= cc.lastZIndex){\r\n            this.node.zIndex = cc.lastZIndex+1;\r\n        }\r\n    },\r\n    onDisable(){\r\n        SmartFoxSDK.PortalController.ZoneInstance.removeEventListenerExtension(CasinoEvent.RESPONSE_NAME.LIST_AGENCY_RES, this.onListAgency, this);\r\n    },\r\n    eventClose() {\r\n        mm.audio.playButton();\r\n        this.back();\r\n    },\r\n    onListAgency(event){\r\n        mm.Loading.hide();\r\n        let listAgency = new CasinoEvent.ListAgencyEvent().fromEvent(event);\r\n        this.listBaseDaiLy = listAgency;\r\n        this.listDaiLy = listAgency;\r\n        console.log(listAgency);\r\n        this.eventSelectArea(null, this.getLastArea());\r\n    },\r\n    onListRender(item, idx) {\r\n        let rank = this.listDaiLy[idx];\r\n        item.getComponent(item.name).init(rank, idx);\r\n        item.getComponent(item.name).addEventSelect(function (dataSelect) {\r\n            mm.audio.playButton();\r\n            this.show('UIPayment', {pop: true, src: 'portal', data : {nickname: dataSelect.name, agName: dataSelect.agName, area : dataSelect.zone}});\r\n        });\r\n    },\r\n    onListSelected(item, selectedId, lastSelectedId, val) {\r\n        if (!item)\r\n            return;\r\n        let list = item.listItem._list;\r\n        let str = 'Danh sách hoạt động hiện tại là:' + list.node.name + '，Lựa chọn hiện tại là：' + selectedId + '，Lựa chọn cuối cùng là：' + lastSelectedId;\r\n        if (list.selectedMode == 2) { //Nếu nó là chế độ đa lựa chọn\r\n            str += '，Giá trị hiện tại：' + val;\r\n        }\r\n        console.log(str);\r\n    },\r\n    eventSelectArea(event, data) {\r\n        if (event != null)\r\n            mm.audio.playButton();\r\n        let listArea           = this.getDailyInArea(data);\r\n        this.listDaiLy         = listArea;\r\n        this.listview.numItems = listArea.length;\r\n        for (let i=0; i< 3; i++){\r\n            this.listArea[i].spriteFrame = this.listBg[0];\r\n        }\r\n        this.listArea[data].spriteFrame = this.listBg[1];\r\n    },\r\n    getDailyInArea(posArea) {\r\n        let area = this._listArea[posArea];\r\n        let listArea = [];\r\n        for (let i=0; i< this.listBaseDaiLy.length; i++){\r\n           if ( this.listBaseDaiLy[i].zone == area)\r\n               listArea.push(this.listBaseDaiLy[i]);\r\n        }\r\n        return listArea;\r\n    },\r\n    getLastArea() {\r\n        let localStorage = cc.sys.localStorage;\r\n        if (localStorage.getItem(\"last_area\") === null || localStorage.getItem(\"last_area\") === undefined) {\r\n            localStorage.setItem(\"last_area\", \"ja\");\r\n        }\r\n        let area = localStorage.getItem(\"last_area\");\r\n        if (area == \"ja\")\r\n            return  0;\r\n        else\r\n            return 1;\r\n    }\r\n});\r\n"]}