{"version":3,"sources":["assets/_smartfox/gui/VozBaseComponent.js"],"names":["cc","VozBaseComponent","Class","Component","statics","properties","_data","onLoad","debug","setDisplayStats","updateUserVariable","event","eventBackDevice","setting","prefab","list","_getUIFromIndex","from","scene","director","getScene","Number","isInteger","childrenCount","log","index","element","children","name","startsWith","_setOption","node","option","data","undefined","script","getComponent","_pop","pop","show","complete","error","find","active","setSiblingIndex","ui","jsUI","resume","src","loader","loadRes","err","console","setAutoReleaseRecursively","instantiate","addChild","hide","refresh","getUIFromName","goTo","exclude","getSiblingIndex","i","destroy","back","_getUIFromIndexBack","currentUI","getPositionInOtherNode","currentNode","nodeTo","parent","pos","convertToWorldSpaceAR","getPosition","convertToNodeSpaceAR","setLanguage","srcName","currentLanguage","require","changeLanguage"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.VozBaseComponent = cc.Class({\n    extends: cc.Component,\n    statics: {\n    },\n    properties: {\n        _data       : null,\n    },\n    onLoad(){\n        cc.debug.setDisplayStats(false);\n    },\n    updateUserVariable(event){\n\n    },\n    eventBackDevice(){\n\n    },\n    setting(prefab, list) {\n        if (!prefab || !list) {\n            return\n        }\n    },\n    _getUIFromIndex(from) {\n        const scene = cc.director.getScene();\n        if (!Number.isInteger(from)) {\n            from = scene.childrenCount - 1\n        }\n        if (from < 0) {\n            from += scene.childrenCount\n        }\n        if ((from < 0) || (from > scene.childrenCount - 1)) {\n            cc.log('_getUIFromIndex error, from = ' + from + '!');\n            return\n        }\n        for (let index = from; index >= 0; index--) {\n            let element = scene.children[index];\n            if (element.name.startsWith('UI')) {\n                return element\n            }\n        }\n    },\n\n    _setOption(node, option) {\n        if (option && (option.data !== undefined) && (option.data !== null)) {\n            const script = node.getComponent(node.name);\n            if (script) {\n                script._data = option.data\n            }\n        }\n        node._pop = !!(option && option.pop);\n    },\n    //pop: true -> khi call back() -> Chi destroy UI dau, UI sau van Active True\n    //pop: false-> khi call back() -> Destroy UI dau, Ui sau chuyen tu Active False -> True\n    show(name, option, complete) {\n        if (!name || name === '') {\n            cc.error('name is empty!');\n            return;\n        }\n        const scene = cc.director.getScene();\n        const node = cc.find(name, scene);\n        if (node) {\n            node.active = false;\n            this._setOption(node, option);\n            node.setSiblingIndex(-1);\n            node.active = true;\n            if (!node._pop) {\n                let ui = this._getUIFromIndex(-2);\n                if (ui) {\n                    ui.active = false\n                }\n            }\n            // this.setLanguage(option,node);\n            if(complete)\n                complete();\n            let jsUI = node.getComponent(node.name);\n            if(jsUI)\n                jsUI.resume();\n            return\n        }\n        if (option && (option.src !== undefined) && (option.src !== null)) {\n            name = option.src+\"/\"+ name;\n        }\n        cc.loader.loadRes(name, (err, prefab) => {\n            if(err){\n                console.log(err);\n                return;\n            }\n            if (cc.find(name, scene)) {\n                if(complete)\n                    complete();\n                return\n            }\n            cc.loader.setAutoReleaseRecursively(prefab, true);\n            const node = cc.instantiate(prefab);\n            if (!node) {\n                cc.error('prefab instantiation failed!')\n            } else {\n                let ui = this._getUIFromIndex(-1);\n                if (ui) {\n                    ui.active = !!(option && option.pop);\n                }\n                this._setOption(node, option);\n                scene.addChild(node);\n                // this.setLanguage(option,node);\n                if(complete) complete();\n            }\n        });\n    },\n    hide(name) {\n        if (!name || name === '') {\n            this.node.active = false\n        } else {\n            const node = cc.find(name);\n            if (node) {\n                node.active = false\n            }\n        }\n    },\n    refresh(){\n\n    },\n    getUIFromName(name) {\n        if (!name || !name.startsWith('UI')) {\n            return;\n        }\n        const scene = cc.director.getScene();\n        return cc.find(name, scene)\n    },\n\n    goTo(name, exclude) {\n        let ui = this.getUIFromName(name);\n        if (ui) {\n            let index = ui.getSiblingIndex();\n            if (exclude) {\n                ui = this._getUIFromIndex(index - 1);\n                if (ui) {\n                    index = ui.getSiblingIndex()\n                } else {\n                    return\n                }\n            }\n            const scene = cc.director.getScene();\n            for (let i = scene.childrenCount - 1; i > index; i--) {\n                const element = scene.children[i];\n                element.destroy()\n            }\n            ui.active = true\n        }\n    },\n\n    back() {\n        let ui = this._getUIFromIndexBack(-1);\n        if (ui) {\n            ui.destroy();\n            ui = this._getUIFromIndex(ui.getSiblingIndex() - 1);\n            if (ui) {\n                ui.active = true;\n                let jsUI = ui.getComponent(ui.name);\n                if(jsUI)\n                    jsUI.resume();\n            }\n        }\n    },\n    _getUIFromIndexBack(from) {\n        const scene = cc.director.getScene();\n        if (!Number.isInteger(from)) {\n            from = scene.childrenCount - 1\n        }\n        if (from < 0) {\n            from += scene.childrenCount\n        }\n        if ((from < 0) || (from > scene.childrenCount - 1)) {\n            cc.log('_getUIFromIndex error, from = ' + from + '!');\n            return\n        }\n        for (let index = from; index >= 0; index--) {\n            let element = scene.children[index];\n            if (element.name.startsWith('UI') && cc.currentUI != element.name) {\n                return element\n            }\n        }\n    },\n    resume(){\n    },\n    getPositionInOtherNode(currentNode, nodeTo) {\n        //nodeFrom: Node hiện tại, cần chuyển sang tạo độ của node khác\n        //nodeTo  : Không gian tạo độ nút mới của nodeFrom4\n        // Hiểu đơn giản: Chuyển tọa độ thằng nodeFrom ra ngoài cùng (Con của Scene). Sau đó thì add nó làm con của nodeTo\n        if (currentNode.parent == null) {\n            let pos = currentNode.convertToWorldSpaceAR(currentNode.getPosition());\n            return nodeTo.convertToNodeSpaceAR(pos);\n        }\n        let pos = currentNode.parent.convertToWorldSpaceAR(currentNode.getPosition());\n        return nodeTo.convertToNodeSpaceAR(pos);\n    },\n    setLanguage(option, currentNode) {\n        let srcName = \"portal\";\n        if (option && (option.src !== undefined) && (option.src !== null)) {\n            srcName = option.src;\n        }\n        let currentLanguage = require(srcName+'Language');\n        currentLanguage.changeLanguage(currentNode);\n    }\n});\n"]}