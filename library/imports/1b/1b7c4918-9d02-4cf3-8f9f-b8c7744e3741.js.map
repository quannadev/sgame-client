{"version":3,"sources":["assets/scripts/abase/ChatLayer.js"],"names":["Listview","require","cc","Class","VozBaseComponent","properties","ed_msg","EditBox","listview","dataChat","onLoad","onDisable","onEnable","numItems","length","scrollTo","initChat","listChat","sendMessage","string","param","SmartFoxSDK","SObject","putUtfString","GameVariables","getDisplayName","TaiXiuController","ZoneInstance","mySelf","send","SmartFox","Requests","System","PublicMessageRequest","addMessage","msgItem","unshift","onListRender","item","idx","data","getComponent","name","init","onListSelected","selectedId","lastSelectedId","val","list","listItem","_list","str","node","selectedMode"],"mappings":";;;;;;AAAA,IAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AACAC,EAAE,CAACC,KAAH,CAAS;AACL,aAASD,EAAE,CAACE,gBADP;AAGLC,EAAAA,UAAU,EAAE;AACRC,IAAAA,MAAM,EAAEJ,EAAE,CAACK,OADH;AAERC,IAAAA,QAAQ,EAAMR,QAFN;AAGRS,IAAAA,QAAQ,EAAE;AAHF,GAHP;AAQLC,EAAAA,MARK,oBAQG;AACJ,SAAKD,QAAL,GAAgB,EAAhB;AACH,GAVI;AAWLE,EAAAA,SAXK,uBAWM,CAEV,CAbI;AAcLC,EAAAA,QAdK,sBAcK;AACN,SAAKJ,QAAL,CAAcK,QAAd,GAAyB,KAAKJ,QAAL,CAAcK,MAAvC;AACA,SAAKN,QAAL,CAAcO,QAAd,CAAuB,CAAvB;AACH,GAjBI;AAkBLC,EAAAA,QAlBK,oBAkBIC,QAlBJ,EAkBc;AACf,SAAKR,QAAL,GAAgBQ,QAAhB;AACA,SAAKT,QAAL,CAAcK,QAAd,GAAyB,KAAKJ,QAAL,CAAcK,MAAvC;AACA,SAAKN,QAAL,CAAcO,QAAd,CAAuB,CAAvB;AACH,GAtBI;AAuBLG,EAAAA,WAvBK,yBAuBQ;AACT,QAAG,KAAKZ,MAAL,CAAYa,MAAZ,CAAmBL,MAAnB,GAA4B,CAA/B,EAAiC;AAC7B,UAAIM,KAAK,GAAG,IAAIC,WAAW,CAACC,OAAhB,EAAZ;AACAF,MAAAA,KAAK,CAACG,YAAN,CAAmB,IAAnB,EAAyB,EAAzB;AACAH,MAAAA,KAAK,CAACG,YAAN,CAAmB,IAAnB,EAAyBC,aAAa,CAACC,cAAd,CAA6BJ,WAAW,CAACK,gBAAZ,CAA6BC,YAA7B,CAA0CC,MAAvE,CAAzB;AACAP,MAAAA,WAAW,CAACK,gBAAZ,CAA6BC,YAA7B,CAA0CE,IAA1C,CAA+C,IAAIR,WAAW,CAACS,QAAZ,CAAqBC,QAArB,CAA8BC,MAA9B,CAAqCC,oBAAzC,CAA8D,KAAK3B,MAAL,CAAYa,MAA1E,EAAkFC,KAAlF,CAA/C;AACA,WAAKd,MAAL,CAAYa,MAAZ,GAAqB,EAArB;AACH;AACJ,GA/BI;AAgCLe,EAAAA,UAhCK,sBAgCMC,OAhCN,EAgCc;AACf,SAAK1B,QAAL,CAAc2B,OAAd,CAAsBD,OAAtB;AACA,SAAK3B,QAAL,CAAcK,QAAd,GAAyB,KAAKJ,QAAL,CAAcK,MAAvC;AACH,GAnCI;AAoCLuB,EAAAA,YApCK,wBAoCQC,IApCR,EAoCcC,GApCd,EAoCmB;AACpB,QAAIC,IAAI,GAAG,KAAK/B,QAAL,CAAc8B,GAAd,CAAX;AACAD,IAAAA,IAAI,CAACG,YAAL,CAAkBH,IAAI,CAACI,IAAvB,EAA6BC,IAA7B,CAAkCH,IAAlC,EAAwCD,GAAxC;AACH,GAvCI;AAwCLK,EAAAA,cAxCK,0BAwCUN,IAxCV,EAwCgBO,UAxChB,EAwC4BC,cAxC5B,EAwC4CC,GAxC5C,EAwCiD;AAClD,QAAI,CAACT,IAAL,EACI;AACJ,QAAIU,IAAI,GAAGV,IAAI,CAACW,QAAL,CAAcC,KAAzB;AACA,QAAIC,GAAG,GAAG,qCAAqCH,IAAI,CAACI,IAAL,CAAUV,IAA/C,GAAsD,wBAAtD,GAAiFG,UAAjF,GAA8F,yBAA9F,GAA0HC,cAApI;;AACA,QAAIE,IAAI,CAACK,YAAL,IAAqB,CAAzB,EAA4B;AAAE;AAC1BF,MAAAA,GAAG,IAAI,uBAAuBJ,GAA9B;AACH;AACJ;AAhDI,CAAT","sourceRoot":"/","sourcesContent":["const Listview = require('Listview');\ncc.Class({\n    extends: cc.VozBaseComponent,\n\n    properties: {\n        ed_msg: cc.EditBox,\n        listview    : Listview,\n        dataChat: null\n    },\n    onLoad(){\n        this.dataChat = [];\n    },\n    onDisable(){\n\n    },\n    onEnable(){\n        this.listview.numItems = this.dataChat.length;\n        this.listview.scrollTo(0);\n    },\n    initChat(listChat) {\n        this.dataChat = listChat;\n        this.listview.numItems = this.dataChat.length;\n        this.listview.scrollTo(0);\n    },\n    sendMessage(){\n        if(this.ed_msg.string.length > 0){\n            let param = new SmartFoxSDK.SObject();\n            param.putUtfString(\"fb\", \"\");\n            param.putUtfString(\"dn\", GameVariables.getDisplayName(SmartFoxSDK.TaiXiuController.ZoneInstance.mySelf));\n            SmartFoxSDK.TaiXiuController.ZoneInstance.send(new SmartFoxSDK.SmartFox.Requests.System.PublicMessageRequest(this.ed_msg.string, param));\n            this.ed_msg.string = \"\";\n        }\n    },\n    addMessage(msgItem){\n        this.dataChat.unshift(msgItem);\n        this.listview.numItems = this.dataChat.length;\n    },\n    onListRender(item, idx) {\n        let data = this.dataChat[idx];\n        item.getComponent(item.name).init(data, idx);\n    },\n    onListSelected(item, selectedId, lastSelectedId, val) {\n        if (!item)\n            return;\n        let list = item.listItem._list;\n        let str = 'Danh sách hoạt động hiện tại là:' + list.node.name + '，Lựa chọn hiện tại là：' + selectedId + '，Lựa chọn cuối cùng là：' + lastSelectedId;\n        if (list.selectedMode == 2) { //Nếu nó là chế độ đa lựa chọn\n            str += '，Giá trị hiện tại：' + val;\n        }\n    },\n});\n"]}