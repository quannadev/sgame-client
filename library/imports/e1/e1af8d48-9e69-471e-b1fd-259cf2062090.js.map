{"version":3,"sources":["assets/scripts/minipoker/MiniPokerReel.js"],"names":["cc","Class","Component","properties","HeightReel","onLoad","node","height","init","obj","data","MNPK","icons","self","Promise","all","map","itemType","index","icon","instantiate","iconPrefab","addChild","getComponent","then","result","spin","timeMove","isFast","stopAllActions","d","moveTo","v2","x","easing","easeOut","p2","callFunc","copy","y","EF","runActionWon","runAction","sequence","stop"],"mappings":";;;;;;AAAAA,EAAE,CAACC,KAAH,CAAS;AACL,aAASD,EAAE,CAACE,SADP;AAGLC,EAAAA,UAAU,EAAE;AACRC,IAAAA,UAAU,EAAE;AADJ,GAHP;AAMLC,EAAAA,MANK,oBAMI;AACL,SAAKD,UAAL,GAAkB,KAAKE,IAAL,CAAUC,MAAV,GAAiB,CAAnC;AACH,GARI;AASLC,EAAAA,IATK,gBASAC,GATA,EASKC,IATL,EASU;AAAA;;AACX,SAAKC,IAAL,GAAYF,GAAZ;AACA,SAAKG,KAAL,GAAa,EAAb;AACA,QAAIC,IAAI,GAAI,IAAZ;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYL,IAAI,CAACM,GAAL,CAAS,UAASC,QAAT,EAAmBC,KAAnB,EAAyB;AAC1C,UAAIC,IAAI,GAAGnB,EAAE,CAACoB,WAAH,CAAeP,IAAI,CAACF,IAAL,CAAUU,UAAzB,CAAX;AACAR,MAAAA,IAAI,CAACP,IAAL,CAAUgB,QAAV,CAAmBH,IAAnB;AACAA,MAAAA,IAAI,GAAGA,IAAI,CAACI,YAAL,CAAkB,eAAlB,CAAP;AACAJ,MAAAA,IAAI,CAACX,IAAL,CAAUK,IAAI,CAACF,IAAf,EAAqBM,QAArB;AACA,aAAOE,IAAP;AACH,KANW,CAAZ,EAMIK,IANJ,CAMS,UAAAC,MAAM,EAAI;AACf,MAAA,KAAI,CAACb,KAAL,GAAaa,MAAb;AACH,KARD;AASH,GAtBI;AAuBLC,EAAAA,IAAI,EAAE,cAASR,KAAT,EAAe;AACjB,QAAIS,QAAQ,GAAI,CAAhB;;AACA,QAAK,KAAKhB,IAAL,CAAUiB,MAAf,EAAsB;AAClBD,MAAAA,QAAQ,GAAI,GAAZ;AACH;;AACD,SAAKrB,IAAL,CAAUuB,cAAV;AACA,QAAIC,CAAC,GAAI9B,EAAE,CAAC+B,MAAH,CAAUJ,QAAQ,IAAET,KAAK,GAAC,CAAN,GAAQ,CAAV,CAAlB,EAAgClB,EAAE,CAACgC,EAAH,CAAM,KAAK1B,IAAL,CAAU2B,CAAhB,EAAkB,EAAE,KAAK3B,IAAL,CAAUC,MAAV,GAAkB,KAAKH,UAAzB,CAAlB,CAAhC,EAAyF8B,MAAzF,CAAgGlC,EAAE,CAACmC,OAAH,CAAW,CAAX,CAAhG,CAAT;AACA,QAAIC,EAAE,GAAGpC,EAAE,CAACqC,QAAH,CAAY,YAAW;AAC5B,UAAInB,KAAK,KAAK,CAAd,EAAiB;AACb,aAAKP,IAAL,CAAU2B,IAAV;AACH;;AACD,WAAKhC,IAAL,CAAUiC,CAAV,GAAc,CAAd;AACH,KALQ,EAKN,IALM,CAAT;;AAMA,QAAIrB,KAAK,KAAK,CAAd,EAAgB;AACZ,UAAIsB,EAAE,GAAGxC,EAAE,CAACqC,QAAH,CAAY,YAAW;AAC5B,aAAK/B,IAAL,CAAUiC,CAAV,GAAc,CAAd;AACA,aAAK5B,IAAL,CAAU8B,YAAV;AACH,OAHQ,EAGN,IAHM,CAAT;AAIA,WAAKnC,IAAL,CAAUoC,SAAV,CAAoB1C,EAAE,CAAC2C,QAAH,CAAYb,CAAZ,EAAeU,EAAf,CAApB;AACH,KAND,MAMM;AACF,WAAKlC,IAAL,CAAUoC,SAAV,CAAoB1C,EAAE,CAAC2C,QAAH,CAAYb,CAAZ,EAAeM,EAAf,CAApB;AACH;AACJ,GA7CI;AA8CLQ,EAAAA,IAAI,EAAE,gBAAU;AACZ,SAAKtC,IAAL,CAAUuB,cAAV;AACA,SAAKlB,IAAL,CAAU2B,IAAV;AACA,SAAKhC,IAAL,CAAUiC,CAAV,GAAc,CAAd;AACH;AAlDI,CAAT","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        HeightReel: 144\n    },\n    onLoad() {\n        this.HeightReel = this.node.height-5;\n    },\n    init(obj, data){\n        this.MNPK = obj;\n        this.icons = [];\n        let self  = this;\n        Promise.all(data.map(function(itemType, index){\n            let icon = cc.instantiate(self.MNPK.iconPrefab);\n            self.node.addChild(icon);\n            icon = icon.getComponent('MiniPokerItem');\n            icon.init(self.MNPK, itemType);\n            return icon;\n        })).then(result => {\n            this.icons = result;\n        });\n    },\n    spin: function(index){\n        let timeMove  = 1;\n        if ( this.MNPK.isFast){\n            timeMove  = 0.2;\n        }\n        this.node.stopAllActions();\n        let d  = cc.moveTo(timeMove*(index/2+1), cc.v2(this.node.x,-(this.node.height- this.HeightReel))).easing(cc.easeOut(2));\n        let p2 = cc.callFunc(function() {\n            if (index === 0) {\n                this.MNPK.copy();\n            }\n            this.node.y = 0;\n        }, this);\n        if (index === 4){\n            let EF = cc.callFunc(function() {\n                this.node.y = 0;\n                this.MNPK.runActionWon();\n            }, this);\n            this.node.runAction(cc.sequence(d, EF));\n        } else{\n            this.node.runAction(cc.sequence(d, p2));\n        }\n    },\n    stop: function(){\n        this.node.stopAllActions();\n        this.MNPK.copy();\n        this.node.y = 0;\n    },\n});\n"]}