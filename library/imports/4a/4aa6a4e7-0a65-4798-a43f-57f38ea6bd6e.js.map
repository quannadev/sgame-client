{"version":3,"sources":["assets\\scripts\\vampire\\VampireReel.js"],"names":["cc","Class","Component","properties","onLoad","onEnable","init","obj","data","SLV","icons","self","Promise","all","map","itemType","index","icon","instantiate","iconPrefab","node","addChild","getComponent","then","result","spin","stopAllActions","d","moveTo","v2","x","height","easing","easeInOut","p2","callFunc","copy","y","EF","runActionWon","runAction","sequence","delayTime","stop"],"mappings":";;;;;;AACAA,EAAE,CAACC,KAAH,CAAS;AACL,aAASD,EAAE,CAACE,SADP;AAGLC,EAAAA,UAAU,EAAE,EAHP;AAOLC,EAAAA,MAPK,oBAOK,CAET,CATI;AAULC,EAAAA,QAVK,sBAUO,CAAE,CAVT;AAYLC,EAAAA,IAZK,gBAYAC,GAZA,EAYKC,IAZL,EAYU;AAAA;;AACX,SAAKC,GAAL,GAAWF,GAAX;AACA,SAAKG,KAAL,GAAa,EAAb;AACA,QAAIC,IAAI,GAAI,IAAZ;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYL,IAAI,CAACM,GAAL,CAAS,UAASC,QAAT,EAAmBC,KAAnB,EAAyB;AAC1C,UAAIC,IAAI,GAAGjB,EAAE,CAACkB,WAAH,CAAeP,IAAI,CAACF,GAAL,CAASU,UAAxB,CAAX;AACAR,MAAAA,IAAI,CAACS,IAAL,CAAUC,QAAV,CAAmBJ,IAAnB;AACAA,MAAAA,IAAI,GAAGA,IAAI,CAACK,YAAL,CAAkB,aAAlB,CAAP;AACAL,MAAAA,IAAI,CAACX,IAAL,CAAUK,IAAI,CAACF,GAAf,EAAoBM,QAApB;AACA,aAAOE,IAAP;AACH,KANW,CAAZ,EAOKM,IAPL,CAOU,UAAAC,MAAM,EAAI;AACZ,MAAA,KAAI,CAACd,KAAL,GAAac,MAAb;AACH,KATL;AAUH,GA1BI;AA2BLC,EAAAA,IAAI,EAAE,cAAST,KAAT,EAAe;AACjB,SAAKI,IAAL,CAAUM,cAAV;AACA,QAAIf,IAAI,GAAG,IAAX;AACA,QAAIgB,CAAC,GAAG3B,EAAE,CAAC4B,MAAH,CAAU,GAAV,EAAe5B,EAAE,CAAC6B,EAAH,CAAM,KAAKT,IAAL,CAAUU,CAAhB,EAAkB,EAAE,KAAKV,IAAL,CAAUW,MAAV,GAAiB,GAAnB,CAAlB,CAAf,EAA2DC,MAA3D,CAAkEhC,EAAE,CAACiC,SAAH,CAAa,CAAb,CAAlE,CAAR;AACA,QAAIC,EAAE,GAAGlC,EAAE,CAACmC,QAAH,CAAY,YAAW;AAC5B,UAAInB,KAAK,KAAK,CAAd,EAAiB;AACb,aAAKP,GAAL,CAAS2B,IAAT;AACH;;AACD,WAAKhB,IAAL,CAAUiB,CAAV,GAAc,CAAd;AACH,KALQ,EAKN,IALM,CAAT;;AAOA,QAAIrB,KAAK,KAAK,CAAd,EAAgB;AACZ,UAAIsB,EAAE,GAAGtC,EAAE,CAACmC,QAAH,CAAY,YAAW;AAC5B,aAAKf,IAAL,CAAUiB,CAAV,GAAc,CAAd;AACA,aAAK5B,GAAL,CAAS8B,YAAT;AACH,OAHQ,EAGN,IAHM,CAAT;AAIA,WAAKnB,IAAL,CAAUoB,SAAV,CAAoBxC,EAAE,CAACyC,QAAH,CAAYzC,EAAE,CAAC0C,SAAH,CAAa1B,KAAK,GAAC,GAAnB,CAAZ,EAAqCW,CAArC,EAAwCW,EAAxC,CAApB;AACH,KAND,MAOI,KAAKlB,IAAL,CAAUoB,SAAV,CAAoBxC,EAAE,CAACyC,QAAH,CAAYzC,EAAE,CAAC0C,SAAH,CAAa1B,KAAK,GAAC,GAAnB,CAAZ,EAAqCW,CAArC,EAAwCO,EAAxC,CAApB;AACP,GA9CI;AA+CLS,EAAAA,IAAI,EAAE,gBAAU;AACZ,SAAKvB,IAAL,CAAUM,cAAV;AACA,SAAKjB,GAAL,CAAS2B,IAAT;AACA,SAAKhB,IAAL,CAAUiB,CAAV,GAAc,CAAd;AACH;AAnDI,CAAT","sourceRoot":"/","sourcesContent":["\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n    },\r\n\r\n    onLoad () {\r\n\r\n    },\r\n    onEnable () {},\r\n\r\n    init(obj, data){\r\n        this.SLV = obj;\r\n        this.icons = [];\r\n        var self  = this;\r\n        Promise.all(data.map(function(itemType, index){\r\n            let icon = cc.instantiate(self.SLV.iconPrefab);\r\n            self.node.addChild(icon);\r\n            icon = icon.getComponent('VampireItem');\r\n            icon.init(self.SLV, itemType);\r\n            return icon;\r\n        }))\r\n            .then(result => {\r\n                this.icons = result;\r\n            });\r\n    },\r\n    spin: function(index){\r\n        this.node.stopAllActions();\r\n        var self = this;\r\n        var d = cc.moveTo(1.8, cc.v2(this.node.x,-(this.node.height-418))).easing(cc.easeInOut(3));\r\n        var p2 = cc.callFunc(function() {\r\n            if (index === 0) {\r\n                this.SLV.copy();\r\n            }\r\n            this.node.y = 0;\r\n        }, this);\r\n\r\n        if (index === 4){\r\n            var EF = cc.callFunc(function() {\r\n                this.node.y = 0;\r\n                this.SLV.runActionWon();\r\n            }, this);\r\n            this.node.runAction(cc.sequence(cc.delayTime(index*0.2), d, EF ));\r\n        } else\r\n            this.node.runAction(cc.sequence(cc.delayTime(index*0.2), d, p2));\r\n    },\r\n    stop: function(){\r\n        this.node.stopAllActions();\r\n        this.SLV.copy();\r\n        this.node.y = 0;\r\n    },\r\n});\r\n"]}