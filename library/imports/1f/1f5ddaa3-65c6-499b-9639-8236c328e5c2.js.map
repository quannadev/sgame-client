{"version":3,"sources":["assets\\_smartfox\\gui\\multiResolution\\MultiResolutionCompat.js"],"names":["cc","_decorator","ccclass","property","MultiResolutionCompat","onLoad","view","setDesignResolutionSize","DEFAULT_RESOLUTION_WIDTH","DEFAULT_RESOLUTION_HEIGHT","ResolutionPolicy","SHOW_ALL","getShowAllModeScale","Math","min","getCanvasSize","width","height","getShowAllModeRealHeight","getShowAllModeRealWidth","getShowAllModeVerticalBorderHeight","getShowAllModeHorizontalBorderWidth","getShowAllModeNodePositionCloseToBottom","nodePosInDesign","srcScaleForShowAll","bottomBorderHeightInCanvas","srcNodePosYInCanvas","y","finalNodePosYInCanvas","nodePosYInDesign","v2","x","convertNodePosInDesignToNodePosInCanvas","sub","convertNodePosInCanvasToNodePosInDesign","nodePosInCanvas","div","convertWidthInDesignToWidthInCanvas","widthInDesign","convertWidthInCanvasToWidthInDesign","widthInCanvas","convertHeightInDesignToHeightInCanvas","heightInDesign","convertHeightInCanvasToHeightInDesign","heightIncanvas","Component"],"mappings":"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","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\r\n\r\n/**\r\n * 未完成\r\n */\r\n@ccclass\r\nexport default class MultiResolutionCompat extends cc.Component {\r\n    static DEFAULT_RESOLUTION_WIDTH = 720;\r\n    static DEFAULT_RESOLUTION_HEIGHT = 1280;\r\n\r\n    onLoad() {\r\n        // 第一种：全屏拉伸，iPhoneX或平板类的会拉伸变形\r\n        // cc.view.setDesignResolutionSize(720, 1280, cc.ResolutionPolicy.EXACT_FIT);\r\n\r\n        // 第二种：1比1显示，iPhoneX上下有黑边、平板左右有黑边，但不会变形（推荐）\r\n        // cc.view.setDesignResolutionSize(720, 1280, cc.ResolutionPolicy.EXACT_FIT);\r\n        // var canvasSize = cc.view.getCanvasSize();\r\n        // var proportion = canvasSize.width / canvasSize.height;\r\n        // if (proportion >= 0.6) {\r\n        //     cc.view.setDesignResolutionSize(720, 1280, cc.ResolutionPolicy.FIXED_HEIGHT);\r\n        // } else {\r\n        //     cc.view.setDesignResolutionSize(720, 1280, cc.ResolutionPolicy.FIXED_WIDTH);\r\n        // }\r\n\r\n        // // 第三种：按照官方说明的设计分辨率宽高比和屏幕分辨率宽高比来适配\r\n        // let canvasSize = cc.view.getCanvasSize();\r\n        // let screenResolution = canvasSize.width / canvasSize.height;\r\n        // let designResolutionWidth = 720;\r\n        // let designResolutionHeight = 1280;\r\n        // let designResolution = designResolutionWidth / designResolutionHeight;\r\n        // if (CC_DEBUG) {\r\n        //     cc.log(`设计分辨率（${designResolutionWidth}x${designResolutionHeight}) 宽高比：${designResolution}`);\r\n        //     cc.log(`屏幕分辨率（${canvasSize.width}x${canvasSize.height}) 宽高比：${screenResolution}`);\r\n        //     if (designResolution > screenResolution) {\r\n        //         cc.log(\r\n        //             `设计分辨率缩放至于屏幕分辨率等高后的分辨率 (${designResolutionWidth * (canvasSize.height / designResolutionHeight)}x${\r\n        //                 canvasSize.height\r\n        //             })`\r\n        //         );\r\n        //         cc.log(\"设计分辨率宽高比大于屏幕分辨率，按照官方说法，此时应该采用(Fit Height)，实际应用后，会裁剪掉游戏左右两边的部分内容\");\r\n        //     } else if (designResolution < screenResolution) {\r\n        //         cc.log(\r\n        //             `设计分辨率缩放至于屏幕分辨率等宽后的分辨率 (${canvasSize.width}x${designResolutionHeight *\r\n        //                 (canvasSize.width / designResolutionWidth)})`\r\n        //         );\r\n        //         cc.log(\"设计分辨率宽高比小于屏幕分辨率，按照官方说法，此时应该采用(Fit Width)，实际应用后，会裁剪掉游戏上下两边的部分内容\");\r\n        //     } else {\r\n        //         cc.log(\"设计分辨率宽高比等于屏幕分辨率\");\r\n        //     }\r\n        // }\r\n        // if (designResolution > screenResolution) {\r\n        //     cc.view.setDesignResolutionSize(\r\n        //         designResolutionWidth,\r\n        //         designResolutionHeight,\r\n        //         cc.ResolutionPolicy.FIXED_HEIGHT\r\n        //     );\r\n        // } else {\r\n        //     cc.view.setDesignResolutionSize(\r\n        //         designResolutionWidth,\r\n        //         designResolutionHeight,\r\n        //         cc.ResolutionPolicy.FIXED_WIDTH\r\n        //     );\r\n        // }\r\n\r\n        // 第四种：直接等比例缩放至屏幕上宽高最短的那条边，后续控制背景拉伸\r\n        cc.view.setDesignResolutionSize(\r\n            MultiResolutionCompat.DEFAULT_RESOLUTION_WIDTH,\r\n            MultiResolutionCompat.DEFAULT_RESOLUTION_HEIGHT,\r\n            cc.ResolutionPolicy.SHOW_ALL\r\n        );\r\n\r\n        // this.node.scale = 1.1\r\n        // this.node.position = cc.v2(0, -100)\r\n        // this.node.position = this.node.position.sub(cc.v2(0, 100))\r\n        // if (CC_DEBUG) {\r\n        //     cc.log(`屏幕分辨率: ${cc.view.getCanvasSize().width} x ${cc.view.getCanvasSize().height}`);\r\n        //     cc.log(`视图窗口可见区域分辨率: ${cc.view.getVisibleSize().width} x ${cc.view.getVisibleSize().height}`);\r\n        //     cc.log(`视图中边框尺寸: ${cc.view.getFrameSize().width} x ${cc.view.getFrameSize().height}`);\r\n        //     cc.log(`设备或浏览器像素比例: ${cc.view.getDevicePixelRatio()}`);\r\n        //     cc.log(\"调整前\");\r\n        //     cc.log(`节点宽高: ${this.node.width} x ${this.node.height}`);\r\n        //     cc.log(`节点缩放: ${this.node.scaleX} x ${this.node.scaleY}`);\r\n        // }\r\n        // if (cc.view.getCanvasSize().width > cc.view.getCanvasSize().height) {\r\n        //     this.backgroundNode.scale = cc.view.getCanvasSize().width / 720;\r\n        // } else {\r\n        //     this.backgroundNode.scale = cc.view.getCanvasSize().height / 1280;\r\n        // }\r\n        // if (CC_DEBUG) {\r\n        //     cc.log(\"调整后\");\r\n        //     cc.log(`节点宽高: ${this.node.width} x ${this.node.height}`);\r\n        //     cc.log(`节点缩放: ${this.node.scaleX} x ${this.node.scaleY}`);\r\n        // }\r\n    }\r\n\r\n    /**\r\n     * 计算当前游戏设计分辨率在ShowAll模式适配后，设计分辨率做出的缩放值\r\n     */\r\n    static getShowAllModeScale() {\r\n        return Math.min(\r\n            cc.view.getCanvasSize().width / this.DEFAULT_RESOLUTION_WIDTH,\r\n            cc.view.getCanvasSize().height / this.DEFAULT_RESOLUTION_HEIGHT\r\n        );\r\n    }\r\n\r\n    /**\r\n     * 计算当前游戏设计分辨率在ShowAll模式适配后，设计分辨率下的界面在实际画布中的实际高度\r\n     */\r\n    static getShowAllModeRealHeight() {\r\n        return this.DEFAULT_RESOLUTION_HEIGHT * this.getShowAllModeScale();\r\n    }\r\n\r\n    /**\r\n     * 计算当前游戏设计分辨率在ShowAll模式适配后，设计分辨率下的界面在实际画布中的实际宽度\r\n     */\r\n    static getShowAllModeRealWidth() {\r\n        return this.DEFAULT_RESOLUTION_WIDTH * this.getShowAllModeScale();\r\n    }\r\n\r\n    /**\r\n     * 计算当前游戏设计分辨率在ShowAll模式适配后，上下边界的黑边之和在实际画布中的长度\r\n     */\r\n    static getShowAllModeVerticalBorderHeight() {\r\n        return cc.view.getCanvasSize().height - this.getShowAllModeRealHeight();\r\n    }\r\n\r\n    /**\r\n     * 计算当前游戏设计分辨率在ShowAll模式适配后，左右边界的黑边之和在实际画布中的长度\r\n     */\r\n    static getShowAllModeHorizontalBorderWidth() {\r\n        return cc.view.getCanvasSize().width - this.getShowAllModeRealWidth();\r\n    }\r\n\r\n    /**\r\n     * 计算当前游戏设计分辨率在ShowAll模式适配后，传入来的原始坐标在ShowAll模式下的「贴近屏幕底部」实际坐标值\r\n     */\r\n    static getShowAllModeNodePositionCloseToBottom(nodePosInDesign) {\r\n        let srcScaleForShowAll = MultiResolutionCompat.getShowAllModeScale();\r\n        let bottomBorderHeightInCanvas = MultiResolutionCompat.getShowAllModeVerticalBorderHeight() / 2;\r\n        let srcNodePosYInCanvas = nodePosInDesign.y * srcScaleForShowAll;\r\n        let finalNodePosYInCanvas = srcNodePosYInCanvas - bottomBorderHeightInCanvas;\r\n        let nodePosYInDesign = finalNodePosYInCanvas / srcScaleForShowAll;\r\n        return cc.v2(nodePosInDesign.x, nodePosYInDesign);\r\n    }\r\n\r\n    /**\r\n     * 将节点在设计分辨率中的坐标转换为节点在实际画布中的坐标\r\n     */\r\n    static convertNodePosInDesignToNodePosInCanvas(nodePosInDesign) {\r\n        return nodePosInDesign.sub(cc.v2(this.getShowAllModeScale(), this.getShowAllModeScale()));\r\n    }\r\n\r\n    /**\r\n     * 将节点在实际画布中的坐标转换为节点在设计分辨率中的坐标\r\n     */\r\n    static convertNodePosInCanvasToNodePosInDesign(nodePosInCanvas) {\r\n        return nodePosInCanvas.div(cc.v2(this.getShowAllModeScale(), this.getShowAllModeScale()));\r\n    }\r\n\r\n    /**\r\n     * 将设计分辨率下的宽度转换为实际画布中的宽度\r\n     *\r\n     * @param widthInDesign 设计分辨率下的宽度\r\n     */\r\n    static convertWidthInDesignToWidthInCanvas(widthInDesign) {\r\n        return widthInDesign * this.getShowAllModeScale();\r\n    }\r\n\r\n    /**\r\n     * 将实际画布中的宽度转换为设计分辨率下的宽度\r\n     *\r\n     * @param widthInCanvas 画布中的宽度\r\n     */\r\n    static convertWidthInCanvasToWidthInDesign(widthInCanvas) {\r\n        return widthInCanvas / this.getShowAllModeScale();\r\n    }\r\n\r\n    /**\r\n     * 将设计分辨率下的高度转换为实际画布中的高度\r\n     *\r\n     * @param heightInDesign 设计分辨率下的高度\r\n     */\r\n    static convertHeightInDesignToHeightInCanvas(heightInDesign) {\r\n        return heightInDesign * this.getShowAllModeScale();\r\n    }\r\n\r\n    /**\r\n     * 将实际画布中的高度转换为设计分辨率下的宽度\r\n     * @param heightIncanvas 画布中的高度\r\n     */\r\n    static convertHeightInCanvasToHeightInDesign(heightIncanvas) {\r\n        return heightIncanvas / this.getShowAllModeScale();\r\n    }\r\n}\r\n"]}