
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/abase/UIManager.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '9bdfa1o7QlJs4w16ipJkrXc', 'UIManager');
// scripts/abase/UIManager.js

"use strict";

var UIManger = {};
UIManger.show = function (name, option, complete) {
  var _this = this;

  if (!name || name === '') {
    cc.error('name is empty!');
    return;
  }

  var scene = cc.director.getScene();
  var node = cc.find(name, scene);

  if (node) {
    node.active = false;

    this._setOption(node, option);

    node.setSiblingIndex(-1);
    node.active = true;

    if (!node._pop) {
      var ui = this._getUIFromIndex(-2);

      if (ui) {
        if (ui.name != cc.currentUI) {
          ui.active = false;
        }
      }
    }

    mm.Loading.hide();
    if (complete) complete();
    return;
  }

  if (option && option.src !== undefined && option.src !== null) {
    name = option.src + "/" + name;
  }

  cc.loader.loadRes(name, function (err, prefab) {
    if (err) {
      console.log(err);
      return;
    }

    if (cc.find(name, scene)) {
      if (complete) complete();
      return;
    }

    cc.loader.setAutoReleaseRecursively(prefab, true);
    var node = cc.instantiate(prefab);

    if (!node) {
      cc.error('prefab instantiation failed!');
    } else {
      var _ui = _this._getUIFromIndex(-1);

      if (_ui) {
        _ui.active = !!(option && option.pop);
      }

      _this._setOption(node, option);

      scene.addChild(node);
      mm.Loading.hide();
      if (complete) complete();
    }
  });
}, UIManger._getUIFromIndex = function (from) {
  var scene = cc.director.getScene();

  if (!Number.isInteger(from)) {
    from = scene.childrenCount - 1;
  }

  if (from < 0) {
    from += scene.childrenCount;
  }

  if (from < 0 || from > scene.childrenCount - 1) {
    cc.log('_getUIFromIndex error, from = ' + from + '!');
    return;
  }

  for (var index = from; index >= 0; index--) {
    var element = scene.children[index];

    if (element.name.startsWith('UI')) {
      return element;
    }
  }
}, UIManger._setOption = function (node, option) {
  if (option && option.data !== undefined && option.data !== null) {
    var script = node.getComponent(node.name);

    if (script) {
      script._data = option.data;
    }
  }

  node._pop = !!(option && option.pop);
};

UIManger.getUIFromName = function (name) {
  if (!name || !name.startsWith('UI')) {
    return;
  }

  var scene = cc.director.getScene();
  return cc.find(name, scene);
};

window.UIManger = module.exports = UIManger;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9zY3JpcHRzL2FiYXNlL1VJTWFuYWdlci5qcyJdLCJuYW1lcyI6WyJVSU1hbmdlciIsInNob3ciLCJuYW1lIiwib3B0aW9uIiwiY29tcGxldGUiLCJjYyIsImVycm9yIiwic2NlbmUiLCJkaXJlY3RvciIsImdldFNjZW5lIiwibm9kZSIsImZpbmQiLCJhY3RpdmUiLCJfc2V0T3B0aW9uIiwic2V0U2libGluZ0luZGV4IiwiX3BvcCIsInVpIiwiX2dldFVJRnJvbUluZGV4IiwiY3VycmVudFVJIiwibW0iLCJMb2FkaW5nIiwiaGlkZSIsInNyYyIsInVuZGVmaW5lZCIsImxvYWRlciIsImxvYWRSZXMiLCJlcnIiLCJwcmVmYWIiLCJjb25zb2xlIiwibG9nIiwic2V0QXV0b1JlbGVhc2VSZWN1cnNpdmVseSIsImluc3RhbnRpYXRlIiwicG9wIiwiYWRkQ2hpbGQiLCJmcm9tIiwiTnVtYmVyIiwiaXNJbnRlZ2VyIiwiY2hpbGRyZW5Db3VudCIsImluZGV4IiwiZWxlbWVudCIsImNoaWxkcmVuIiwic3RhcnRzV2l0aCIsImRhdGEiLCJzY3JpcHQiLCJnZXRDb21wb25lbnQiLCJfZGF0YSIsImdldFVJRnJvbU5hbWUiLCJ3aW5kb3ciLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLFFBQVEsR0FBRyxFQUFmO0FBQ0FBLFFBQVEsQ0FBQ0MsSUFBVCxHQUFnQixVQUFTQyxJQUFULEVBQWVDLE1BQWYsRUFBdUJDLFFBQXZCLEVBQWdDO0FBQUE7O0FBQzVDLE1BQUksQ0FBQ0YsSUFBRCxJQUFTQSxJQUFJLEtBQUssRUFBdEIsRUFBMEI7QUFDdEJHLElBQUFBLEVBQUUsQ0FBQ0MsS0FBSCxDQUFTLGdCQUFUO0FBQ0E7QUFDSDs7QUFDRCxNQUFNQyxLQUFLLEdBQUdGLEVBQUUsQ0FBQ0csUUFBSCxDQUFZQyxRQUFaLEVBQWQ7QUFDQSxNQUFNQyxJQUFJLEdBQUdMLEVBQUUsQ0FBQ00sSUFBSCxDQUFR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QWhCLENBQWQsRUFBcUM7QUFDakM7QUFDSDs7QUFDRCxNQUFNbEMsS0FBSyxHQUFHRixFQUFFLENBQUNHLFFBQUgsQ0FBWUMsUUFBWixFQUFkO0FBQ0EsU0FBT0osRUFBRSxDQUFDTSxJQUFILENBQVFULElBQVIsRUFBY0ssS0FBZCxDQUFQO0FBQ0gsQ0FORDs7QUFPQXdDLE1BQU0sQ0FBQy9DLFFBQVAsR0FBa0JnRCxNQUFNLENBQUNDLE9BQVAsR0FBaUJqRCxRQUFuQyIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsibGV0IFVJTWFuZ2VyID0ge307XG5VSU1hbmdlci5zaG93ID0gZnVuY3Rpb24obmFtZSwgb3B0aW9uLCBjb21wbGV0ZSl7XG4gICAgaWYgKCFuYW1lIHx8IG5hbWUgPT09ICcnKSB7XG4gICAgICAgIGNjLmVycm9yKCduYW1lIGlzIGVtcHR5IScpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHNjZW5lID0gY2MuZGlyZWN0b3IuZ2V0U2NlbmUoKTtcbiAgICBjb25zdCBub2RlID0gY2MuZmluZChuYW1lLCBzY2VuZSk7XG4gICAgaWYgKG5vZGUpIHtcbiAgICAgICAgbm9kZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fc2V0T3B0aW9uKG5vZGUsIG9wdGlvbik7XG4gICAgICAgIG5vZGUuc2V0U2libGluZ0luZGV4KC0xKTtcbiAgICAgICAgbm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICBpZiAoIW5vZGUuX3BvcCkge1xuICAgICAgICAgICAgbGV0IHVpID0gdGhpcy5fZ2V0VUlGcm9tSW5kZXgoLTIpO1xuICAgICAgICAgICAgaWYgKHVpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHVpLm5hbWUhPSBjYy5jdXJyZW50VUkpe1xuICAgICAgICAgICAgICAgICAgICB1aS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBtbS5Mb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgaWYoY29tcGxldGUpXG4gICAgICAgICAgICBjb21wbGV0ZSgpO1xuICAgICAgICByZXR1cm5cbiAgICB9XG4gICAgaWYgKG9wdGlvbiAmJiAob3B0aW9uLnNyYyAhPT0gdW5kZWZpbmVkKSAmJiAob3B0aW9uLnNyYyAhPT0gbnVsbCkpIHtcbiAgICAgICAgbmFtZSA9IG9wdGlvbi5zcmMrXCIvXCIrIG5hbWU7XG4gICAgfVxuICAgIGNjLmxvYWRlci5sb2FkUmVzKG5hbWUsKGVyciwgcHJlZmFiKSA9PiB7XG4gICAgICAgIGlmKGVycil7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjYy5maW5kKG5hbWUsIHNjZW5lKSkge1xuICAgICAgICAgICAgaWYoY29tcGxldGUpXG4gICAgICAgICAgICAgICAgY29tcGxldGUoKTtcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICAgIGNjLmxvYWRlci5zZXRBdXRvUmVsZWFzZVJlY3Vyc2l2ZWx5KHByZWZhYiwgdHJ1ZSk7XG4gICAgICAgIGNvbnN0IG5vZGUgPSBjYy5pbnN0YW50aWF0ZShwcmVmYWIpO1xuICAgICAgICBpZiAoIW5vZGUpIHtcbiAgICAgICAgICAgIGNjLmVycm9yKCdwcmVmYWIgaW5zdGFudGlhdGlvbiBmYWlsZWQhJylcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCB1aSA9IHRoaXMuX2dldFVJRnJvbUluZGV4KC0xKTtcbiAgICAgICAgICAgIGlmICh1aSkge1xuICAgICAgICAgICAgICAgIHVpLmFjdGl2ZSA9ICEhKG9wdGlvbiAmJiBvcHRpb24ucG9wKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3NldE9wdGlvbihub2RlLCBvcHRpb24pO1xuICAgICAgICAgICAgc2NlbmUuYWRkQ2hpbGQobm9kZSk7XG4gICAgICAgICAgICBtbS5Mb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgICAgIGlmKGNvbXBsZXRlKSBjb21wbGV0ZSgpO1xuICAgICAgICB9XG4gICAgfSk7XG59LFxuVUlNYW5nZXIuX2dldFVJRnJvbUluZGV4ID0gZnVuY3Rpb24oZnJvbSkge1xuICAgIGNvbnN0IHNjZW5lID0gY2MuZGlyZWN0b3IuZ2V0U2NlbmUoKTtcbiAgICBpZiAoIU51bWJlci5pc0ludGVnZXIoZnJvbSkpIHtcbiAgICAgICAgZnJvbSA9IHNjZW5lLmNoaWxkcmVuQ291bnQgLSAxXG4gICAgfVxuICAgIGlmIChmcm9tIDwgMCkge1xuICAgICAgICBmcm9tICs9IHNjZW5lLmNoaWxkcmVuQ291bnRcbiAgICB9XG4gICAgaWYgKChmcm9tIDwgMCkgfHwgKGZyb20gPiBzY2VuZS5jaGlsZHJlbkNvdW50IC0gMSkpIHtcbiAgICAgICAgY2MubG9nKCdfZ2V0VUlGcm9tSW5kZXggZXJyb3IsIGZyb20gPSAnICsgZnJvbSArICchJyk7XG4gICAgICAgIHJldHVyblxuICAgIH1cbiAgICBmb3IgKGxldCBpbmRleCA9IGZyb207IGluZGV4ID49IDA7IGluZGV4LS0pIHtcbiAgICAgICAgbGV0IGVsZW1lbnQgPSBzY2VuZS5jaGlsZHJlbltpbmRleF07XG5cbiAgICAgICAgaWYgKGVsZW1lbnQubmFtZS5zdGFydHNXaXRoKCdVSScpKSB7XG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudFxuICAgICAgICB9XG4gICAgfVxufSxcblVJTWFuZ2VyLl9zZXRPcHRpb24gPSBmdW5jdGlvbihub2RlLCBvcHRpb24pIHtcbiAgICBpZiAob3B0aW9uICYmIChvcHRpb24uZGF0YSAhPT0gdW5kZWZpbmVkKSAmJiAob3B0aW9uLmRhdGEgIT09IG51bGwpKSB7XG4gICAgICAgIGNvbnN0IHNjcmlwdCA9IG5vZGUuZ2V0Q29tcG9uZW50KG5vZGUubmFtZSk7XG4gICAgICAgIGlmIChzY3JpcHQpIHtcbiAgICAgICAgICAgIHNjcmlwdC5fZGF0YSA9IG9wdGlvbi5kYXRhXG4gICAgICAgIH1cbiAgICB9XG4gICAgbm9kZS5fcG9wID0gISEob3B0aW9uICYmIG9wdGlvbi5wb3ApO1xufVxuVUlNYW5nZXIuZ2V0VUlGcm9tTmFtZSA9IGZ1bmN0aW9uKG5hbWUpe1xuICAgIGlmICghbmFtZSB8fCAhbmFtZS5zdGFydHNXaXRoKCdVSScpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3Qgc2NlbmUgPSBjYy5kaXJlY3Rvci5nZXRTY2VuZSgpO1xuICAgIHJldHVybiBjYy5maW5kKG5hbWUsIHNjZW5lKVxufVxud2luZG93LlVJTWFuZ2VyID0gbW9kdWxlLmV4cG9ydHMgPSBVSU1hbmdlcjtcbiJdfQ==