
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/abase/Card.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '0576fWjH4dAXrjF8gIXbQyP', 'Card');
// scripts/abase/Card.js

"use strict";

cc.Class({
  "extends": cc.Component,
  properties: {
    _isSelected: false,
    bg: cc.Node,
    _card: null,
    _cbSelect: null,
    _removeSelect: true,
    over: cc.Node
  },
  onLoad: function onLoad() {
    this.over.active = false;
  },
  showOver: function showOver() {
    this.over.active = true;
  },
  hideOver: function hideOver() {
    this.over.active = false;
  },
  addEventSelect: function addEventSelect(cb) {
    this._cbSelect = cb;
  },
  isSelected: function isSelected() {
    return this._isSelected;
  },
  getCard: function getCard() {
    return this._card;
  },
  setCard: function setCard(card) {
    this._card = card;
  },
  _loadCardBack: function _loadCardBack() {
    cc.loader.loadRes("images/cards", cc.SpriteAtlas, function (err, atlas) {
      if (err) {
        console.log(err);
        return;
      }

      this.bg.getComponent(cc.Sprite).spriteFrame = atlas.getSpriteFrame("-1");
    }.bind(this));
  },
  _loadCard: function _loadCard() {
    cc.loader.loadRes("images/cards", cc.SpriteAtlas, function (err, atlas) {
      if (err) {
        console.log(err);
        return;
      }

      this.bg.getComponent(cc.Sprite).spriteFrame = atlas.getSpriteFrame(this._card.nameFile);
    }.bind(this));
  },
  init: function init(card, _removeSelect) {
    this.node.active = true;
    this.hideOver();

    if (card == null) {
      this._loadCardBack();
    } else {
      this._card = card;

      if (_removeSelect != undefined) {
        this._removeSelect = _removeSelect;
      } else {
        this._removeSelect = true;
      }

      this._loadCard();
    }
  },
  reveal: function reveal(card, pIsFaceUp) {
    this.node.active = true;
    this.hideOver();

    this._loadCardBack();

    this._card = card;
    var self = this;
    var timeFlip = 0.45;
    var callFunc = cc.callFunc(function () {
      self._loadCard();

      if (!pIsFaceUp) self.node.skewY = 170;else self.node.skewY = 45;
    });

    if (!pIsFaceUp) {
      self.node.skewY = 0;
      var action = cc.skewBy(timeFlip / 2, 0, 10);
      var action2 = cc.skewTo(timeFlip / 2, 0, 180);
      self.node.runAction(cc.sequence(action, callFunc, action2));
    } else {
      self.node.skewY = 180;

      var _action = cc.skewBy(timeFlip / 2, 0, -35);

      var _action2 = cc.skewTo(timeFlip / 2, 0, 0);

      self.node.runAction(cc.sequence(_action, callFunc, _action2));
    }
  },
  switchCard: function switchCard(pIsFaceUp) {
    var self = this;
    var timeFlip = 0.45;
    var callFunc = cc.callFunc(function () {
      self._loadCard();

      if (!pIsFaceUp) self.node.skewY = 170;else self.node.skewY = 45;
    });
    self.node.skewY = 0;
    var action = cc.skewBy(timeFlip / 2, 0, 10);
    var action2 = cc.skewTo(timeFlip / 2, 0, 180);
    self.node.runAction(cc.sequence(action, callFunc, action2));

    if (!pIsFaceUp) {
      self.node.skewY = 0;

      var _action3 = cc.skewBy(timeFlip / 2, 0, 10);

      var _action4 = cc.skewTo(timeFlip / 2, 0, 180);

      self.node.runAction(cc.sequence(_action3, callFunc, _action4));
    } else {
      self.node.skewY = 180;

      var _action5 = cc.skewBy(timeFlip / 2, 0, -35);

      var _action6 = cc.skewTo(timeFlip / 2, 0, 0);

      self.node.runAction(cc.sequence(_action5, callFunc, _action6));
    }
  },
  reset: function reset() {
    this._loadCardBack();

    this.hideOver();
    this.node._zIndex = 0;
    this.node.x = 0;
    this.node.y = 0;
    this._isSelected = false;
    this._card = null;
    this._cbSelect = null;
    this._removeSelect = true;
  },
  eventSelect: function eventSelect() {
    if (!this._removeSelect) {
      if (!this._isSelected) {
        this._isSelected = true;
        this.node.y = this.node.y + 20;

        if (this._cbSelect) {
          this._cbSelect(this.getCard().id);
        }
      } else {
        this._isSelected = false;
        this.node.y = this.node.y - 20;
      }
    }
  },
  setScaleCard: function setScaleCard(scaleCard) {
    this.node.width *= scaleCard;
    this.node.height *= scaleCard;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcYWJhc2VcXENhcmQuanMiXSwibmFtZXMiOlsiY2MiLCJDbGFzcyIsIkNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJfaXNTZWxlY3RlZCIsImJnIiwiTm9kZSIsIl9jYXJkIiwiX2NiU2VsZWN0IiwiX3JlbW92ZVNlbGVjdCIsIm92ZXIiLCJvbkxvYWQiLCJhY3RpdmUiLCJzaG93T3ZlciIsImhpZGVPdmVyIiwiYWRkRXZlbnRTZWxlY3QiLCJjYiIsImlzU2VsZWN0ZWQiLCJnZXRDYXJkIiwic2V0Q2FyZCIsImNhcmQiLCJfbG9hZENhcmRCYWNrIiwibG9hZGVyIiwibG9hZFJlcyIsIlNwcml0ZUF0bGFzIiwiZXJyIiwiYXRsYXMiLCJjb25zb2xlIiwibG9nIiwiZ2V0Q29tcG9uZW50IiwiU3ByaXRlIiwic3ByaXRlRnJhbWUiLCJnZXRTcHJpdGVGcmFtZSIsImJpbmQiLCJfbG9hZENhcmQiLCJuYW1lRmlsZSIsImluaXQiLCJub2RlIiwidW5kZWZpbmVkIiwicmV2ZWFsIiwicElzRmFjZVVwIiwic2VsZiIsInRpbWVGbGlwIiwiY2FsbEZ1bmMiLCJza2V3WSIsImFjdGlvbiIsInNrZXdCeSIsImFjdGlvbjIiLCJza2V3VG8iLCJydW5BY3Rpb24iLCJzZXF1ZW5jZSIsInN3aXRjaENhcmQiLCJyZXNldCIsIl96SW5kZXgiLCJ4IiwieSIsImV2ZW50U2VsZWN0IiwiaWQiLCJzZXRTY2FsZUNhcmQiLCJzY2FsZUNhcmQiLCJ3aWR0aCIsImhlaWdodCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQUEsRUFBRSxDQUFDQyxLQUFILENBQVM7QUFDTCxhQUFTRCxFQUFFLENBQUNFLFNBRFA7QUFHTEMsRUFBQUEsVUFBVSxFQUFFO0FBQ1JDLElBQUFBLFdBQVcsRUFBRSxLQURMO0FBRVJDLElBQUFBLEVBQUUsRUFBR0wsRUFBRSxDQUFDTSxJQUZBO0FBR1JDLElBQUFBLEtBQUssRUFBRSxJQUhDO0FBSVJDLElBQUFBLFNB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QUFMLEdBQWlCLElBQWpCO0FBQ0EsU0FBS0MsYUFBTCxHQUFxQixJQUFyQjtBQUNILEdBbklJO0FBb0lMK0MsRUFBQUEsV0FwSUsseUJBb0lRO0FBQ1QsUUFBRyxDQUFDLEtBQUsvQyxhQUFULEVBQXVCO0FBQ25CLFVBQUcsQ0FBQyxLQUFLTCxXQUFULEVBQXFCO0FBQ2pCLGFBQUtBLFdBQUwsR0FBbUIsSUFBbkI7QUFDQSxhQUFLaUMsSUFBTCxDQUFVa0IsQ0FBVixHQUFjLEtBQUtsQixJQUFMLENBQVVrQixDQUFWLEdBQWMsRUFBNUI7O0FBQ0EsWUFBRyxLQUFLL0MsU0FBUixFQUFrQjtBQUNkLGVBQUtBLFNBQUwsQ0FBZSxLQUFLVSxPQUFMLEdBQWV1QyxFQUE5QjtBQUNIO0FBQ0osT0FORCxNQU1LO0FBQ0QsYUFBS3JELFdBQUwsR0FBbUIsS0FBbkI7QUFDQSxhQUFLaUMsSUFBTCxDQUFVa0IsQ0FBVixHQUFjLEtBQUtsQixJQUFMLENBQVVrQixDQUFWLEdBQWMsRUFBNUI7QUFDSDtBQUNKO0FBQ0osR0FqSkk7QUFrSkxHLEVBQUFBLFlBbEpLLHdCQWtKUUMsU0FsSlIsRUFrSmtCO0FBQ25CLFNBQUt0QixJQUFMLENBQVV1QixLQUFWLElBQW9CRCxTQUFwQjtBQUNBLFNBQUt0QixJQUFMLENBQVV3QixNQUFWLElBQW9CRixTQUFwQjtBQUNIO0FBckpJLENBQVQiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgX2lzU2VsZWN0ZWQ6IGZhbHNlLFxyXG4gICAgICAgIGJnIDogY2MuTm9kZSxcclxuICAgICAgICBfY2FyZDogbnVsbCxcclxuICAgICAgICBfY2JTZWxlY3QgOiBudWxsLFxyXG4gICAgICAgIF9yZW1vdmVTZWxlY3Q6IHRydWUsXHJcbiAgICAgICAgb3ZlcjogY2MuTm9kZVxyXG4gICAgfSxcclxuICAgIG9uTG9hZCgpe1xyXG4gICAgICAgIHRoaXMub3Zlci5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBzaG93T3Zlcigpe1xyXG4gICAgICAgIHRoaXMub3Zlci5hY3RpdmUgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIGhpZGVPdmVyKCl7XHJcbiAgICAgICAgdGhpcy5vdmVyLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgfSxcclxuICAgIGFkZEV2ZW50U2VsZWN0KGNiKXtcclxuICAgICAgICB0aGlzLl9jYlNlbGVjdCA9IGNiO1xyXG4gICAgfSxcclxuICAgIGlzU2VsZWN0ZWQoKXtcclxuICAgICAgICByZXR1cm4gdGhpcy5faXNTZWxlY3RlZDtcclxuICAgIH0sXHJcbiAgICBnZXRDYXJkKCl7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhcmQ7XHJcbiAgICB9LFxyXG4gICAgc2V0Q2FyZChjYXJkKXtcclxuICAgICAgICB0aGlzLl9jYXJkID0gY2FyZDtcclxuICAgIH0sXHJcbiAgICBfbG9hZENhcmRCYWNrKCl7XHJcbiAgICAgICAgY2MubG9hZGVyLmxvYWRSZXMoXCJpbWFnZXMvY2FyZHNcIiwgY2MuU3ByaXRlQXRsYXMsIGZ1bmN0aW9uIChlcnIsIGF0bGFzKSB7XHJcbiAgICAgICAgICAgIGlmKGVycil7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuYmcuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBhdGxhcy5nZXRTcHJpdGVGcmFtZShcIi0xXCIpO1xyXG4gICAgICAgIH0uYmluZCh0aGlzKSk7XHJcbiAgICB9LFxyXG4gICAgX2xvYWRDYXJkKCl7XHJcbiAgICAgICAgY2MubG9hZGVyLmxvYWRSZXMoXCJpbWFnZXMvY2FyZHNcIiwgY2MuU3ByaXRlQXRsYXMsIGZ1bmN0aW9uIChlcnIsIGF0bGFzKSB7XHJcbiAgICAgICAgICAgIGlmKGVycil7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuYmcuZ2V0Q29tcG9uZW50KGNjLlNwcml0ZSkuc3ByaXRlRnJhbWUgPSBhdGxhcy5nZXRTcHJpdGVGcmFtZSh0aGlzLl9jYXJkLm5hbWVGaWxlKTtcclxuICAgICAgICB9LmJpbmQodGhpcykpO1xyXG4gICAgfSxcclxuICAgIGluaXQoY2FyZCwgX3JlbW92ZVNlbGVjdCl7XHJcbiAgICAgICAgdGhpcy5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5oaWRlT3ZlcigpO1xyXG4gICAgICAgIGlmKGNhcmQgPT0gbnVsbCl7XHJcbiAgICAgICAgICAgIHRoaXMuX2xvYWRDYXJkQmFjaygpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aGlzLl9jYXJkID0gY2FyZDtcclxuICAgICAgICAgICAgaWYoX3JlbW92ZVNlbGVjdCAhPSB1bmRlZmluZWQpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlU2VsZWN0ID0gX3JlbW92ZVNlbGVjdDtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVTZWxlY3QgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX2xvYWRDYXJkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHJldmVhbChjYXJkLCBwSXNGYWNlVXApe1xyXG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuaGlkZU92ZXIoKTtcclxuICAgICAgICB0aGlzLl9sb2FkQ2FyZEJhY2soKTtcclxuICAgICAgICB0aGlzLl9jYXJkID0gY2FyZDtcclxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgbGV0IHRpbWVGbGlwID0gMC40NTtcclxuICAgICAgICBsZXQgY2FsbEZ1bmMgPSBjYy5jYWxsRnVuYyhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHNlbGYuX2xvYWRDYXJkKCk7XHJcbiAgICAgICAgICAgIGlmKCFwSXNGYWNlVXApXHJcbiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuc2tld1kgPSAxNzA7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHNlbGYubm9kZS5za2V3WSA9IDQ1O1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmKCFwSXNGYWNlVXApXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzZWxmLm5vZGUuc2tld1kgPSAwO1xyXG4gICAgICAgICAgICBsZXQgYWN0aW9uID0gY2Muc2tld0J5KHRpbWVGbGlwLzIsMCwxMCk7XHJcbiAgICAgICAgICAgIGxldCBhY3Rpb24yID0gY2Muc2tld1RvKHRpbWVGbGlwLzIsMCwxODApO1xyXG4gICAgICAgICAgICBzZWxmLm5vZGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGFjdGlvbixjYWxsRnVuYyxhY3Rpb24yKSk7XHJcbiAgICAgICAgfWVsc2VcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHNlbGYubm9kZS5za2V3WSA9IDE4MDtcclxuICAgICAgICAgICAgbGV0IGFjdGlvbiA9IGNjLnNrZXdCeSh0aW1lRmxpcC8yLDAsLTM1KTtcclxuICAgICAgICAgICAgbGV0IGFjdGlvbjIgPSBjYy5za2V3VG8odGltZUZsaXAvMiwwLDApO1xyXG4gICAgICAgICAgICBzZWxmLm5vZGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGFjdGlvbixjYWxsRnVuYyxhY3Rpb24yKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHN3aXRjaENhcmQocElzRmFjZVVwKSB7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIGxldCB0aW1lRmxpcCA9IDAuNDU7XHJcbiAgICAgICAgbGV0IGNhbGxGdW5jID0gY2MuY2FsbEZ1bmMoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBzZWxmLl9sb2FkQ2FyZCgpO1xyXG4gICAgICAgICAgICBpZighcElzRmFjZVVwKVxyXG4gICAgICAgICAgICAgICAgc2VsZi5ub2RlLnNrZXdZID0gMTcwO1xyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICBzZWxmLm5vZGUuc2tld1kgPSA0NTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBzZWxmLm5vZGUuc2tld1kgPSAwO1xyXG4gICAgICAgIGxldCBhY3Rpb24gPSBjYy5za2V3QnkodGltZUZsaXAvMiwwLDEwKTtcclxuICAgICAgICBsZXQgYWN0aW9uMiA9IGNjLnNrZXdUbyh0aW1lRmxpcC8yLDAsMTgwKTtcclxuICAgICAgICBzZWxmLm5vZGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGFjdGlvbixjYWxsRnVuYyxhY3Rpb24yKSk7XHJcbiAgICAgICAgaWYoIXBJc0ZhY2VVcClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHNlbGYubm9kZS5za2V3WSA9IDA7XHJcbiAgICAgICAgICAgIGxldCBhY3Rpb24gPSBjYy5za2V3QnkodGltZUZsaXAvMiwwLDEwKTtcclxuICAgICAgICAgICAgbGV0IGFjdGlvbjIgPSBjYy5za2V3VG8odGltZUZsaXAvMiwwLDE4MCk7XHJcbiAgICAgICAgICAgIHNlbGYubm9kZS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoYWN0aW9uLGNhbGxGdW5jLGFjdGlvbjIpKTtcclxuICAgICAgICB9ZWxzZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgc2VsZi5ub2RlLnNrZXdZID0gMTgwO1xyXG4gICAgICAgICAgICBsZXQgYWN0aW9uID0gY2Muc2tld0J5KHRpbWVGbGlwLzIsMCwtMzUpO1xyXG4gICAgICAgICAgICBsZXQgYWN0aW9uMiA9IGNjLnNrZXdUbyh0aW1lRmxpcC8yLDAsMCk7XHJcbiAgICAgICAgICAgIHNlbGYubm9kZS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoYWN0aW9uLGNhbGxGdW5jLGFjdGlvbjIpKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgcmVzZXQoKXtcclxuICAgICAgICB0aGlzLl9sb2FkQ2FyZEJhY2soKTtcclxuICAgICAgICB0aGlzLmhpZGVPdmVyKCk7XHJcbiAgICAgICAgdGhpcy5ub2RlLl96SW5kZXggPSAwO1xyXG4gICAgICAgIHRoaXMubm9kZS54ID0gMDtcclxuICAgICAgICB0aGlzLm5vZGUueSA9IDA7XHJcbiAgICAgICAgdGhpcy5faXNTZWxlY3RlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2NhcmQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2NiU2VsZWN0ID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9yZW1vdmVTZWxlY3QgPSB0cnVlO1xyXG4gICAgfSxcclxuICAgIGV2ZW50U2VsZWN0KCl7XHJcbiAgICAgICAgaWYoIXRoaXMuX3JlbW92ZVNlbGVjdCl7XHJcbiAgICAgICAgICAgIGlmKCF0aGlzLl9pc1NlbGVjdGVkKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2lzU2VsZWN0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLnkgPSB0aGlzLm5vZGUueSArIDIwO1xyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5fY2JTZWxlY3Qpe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NiU2VsZWN0KHRoaXMuZ2V0Q2FyZCgpLmlkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pc1NlbGVjdGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGUueSA9IHRoaXMubm9kZS55IC0gMjA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgc2V0U2NhbGVDYXJkKHNjYWxlQ2FyZCl7XHJcbiAgICAgICAgdGhpcy5ub2RlLndpZHRoICAqPSBzY2FsZUNhcmQ7XHJcbiAgICAgICAgdGhpcy5ub2RlLmhlaWdodCAqPSBzY2FsZUNhcmQ7XHJcbiAgICB9XHJcbn0pO1xyXG4iXX0=