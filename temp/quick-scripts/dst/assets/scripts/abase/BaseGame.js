
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/abase/BaseGame.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'ca0723sVk5KNYGPH7Sc5VSZ', 'BaseGame');
// scripts/abase/BaseGame.js

"use strict";

cc.BaseGame = cc.Class({
  "extends": cc.VozBaseComponent,
  properties: {
    poses: {
      "default": [],
      type: cc.Node
    },
    nodePlayers: cc.Node,
    WaitingTimer: cc.Node,
    BaseController: cc.Node,
    prefabPlayer: cc.Prefab,
    _number_desk: 4,
    _CURRENT_POS: cc.Node,
    controller: null,
    _room: null,
    lb_bet_title: cc.Label,
    lb_id_table: cc.Label
  },
  requestLeaveRoom: function requestLeaveRoom() {
    mm.Loading.show();
    this.controller.ZoneInstance.send(new SmartFoxSDK.SmartFox.Requests.System.LeaveRoomRequest(this._room));
  },
  setInfoTable: function setInfoTable(table_name, table_bet) {
    this.lb_id_table.string = table_name;
    this.lb_bet_title.string = table_bet;
  },
  eventBack: function eventBack() {},
  setWaitingTimer: function setWaitingTimer(isOn, totalProcess, currentProcess) {
    if (isOn) {
      this.WaitingTimer.active = true;
      var timer = this.WaitingTimer.getComponent(this.WaitingTimer.name);
      timer.setTotalProgress(totalProcess);
      timer.setCurrentProgress(currentProcess);
      timer.turnOnTimer();
    } else {
      this.WaitingTimer.active = false;
    }
  },
  showDeskEmpty: function showDeskEmpty() {
    if (this._isPlayer(this.controller.ZoneInstance.mySelf.name)) return;

    for (var i = 0; i < this._CURRENT_POS._children.length; i++) {
      var player = this._getJSPlayerById(i);

      if (!player) {
        this._CURRENT_POS._children[i].active = true;
      }
    }
  },
  hideDeskEmpty: function hideDeskEmpty() {
    for (var i = 0; i < this._number_desk; i++) {
      var player = this._getJSPlayerById(i);

      if (!player) {
        this._CURRENT_POS._children[i].active = false;
      }
    }
  },
  _changeToMyView: function _changeToMyView() {
    if (this._isPlayer(this.controller.ZoneInstance.mySelf.name)) {
      var myId = this._getPlayerId(this.controller.ZoneInstance.mySelf.name);

      var myPos = myId;
      var maxUsers = this._number_desk;
      var distanceToZero = maxUsers - myPos;

      for (var i = 0; i < maxUsers; i++) {
        var nodePlayer = this._getNodePlayerById(i);

        if (cc.isValid(nodePlayer)) {
          var newIndex = (i + distanceToZero) % maxUsers;
          nodePlayer.position = this.poses[newIndex];

          var js = this._getJSPlayer(nodePlayer);

          js.newPos = newIndex;
          js.number_desk = this._number_desk;
          js.updatePosHand();
        }
      }
    }
  },
  _updateNodePlayers: function _updateNodePlayers(m_listDesk) {
    // process List Desk for player
    for (var i = 0; i < m_listDesk.length; i++) {
      var desk = m_listDesk[i];

      var nodePlayer = this._getNodePlayerById(desk.DeskId);

      if (nodePlayer == null) {
        nodePlayer = cc.instantiate(this.prefabPlayer);
        this.nodePlayers.addChild(nodePlayer);
      }

      nodePlayer.position = this.poses[desk.DeskId].position;
      nodePlayer.playerId = desk.DeskId;
      desk.displayName = GameVariables.getDisplayName(this._room.getUserByName(desk.UserName));

      this._getJSPlayer(nodePlayer).setDesk(desk);
    }

    this._changeToMyView();
  },
  removePlayer: function removePlayer(userOut) {
    // remove player in active
    // remove desk in listDesk mm.mm_tableInfo
    // remove user in mm.m_tableInfo.m_listUser
    for (var i = 0; i < userOut.length; i++) {
      var player = this._getJSPlayerByName(userOut);

      if (player && player.getDesk().UserName == userOut[i]) {
        this._removeNodePlayerById(player.getDesk().DeskId);

        this.controller.m_tableInfo.m_listDesk.splice(this.controller.m_tableInfo.m_listDesk.indexOf(player.getDesk()), 1);
        this.controller.m_tableInfo.m_listUser.splice(this.controller.m_tableInfo.m_listUser.indexOf(userOut[i]), 1);
      }
    }
  },
  turnOffAllTimerPlayers: function turnOffAllTimerPlayers() {
    if (this.controller.m_tableInfo && this.controller.m_tableInfo.m_listActiveUserName) {
      for (var i = 0; i < this.controller.m_tableInfo.m_listActiveUserName.length; i++) {
        var player = this._getJSPlayerByName(this.controller.m_tableInfo.m_listActiveUserName[i]);

        if (player) {
          player.turnOffTimer();
        }
      }
    }
  },
  _getNodePlayerById: function _getNodePlayerById(idPlayer) {
    for (var i = 0; i < this.nodePlayers._children.length; i++) {
      if (this.nodePlayers._children[i].playerId == idPlayer) {
        return this.nodePlayers._children[i];
      }
    }

    return null;
  },
  _removeNodePlayerById: function _removeNodePlayerById(idPlayer) {
    for (var i = 0; i < this.nodePlayers._children.length; i++) {
      if (this.nodePlayers._children[i].playerId == idPlayer) {
        this.nodePlayers._children[i].active = false;
        this.nodePlayers.removeChild(this.nodePlayers._children[i], true);
        break;
      }
    }
  },
  _getJSPlayer: function _getJSPlayer(nodePlayer) {
    return nodePlayer.getComponent(nodePlayer.name);
  },
  _getJSPlayerById: function _getJSPlayerById(idPlayer) {
    var nodePlayer = this._getNodePlayerById(idPlayer);

    if (cc.isValid(nodePlayer)) return this._getJSPlayer(nodePlayer);
    return null;
  },
  _getJSPlayerByName: function _getJSPlayerByName(username) {
    var deskId = this._getPlayerId(username);

    var player = this._getJSPlayerById(deskId);

    return player;
  },
  _getPlayerId: function _getPlayerId(username) {
    if (this.controller.m_tableInfo && this.controller.m_tableInfo.m_listDesk) {
      for (var i = 0; i < this.controller.m_tableInfo.m_listDesk.length; i++) {
        var desk = this.controller.m_tableInfo.m_listDesk[i];

        if (desk.UserName == username) {
          return desk.DeskId;
        }
      }
    }

    return -1;
  },
  _isPlayer: function _isPlayer(username) {
    if (this.controller.m_tableInfo && this.controller.m_tableInfo.m_listDesk) {
      for (var i = 0; i < this.controller.m_tableInfo.m_listDesk.length; i++) {
        var desk = this.controller.m_tableInfo.m_listDesk[i];

        if (desk.UserName == username) {
          return true;
        }
      }
    }

    return false;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcYWJhc2VcXEJhc2VHYW1lLmpzIl0sIm5hbWVzIjpbImNjIiwiQmFzZUdhbWUiLCJDbGFzcyIsIlZvekJhc2VDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwicG9zZXMiLCJ0eXBlIiwiTm9kZSIsIm5vZGVQbGF5ZXJzIiwiV2FpdGluZ1RpbWVyIiwiQmFzZUNvbnRyb2xsZXIiLCJwcmVmYWJQbGF5ZXIiLCJQcmVmYWIiLCJfbnVtYmVyX2Rlc2siLCJfQ1VSUkVOVF9QT1MiLCJjb250cm9sbGVyIiwiX3Jvb20iLCJsYl9iZXRfdGl0bGUiLCJMYWJlbCIsImxiX2lkX3RhYmxlIiwicmVxdWVzdExlYXZlUm9vbSIsIm1tIiwiTG9hZGluZyIsInNob3ciLCJab25lSW5zdGFuY2UiLCJzZW5kIiwiU21hcnRGb3hTREsiLCJTbWFydEZveCIsIlJlcXVlc3RzIiwiU3lzdGVtIiwiTGVhdmVSb29tUmVxdWVzdCIsInNldEluZm9UYWJsZSIsInRhYmxlX25hbWUiLCJ0YWJsZV9iZXQiLCJzdHJpbmciLCJldmVudEJhY2siLCJzZXRXYWl0aW5nVGltZXIiLCJpc09uIiwidG90YWxQcm9jZXNzIiwiY3VycmVudFByb2Nlc3MiLCJhY3RpdmUiLCJ0aW1lciIsImdldENvbXBvbmVudCIsIm5hbWUiLCJzZXRUb3RhbFByb2dyZXNzIiwic2V0Q3VycmVudFByb2dyZXNzIiwidHVybk9uVGltZXIiLCJzaG93RGVza0VtcHR5IiwiX2lzUGxheWVyIiwibXlTZWxmIiwiaSIsIl9jaGlsZHJlbiIsImxlbmd0aCIsInBsYXllciIsIl9nZXRKU1BsYXllckJ5SWQiLCJoaWRlRGVza0VtcHR5IiwiX2NoYW5nZVRvTXlWaWV3IiwibXlJZCIsIl9nZXRQbGF5ZXJJZCIsIm15UG9zIiwibWF4VXNlcnMiLCJkaXN0YW5jZVRvWmVybyIsIm5vZGVQbGF5ZXIiLCJfZ2V0Tm9kZVBsYXllckJ5SWQiLCJpc1ZhbGlkIiwibmV3SW5kZXgiLCJwb3NpdGlvbiIsImpzIiwiX2dldEpTUGxheWVyIiwibmV3UG9zIiwibnVtYmVyX2Rlc2siLCJ1cGRhdGVQb3NIYW5kIiwiX3VwZGF0ZU5vZGVQbGF5ZXJzIiwibV9saXN0RGVzayIsImRlc2siLCJEZXNrSWQiLCJpbnN0YW50aWF0ZSIsImFkZENoaWxkIiwicGxheWVySWQiLCJkaXNwbGF5TmFtZSIsIkdhbWVWYXJpYWJsZXMiLCJnZXREaXNwbGF5TmFtZSIsImdldFVzZXJCeU5hbWUiLCJVc2VyTmFtZSIsInNldERlc2siLCJyZW1vdmVQbGF5ZXIiLCJ1c2VyT3V0IiwiX2dldEpTUGxheWVyQnlOYW1lIiwiZ2V0RGVzayIsIl9yZW1vdmVOb2RlUGxheWVyQnlJZCIsIm1fdGFibGVJbmZvIiwic3BsaWNlIiwiaW5kZXhPZiIsIm1fbGlzdFVzZXIiLCJ0dXJuT2ZmQWxsVGltZXJQbGF5ZXJzIiwibV9saXN0QWN0aXZlVXNlck5hbWUiLCJ0dXJuT2ZmVGltZXIiLCJpZFBsYXllciIsInJlbW92ZUNoaWxkIiwidXNlcm5hbWUiLCJkZXNrSWQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUFBLEVBQUUsQ0FBQ0MsUUFBSCxHQUFjRCxFQUFFLENBQUNFLEtBQUgsQ0FBUztBQUNuQixhQUFTRixFQUFFLENBQUNHLGdCQURPO0FBR25CQyxFQUFBQSxVQUFVLEVBQUU7QUFDUkMsSUFBQUEsS0FBSyxFQUFFO0FBQ0gsaUJBQVMsRUFETjtBQUVIQyxNQUFBQSxJQUFJLEVBQUVOLEVBQUUsQ0FBQ087QUFGTixLQURDO0FBS1JDLElBQUFBLFdBQVcsRUFBRVIsRUFBRSxDQUFDTyxJQUxSO0FBTVJFLElBQUFBLFlBQVksRUFBRVQsRUFBRSxDQUFDTyxJQU5UO0FBT1JHLElBQUFBLGNBQWMsRUFBRVYsRUFBRSxDQUFDTyxJQVBYO0FBUVJJLElBQUFBLFlBQVksRUFBRVgsRUFBRSxDQUFDWSxNQVJUO0FBU1JDLElBQUFBLFlBQVksRUFBRSxDQVROO0FBVVJDLElBQUFBLFlBQVksRUFBRWQsRUFBRSxDQUFDTyxJQVZUO0FBV1JRLElB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RUFBbEUsRUFBcUU7QUFDakUsWUFBSXdCLElBQUksR0FBRyxLQUFLM0QsVUFBTCxDQUFnQjJFLFdBQWhCLENBQTRCakIsVUFBNUIsQ0FBdUN2QixDQUF2QyxDQUFYOztBQUNBLFlBQUd3QixJQUFJLENBQUNTLFFBQUwsSUFBaUJnQixRQUFwQixFQUE2QjtBQUN6QixpQkFBTyxJQUFQO0FBQ0g7QUFDSjtBQUNKOztBQUNELFdBQU8sS0FBUDtBQUNIO0FBMUtrQixDQUFULENBQWQiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbImNjLkJhc2VHYW1lID0gY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuVm96QmFzZUNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgcG9zZXM6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogW10sXHJcbiAgICAgICAgICAgIHR5cGU6IGNjLk5vZGVcclxuICAgICAgICB9LFxyXG4gICAgICAgIG5vZGVQbGF5ZXJzOiBjYy5Ob2RlLFxyXG4gICAgICAgIFdhaXRpbmdUaW1lcjogY2MuTm9kZSxcclxuICAgICAgICBCYXNlQ29udHJvbGxlcjogY2MuTm9kZSxcclxuICAgICAgICBwcmVmYWJQbGF5ZXI6IGNjLlByZWZhYixcclxuICAgICAgICBfbnVtYmVyX2Rlc2s6IDQsXHJcbiAgICAgICAgX0NVUlJFTlRfUE9TOiBjYy5Ob2RlLFxyXG4gICAgICAgIGNvbnRyb2xsZXI6IG51bGwsXHJcbiAgICAgICAgX3Jvb206IG51bGwsXHJcbiAgICAgICAgbGJfYmV0X3RpdGxlOiBjYy5MYWJlbCxcclxuICAgICAgICBsYl9pZF90YWJsZTogY2MuTGFiZWxcclxuICAgIH0sXHJcbiAgICByZXF1ZXN0TGVhdmVSb29tKCl7XHJcbiAgICAgICAgbW0uTG9hZGluZy5zaG93KCk7XHJcbiAgICAgICAgdGhpcy5jb250cm9sbGVyLlpvbmVJbnN0YW5jZS5zZW5kKG5ldyBTbWFydEZveFNESy5TbWFydEZveC5SZXF1ZXN0cy5TeXN0ZW0uTGVhdmVSb29tUmVxdWVzdCh0aGlzLl9yb29tKSk7XHJcbiAgICB9LFxyXG4gICAgc2V0SW5mb1RhYmxlKHRhYmxlX25hbWUsIHRhYmxlX2JldCl7XHJcbiAgICAgICAgdGhpcy5sYl9pZF90YWJsZS5zdHJpbmcgPSB0YWJsZV9uYW1lO1xyXG4gICAgICAgIHRoaXMubGJfYmV0X3RpdGxlLnN0cmluZyA9IHRhYmxlX2JldDtcclxuICAgIH0sXHJcbiAgICBldmVudEJhY2soKXtcclxuXHJcbiAgICB9LFxyXG4gICAgc2V0V2FpdGluZ1RpbWVyKGlzT24sIHRvdGFsUHJvY2VzcywgY3VycmVudFByb2Nlc3Mpe1xyXG4gICAgICAgIGlmKGlzT24pe1xyXG4gICAgICAgICAgICB0aGlzLldhaXRpbmdUaW1lci5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICBsZXQgdGltZXIgPSB0aGlzLldhaXRpbmdUaW1lci5nZXRDb21wb25lbnQodGhpcy5XYWl0aW5nVGltZXIubmFtZSk7XHJcbiAgICAgICAgICAgIHRpbWVyLnNldFRvdGFsUHJvZ3Jlc3ModG90YWxQcm9jZXNzKTtcclxuICAgICAgICAgICAgdGltZXIuc2V0Q3VycmVudFByb2dyZXNzKGN1cnJlbnRQcm9jZXNzKTtcclxuICAgICAgICAgICAgdGltZXIudHVybk9uVGltZXIoKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdGhpcy5XYWl0aW5nVGltZXIuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNob3dEZXNrRW1wdHkoKXtcclxuICAgICAgICBpZih0aGlzLl9pc1BsYXllcih0aGlzLmNvbnRyb2xsZXIuWm9uZUluc3RhbmNlLm15U2VsZi5uYW1lKSlcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLl9DVVJSRU5UX1BPUy5fY2hpbGRyZW4ubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICBsZXQgcGxheWVyID0gdGhpcy5fZ2V0SlNQbGF5ZXJCeUlkKGkpO1xyXG4gICAgICAgICAgICBpZighcGxheWVyKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuX0NVUlJFTlRfUE9TLl9jaGlsZHJlbltpXS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGhpZGVEZXNrRW1wdHkoKXtcclxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5fbnVtYmVyX2Rlc2s7IGkrKyl7XHJcbiAgICAgICAgICAgIGxldCBwbGF5ZXIgPSB0aGlzLl9nZXRKU1BsYXllckJ5SWQoaSk7XHJcbiAgICAgICAgICAgIGlmKCFwbGF5ZXIpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fQ1VSUkVOVF9QT1MuX2NoaWxkcmVuW2ldLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIF9jaGFuZ2VUb015Vmlldygpe1xyXG4gICAgICAgIGlmKHRoaXMuX2lzUGxheWVyKHRoaXMuY29udHJvbGxlci5ab25lSW5zdGFuY2UubXlTZWxmLm5hbWUpKXtcclxuICAgICAgICAgICAgbGV0IG15SWQgPSB0aGlzLl9nZXRQbGF5ZXJJZCh0aGlzLmNvbnRyb2xsZXIuWm9uZUluc3RhbmNlLm15U2VsZi5uYW1lKTtcclxuICAgICAgICAgICAgbGV0IG15UG9zID0gbXlJZDtcclxuICAgICAgICAgICAgbGV0IG1heFVzZXJzID0gdGhpcy5fbnVtYmVyX2Rlc2s7XHJcbiAgICAgICAgICAgIGxldCBkaXN0YW5jZVRvWmVybyA9IG1heFVzZXJzIC0gbXlQb3M7XHJcbiAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBtYXhVc2VyczsgaSsrKXtcclxuICAgICAgICAgICAgICAgIGxldCBub2RlUGxheWVyID0gdGhpcy5fZ2V0Tm9kZVBsYXllckJ5SWQoaSk7XHJcbiAgICAgICAgICAgICAgICBpZihjYy5pc1ZhbGlkKG5vZGVQbGF5ZXIpKXtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgbmV3SW5kZXggPSAoaSArIGRpc3RhbmNlVG9aZXJvKSAlIG1heFVzZXJzO1xyXG4gICAgICAgICAgICAgICAgICAgIG5vZGVQbGF5ZXIucG9zaXRpb24gPSB0aGlzLnBvc2VzW25ld0luZGV4XTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQganMgPSB0aGlzLl9nZXRKU1BsYXllcihub2RlUGxheWVyKTtcclxuICAgICAgICAgICAgICAgICAgICBqcy5uZXdQb3MgPSBuZXdJbmRleDtcclxuICAgICAgICAgICAgICAgICAgICBqcy5udW1iZXJfZGVzayA9IHRoaXMuX251bWJlcl9kZXNrO1xyXG4gICAgICAgICAgICAgICAgICAgIGpzLnVwZGF0ZVBvc0hhbmQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBfdXBkYXRlTm9kZVBsYXllcnMobV9saXN0RGVzayl7XHJcbiAgICAgICAgLy8gcHJvY2VzcyBMaXN0IERlc2sgZm9yIHBsYXllclxyXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBtX2xpc3REZXNrLmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICBsZXQgZGVzayA9IG1fbGlzdERlc2tbaV07XHJcbiAgICAgICAgICAgIGxldCBub2RlUGxheWVyID0gdGhpcy5fZ2V0Tm9kZVBsYXllckJ5SWQoZGVzay5EZXNrSWQpO1xyXG4gICAgICAgICAgICBpZihub2RlUGxheWVyID09IG51bGwpe1xyXG4gICAgICAgICAgICAgICAgbm9kZVBsYXllciA9IGNjLmluc3RhbnRpYXRlKHRoaXMucHJlZmFiUGxheWVyKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZVBsYXllcnMuYWRkQ2hpbGQobm9kZVBsYXllcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbm9kZVBsYXllci5wb3NpdGlvbiA9IHRoaXMucG9zZXNbZGVzay5EZXNrSWRdLnBvc2l0aW9uO1xyXG4gICAgICAgICAgICBub2RlUGxheWVyLnBsYXllcklkID0gZGVzay5EZXNrSWQ7XHJcbiAgICAgICAgICAgIGRlc2suZGlzcGxheU5hbWUgPSBHYW1lVmFyaWFibGVzLmdldERpc3BsYXlOYW1lKHRoaXMuX3Jvb20uZ2V0VXNlckJ5TmFtZShkZXNrLlVzZXJOYW1lKSk7XHJcbiAgICAgICAgICAgIHRoaXMuX2dldEpTUGxheWVyKG5vZGVQbGF5ZXIpLnNldERlc2soZGVzayk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2NoYW5nZVRvTXlWaWV3KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHJlbW92ZVBsYXllcih1c2VyT3V0KXtcclxuICAgICAgICAvLyByZW1vdmUgcGxheWVyIGluIGFjdGl2ZVxyXG4gICAgICAgIC8vIHJlbW92ZSBkZXNrIGluIGxpc3REZXNrIG1tLm1tX3RhYmxlSW5mb1xyXG4gICAgICAgIC8vIHJlbW92ZSB1c2VyIGluIG1tLm1fdGFibGVJbmZvLm1fbGlzdFVzZXJcclxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdXNlck91dC5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgICAgIGxldCBwbGF5ZXIgPSB0aGlzLl9nZXRKU1BsYXllckJ5TmFtZSh1c2VyT3V0KTtcclxuICAgICAgICAgICAgaWYocGxheWVyICYmIHBsYXllci5nZXREZXNrKCkuVXNlck5hbWUgPT0gdXNlck91dFtpXSl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVOb2RlUGxheWVyQnlJZChwbGF5ZXIuZ2V0RGVzaygpLkRlc2tJZCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRyb2xsZXIubV90YWJsZUluZm8ubV9saXN0RGVzay5zcGxpY2UodGhpcy5jb250cm9sbGVyLm1fdGFibGVJbmZvLm1fbGlzdERlc2suaW5kZXhPZihwbGF5ZXIuZ2V0RGVzaygpKSwgMSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRyb2xsZXIubV90YWJsZUluZm8ubV9saXN0VXNlci5zcGxpY2UodGhpcy5jb250cm9sbGVyLm1fdGFibGVJbmZvLm1fbGlzdFVzZXIuaW5kZXhPZih1c2VyT3V0W2ldKSwgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgdHVybk9mZkFsbFRpbWVyUGxheWVycygpe1xyXG4gICAgICAgIGlmKHRoaXMuY29udHJvbGxlci5tX3RhYmxlSW5mbyAmJiB0aGlzLmNvbnRyb2xsZXIubV90YWJsZUluZm8ubV9saXN0QWN0aXZlVXNlck5hbWUpe1xyXG4gICAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5jb250cm9sbGVyLm1fdGFibGVJbmZvLm1fbGlzdEFjdGl2ZVVzZXJOYW1lLmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICAgICAgbGV0IHBsYXllciA9IHRoaXMuX2dldEpTUGxheWVyQnlOYW1lKHRoaXMuY29udHJvbGxlci5tX3RhYmxlSW5mby5tX2xpc3RBY3RpdmVVc2VyTmFtZVtpXSk7XHJcbiAgICAgICAgICAgICAgICBpZihwbGF5ZXIpe1xyXG4gICAgICAgICAgICAgICAgICAgIHBsYXllci50dXJuT2ZmVGltZXIoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBfZ2V0Tm9kZVBsYXllckJ5SWQoaWRQbGF5ZXIpe1xyXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLm5vZGVQbGF5ZXJzLl9jaGlsZHJlbi5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgaWYodGhpcy5ub2RlUGxheWVycy5fY2hpbGRyZW5baV0ucGxheWVySWQgPT0gaWRQbGF5ZXIpe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubm9kZVBsYXllcnMuX2NoaWxkcmVuW2ldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfSxcclxuICAgIF9yZW1vdmVOb2RlUGxheWVyQnlJZChpZFBsYXllcil7XHJcbiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHRoaXMubm9kZVBsYXllcnMuX2NoaWxkcmVuLmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICBpZih0aGlzLm5vZGVQbGF5ZXJzLl9jaGlsZHJlbltpXS5wbGF5ZXJJZCA9PSBpZFBsYXllcil7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGVQbGF5ZXJzLl9jaGlsZHJlbltpXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZVBsYXllcnMucmVtb3ZlQ2hpbGQodGhpcy5ub2RlUGxheWVycy5fY2hpbGRyZW5baV0sIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgX2dldEpTUGxheWVyKG5vZGVQbGF5ZXIpe1xyXG4gICAgICAgIHJldHVybiBub2RlUGxheWVyLmdldENvbXBvbmVudChub2RlUGxheWVyLm5hbWUpO1xyXG4gICAgfSxcclxuICAgIF9nZXRKU1BsYXllckJ5SWQoaWRQbGF5ZXIpe1xyXG4gICAgICAgIGxldCBub2RlUGxheWVyID0gdGhpcy5fZ2V0Tm9kZVBsYXllckJ5SWQoaWRQbGF5ZXIpO1xyXG4gICAgICAgIGlmKGNjLmlzVmFsaWQobm9kZVBsYXllcikpXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXRKU1BsYXllcihub2RlUGxheWVyKTtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH0sXHJcbiAgICBfZ2V0SlNQbGF5ZXJCeU5hbWUodXNlcm5hbWUpe1xyXG4gICAgICAgIGxldCBkZXNrSWQgPSB0aGlzLl9nZXRQbGF5ZXJJZCh1c2VybmFtZSk7XHJcbiAgICAgICAgbGV0IHBsYXllciA9IHRoaXMuX2dldEpTUGxheWVyQnlJZChkZXNrSWQpO1xyXG4gICAgICAgIHJldHVybiBwbGF5ZXI7XHJcbiAgICB9LFxyXG4gICAgX2dldFBsYXllcklkKHVzZXJuYW1lKXtcclxuICAgICAgICBpZih0aGlzLmNvbnRyb2xsZXIubV90YWJsZUluZm8gJiYgdGhpcy5jb250cm9sbGVyLm1fdGFibGVJbmZvLm1fbGlzdERlc2spe1xyXG4gICAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5jb250cm9sbGVyLm1fdGFibGVJbmZvLm1fbGlzdERlc2subGVuZ3RoO2krKyl7XHJcbiAgICAgICAgICAgICAgICBsZXQgZGVzayA9IHRoaXMuY29udHJvbGxlci5tX3RhYmxlSW5mby5tX2xpc3REZXNrW2ldO1xyXG4gICAgICAgICAgICAgICAgaWYoZGVzay5Vc2VyTmFtZSA9PSB1c2VybmFtZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlc2suRGVza0lkO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAtMTtcclxuICAgIH0sXHJcbiAgICBfaXNQbGF5ZXIodXNlcm5hbWUpe1xyXG4gICAgICAgIGlmKHRoaXMuY29udHJvbGxlci5tX3RhYmxlSW5mbyAmJiB0aGlzLmNvbnRyb2xsZXIubV90YWJsZUluZm8ubV9saXN0RGVzayl7XHJcbiAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLmNvbnRyb2xsZXIubV90YWJsZUluZm8ubV9saXN0RGVzay5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgICAgIGxldCBkZXNrID0gdGhpcy5jb250cm9sbGVyLm1fdGFibGVJbmZvLm1fbGlzdERlc2tbaV07XHJcbiAgICAgICAgICAgICAgICBpZihkZXNrLlVzZXJOYW1lID09IHVzZXJuYW1lKXtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn0pO1xyXG4iXX0=