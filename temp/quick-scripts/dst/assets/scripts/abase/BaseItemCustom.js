
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/abase/BaseItemCustom.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'fa9ebx6Fq9Lza7nAIGoXXOU', 'BaseItemCustom');
// scripts/abase/BaseItemCustom.js

"use strict";

/******************************************
 * @author kL <klk0@qq.com>
 * @date 2019/5/15
 * @doc List Item component..
 * 说明：
 *      1. This component must be used in conjunction with the List component. (Supporting ..)
 * @end
 ******************************************/
var SelectedType = cc.Enum({
  NONE: 0,
  TOGGLE: 1,
  // Single (Single node show / hide)
  SWITCH: 2 // Switch (single Sprite switch SpriteFrame)

});
cc.BaseItemCustom = cc.Class({
  editor: {
    disallowMultiple: false,
    menu: 'Custom component / List Item',
    executionOrder: -5001 // Before List

  },
  "extends": cc.VozBaseComponent,
  properties: {
    selectedMode: {
      "default": SelectedType.NONE,
      type: SelectedType,
      tooltip: CC_DEV && 'Select mode' // get: function () {
      //     return this._slideType;
      // },
      // set: function (val) {
      //     if (val != null)
      //         this._slideType = val;
      // }

    },
    selectedFlag: {
      "default": null,
      type: cc.Node,
      visible: function visible() {
        var bool = this.selectedMode > 0;
        if (!bool) this.selectedFlag = null;
        return bool;
      }
    },
    selectedSpriteFrame: {
      "default": null,
      type: cc.SpriteFrame,
      visible: function visible() {
        var bool = this.selectedMode == SelectedType.SWITCH;
        if (!bool) this.selectedSpriteFrame = null;
        return bool;
      }
    },
    adaptiveSize: {
      "default": false,
      tooltip: CC_DEV && 'Adaptive size (width or height)'
    },
    _selected: false,
    selected: {
      visible: false,
      get: function get() {
        return this._selected;
      },
      set: function set(val) {
        this._selected = val;
        if (!this.selectedFlag) return;

        switch (this.selectedMode) {
          case SelectedType.TOGGLE:
            this.selectedFlag.active = val;
            break;

          case SelectedType.SWITCH:
            // this.selectedFlag.node.active = true;
            this.selectedFlag.spriteFrame = val ? this.selectedSpriteFrame : this._unselectedSpriteFrame;
            break;
        }
      }
    },
    _btnCom: null,
    btnCom: {
      visible: false,
      get: function get() {
        if (!this._btnCom) this._btnCom = this.node.getComponent(cc.Button);
        return this._btnCom;
      }
    }
  },
  onDestroy: function onDestroy() {
    this.node.off(cc.Node.EventType.SIZE_CHANGED, this._onSizeChange, this);
  },
  _registerEvent: function _registerEvent() {
    if (!this.eventReg) {
      if (this.btnCom && this._list.selectedMode > 0) {
        this.btnCom.clickEvents.unshift(this.createEvt(this, 'onClickThis'));
      }

      if (this.adaptiveSize) {
        this.node.on(cc.Node.EventType.SIZE_CHANGED, this._onSizeChange, this);
      }

      this.eventReg = true;
    }
  },
  _onSizeChange: function _onSizeChange() {
    this._list._onItemAdaptive(this.node);
  },

  /**
   * Create event
   * @param {cc.Component} component Component script
   * @param {string} handlerName Trigger function name
   * @param {cc.Node} node Where the components are node（Take it without transmitting component.node）
   * @returns cc.Component.EventHandler
   */
  createEvt: function createEvt(component, handlerName, node) {
    if (!component.isValid) return; //Some are loaded asynchronously, and nodes are destroyed as well.

    component.comName = component.comName || component.name.match(/\<(.*?)\>/g).pop().replace(/\<|>/g, '');
    var evt = new cc.Component.EventHandler();
    evt.target = node || component.node;
    evt.component = component.comName;
    evt.handler = handlerName;
    return evt;
  },
  showAni: function showAni(aniType, callFunc, del) {
    var _this = this;

    var acts;

    switch (aniType) {
      case 0:
        //Disappearance
        acts = [new cc.scaleTo(.2, .7), new cc.moveBy(.3, 0, this.node.height * 2)];
        break;

      case 1:
        //Disappear right
        acts = [new cc.scaleTo(.2, .7), new cc.moveBy(.3, this.node.width * 2, 0)];
        break;

      case 2:
        //Disappear down
        acts = [new cc.scaleTo(.2, .7), new cc.moveBy(.3, 0, this.node.height * -2)];
        break;

      case 3:
        //Disappear left
        acts = [new cc.scaleTo(.2, .7), new cc.moveBy(.3, this.node.width * -2, 0)];
        break;

      default:
        // Default: zoom out
        acts = [new cc.scaleTo(.3, .1)];
        break;
    }

    if (callFunc || del) {
      acts.push(new cc.CallFunc(function () {
        if (del) {
          _this._list._delSingleItem(_this.node);

          for (var n = _this._list.displayData.length - 1; n >= 0; n--) {
            if (_this._list.displayData[n].listId == _this.node._listId) {
              _this._list.displayData.splice(n, 1);

              break;
            }
          }
        }

        callFunc();
      }));
    }

    this.node.runAction(new cc.Sequence(acts));
  },
  onClickThis: function onClickThis() {
    // if (this._list.selectedMode == 1)
    this._list.selectedId = this.node._listId;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcYWJhc2VcXEJhc2VJdGVtQ3VzdG9tLmpzIl0sIm5hbWVzIjpbIlNlbGVjdGVkVHlwZSIsImNjIiwiRW51bSIsIk5PTkUiLCJUT0dHTEUiLCJTV0lUQ0giLCJCYXNlSXRlbUN1c3RvbSIsIkNsYXNzIiwiZWRpdG9yIiwiZGlzYWxsb3dNdWx0aXBsZSIsIm1lbnUiLCJleGVjdXRpb25PcmRlciIsIlZvekJhc2VDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwic2VsZWN0ZWRNb2RlIiwidHlwZSIsInRvb2x0aXAiLCJDQ19ERVYiLCJzZWxlY3RlZEZsYWciLCJOb2RlIiwidmlzaWJsZSIsImJvb2wiLCJzZWxlY3RlZFNwcml0ZUZyYW1lIiwiU3ByaXRlRnJhbWUiLCJhZGFwdGl2ZVNpemUiLCJfc2VsZWN0ZWQiLCJzZWxlY3RlZCIsImdldCIsInNldCIsInZhbCIsImFjdGl2ZSIsInNwcml0ZUZyYW1lIiwiX3Vuc2VsZWN0ZWRTcHJpdGVGcmFtZSIsIl9idG5Db20iLCJidG5Db20iLCJub2RlIiwiZ2V0Q29tcG9uZW50IiwiQnV0dG9uIiwib25EZXN0cm95Iiwib2ZmIiwiRXZlbnRUeXBlIiwiU0laRV9DSEFOR0VEIiwiX29uU2l6ZUNoYW5nZSIsIl9yZWdpc3RlckV2ZW50IiwiZXZlbnRSZWciLCJfbGlzdCIsImNsaWNrRXZlbnRzIiwidW5zaGlmdCIsImNyZWF0ZUV2dCIsIm9uIiwiX29uSXRlbUFkYXB0aXZlIiwiY29tcG9uZW50IiwiaGFuZGxlck5hbWUiLCJpc1ZhbGlkIiwiY29tTmFtZSIsIm5hbWUiLCJtYXRjaCIsInBvcCIsInJlcGxhY2UiLCJldnQiLCJDb21wb25lbnQiLCJFdmVudEhhbmRsZXIiLCJ0YXJnZXQiLCJoYW5kbGVyIiwic2hvd0FuaSIsImFuaVR5cGUiLCJjYWxsRnVuYyIsImRlbCIsImFjdHMiLCJzY2FsZVRvIiwibW92ZUJ5IiwiaGVpZ2h0Iiwid2lkdGgiLCJwdXNoIiwiQ2FsbEZ1bmMiLCJfZGVsU2luZ2xlSXRlbSIsIm4iLCJkaXNwbGF5RGF0YSIsImxlbmd0aCIsImxpc3RJZCIsIl9saXN0SWQiLCJzcGxpY2UiLCJydW5BY3Rpb24iLCJTZXF1ZW5jZSIsIm9uQ2xpY2tUaGlzIiwic2VsZWN0ZWRJZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7Ozs7Ozs7QUFRQSxJQUFNQSxZQUFZLEdBQUdDLEVBQUUsQ0FBQ0MsSUFBSCxDQUFRO0FBQ3pCQyxFQUFBQSxJQUFJLEVBQUUsQ0FEbUI7QUFFekJDLEVBQUFBLE1BQU0sRUFBRSxDQUZpQjtBQUVkO0FBQ1hDLEVBQUFBLE1BQU0sRUFBRSxDQUhpQixDQUdkOztBQUhjLENBQVIsQ0FBckI7QUFNQUosRUFBRSxDQUFDSyxjQUFILEdBQXFCTCxFQUFFLENBQUNNLEtBQUgsQ0FBUztBQUMxQkMsRUFBQUEsTUFBTSxFQUFFO0FBQ0pDLElBQUFBLGdCQUFnQixFQUFFLEtBRGQ7QUFFSkMsSUFBQUEsSUFBSSxFQUFFLDhCQUZGO0FBR0pDLElBQUFBLGNBQWMsRUFBRSxDQUFDLElBSGIsQ0FHMkI7O0FBSDNCLEdBRGtCO0FBTTFCLGFBQVNWLEVBQUUsQ0FBQ1csZ0JBTmM7QUFRMUJDLEVBQUFBLFVBQVUsRUFBRTtBQUNSQyxJQUFBQSxZQUFZLEVBQUU7QUFDVixpQkFBU2QsWUFBWSxDQUFDRyxJQURaO0FBRVZZLE1BQUFBLElBQUksRUFBRWYsWUFGSTtBQUdWZ0IsTUFBQUEsT0FBTyxFQUFFQyxNQUFNLElBQUksYUFIVCxDQUlWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQVZVLEtBRE47QUFhUkMsSUFBQUEsWUFBWSxFQUFFO0FBQ1YsaUJBQVMsSUFEQztBQUVWSCxNQUFBQSxJQUFJLEVBQUVkLEVBQUUsQ0FBQ2tCLElBRkM7QUFHVkMsTUFBQUEsT0FBTyxFQUFFLG1CQUFZO0FBQ2pCLFlBQUlDLElBQUksR0FBRyxLQUFLUCxZQUFMLEdBQW9CLENBQS9CO0FBQ0EsWUFBSSxDQUFDTyxJQUFMLEVBQ0ksS0FBS0gsWUFBTCxHQUFvQixJQUFwQjtBQUNKLGVBQU9HLElBQVA7QUFDSDtBQVJTLEtBYk47QUF1QlJDLElBQUFBLG1CQUFtQixFQUFFO0FBQ2pCLGlCQUFTLElBRFE7QUFFakJQLE1BQUFBLElBQUksRUFBRWQsRUFBRSxDQUFDc0IsV0FGUTtBQUdqQkgsTUFBQUEsT0FBTyxFQUFFLG1CQUFZO0FBQ2pCLFlBQUlDLElBQUksR0FBRyxLQUFLUCxZQUFMLElBQXFCZCxZQUFZLENBQUNLLE1BQTdDO0FBQ0EsWUFBSSxDQUFDZ0IsSUFBTCxFQUNJLEtBQUtDLG1CQUFMLEdBQTJCLElBQTNCO0FBQ0osZUFBT0QsSUFBUDtBQUNIO0FBUmdCLEtBdkJiO0FBaUNSRyxJQUFBQSxZQUFZLEVBQUU7QUFDVixpQkFBUyxLQURDO0FBRVZSLE1BQUFBLE9BQU8sRUFBRUMsTUFBTSxJQUFJO0FBRlQsS0FqQ047QUFxQ1JRLElBQUFBLFNBQVMsRUFBRSxLQXJDSDtBQXNDUkMsSUFBQUEsUUFBUSxFQUFFO0FBQ05OLE1BQUFBLE9BQU8sRUFBRSxLQURIO0FBRU5PLE1BQUFBLEdBRk0saUJBRUE7QUFDRixlQUFPLEtBQUtGLFNBQVo7QUFDSCxPQUpLO0FBS05HLE1BQUFBLEdBTE0sZUFLRkMsR0FMRSxFQUtHO0FBQ0wsYUFBS0osU0FBTCxHQUFpQkksR0FBakI7QUFDQSxZQUFJLENBQUMsS0FBS1gsWUFBVixFQUNJOztBQUNKLGdCQUFRLEtBQUtKLFlBQWI7QUFDSSxlQUFLZCxZQUFZLENBQUNJLE1BQWxCO0FBQ0ksaUJBQUtjLFlBQUwsQ0FBa0JZLE1BQWxCLEdBQTJCRCxHQUEzQjtBQUNBOztBQUNKLGVBQUs3QixZQUFZLENBQUNLLE1BQWxCO0FBQ0k7QUFDQSxpQkFBS2EsWUFBTCxDQUFrQmEsV0FBbEIsR0FBZ0NGLEdBQUcsR0FBRyxLQUFLUCxtQkFBUixHQUE4QixLQUFLVSxzQkFBdEU7QUFDQTtBQVBSO0FBU0g7QUFsQkssS0F0Q0Y7QUEwRFJDLElBQUFBLE9BQU8sRUFBRSxJQTFERDtBQTJEUkMsSUFBQUEsTUFBTSxFQUFFO0FBQ0pkLE1BQUFBLE9BQU8sRUFBRSxLQURMO0FBRUpPLE1BQUFBLEdBQUcsRUFBRSxlQUFZO0FBQ2IsWUFBSSxDQUFDLEtBQUtNLE9BQVYsRUFDSSxLQUFLQSxPQUFMLEdBQWUsS0FBS0UsSUFBTCxDQUFVQyxZQUFWLENBQXVCbkMsRUFBRSxDQUFDb0MsTUFBMUIsQ0FBZjtBQUNKLGVBQU8sS0FBS0osT0FBWjtBQUNIO0FBTkc7QUEzREEsR0FSYztBQTZFMUJLLEVBQUFBLFNBN0UwQix1QkE2RWQ7QUFDUixTQUFLSCxJQUFMLENBQVVJLEdBQVYsQ0FBY3RDLEVBQUUsQ0FBQ2tCLElBQUgsQ0FBUXFCLFNBQVIsQ0FBa0JDLFlBQWhDLEVBQThDLEtBQUtDLGFBQW5ELEVBQWtFLElBQWxFO0FBQ0gsR0EvRXlCO0FBaUYxQkMsRUFBQUEsY0FqRjBCLDRCQWlGVDtBQUNiLFFBQUksQ0FBQyxLQUFLQyxRQUFWLEVBQW9CO0FBQ2hCLFVBQUksS0FBS1YsTUFBTCxJQUFlLEtBQUtXLEtBQUwsQ0FBVy9CLFlBQVgsR0FBMEIsQ0FBN0MsRUFBZ0Q7QUFDNUMsYUFBS29CLE1BQUwsQ0FBWVksV0FBWixDQUF3QkMsT0FBeEIsQ0FBZ0MsS0FBS0MsU0FBTCxDQUFlLElBQWYsRUFBcUIsYUFBckIsQ0FBaEM7QUFDSDs7QUFDRCxVQUFJLEtBQUt4QixZQUFULEVBQXVCO0FBQ25CLGFBQUtXLElBQUwsQ0FBVWMsRUFBVixDQUFhaEQsRUFBRSxDQUFDa0IsSUFBSCxDQUFRcUIsU0FBUixDQUFrQkMsWUFBL0IsRUFBNkMsS0FBS0MsYUFBbEQsRUFBaUUsSUFBakU7QUFDSDs7QUFDRCxXQUFLRSxRQUFMLEdBQWdCLElBQWhCO0FBQ0g7QUFDSixHQTNGeUI7QUE2RjFCRixFQUFBQSxhQTdGMEIsMkJBNkZWO0FBQ1osU0FBS0csS0FBTCxDQUFXSyxlQUFYLENBQTJCLEtBQUtmLElBQWhDO0FBQ0gsR0EvRnlCOztBQWdHMUI7Ozs7Ozs7QUFPQWEsRUFBQUEsU0F2RzBCLHFCQXVHaEJHLFNBdkdnQixFQXVHTEMsV0F2R0ssRUF1R1FqQixJQXZHUixFQXVHYztBQUNwQyxRQUFJLENBQUNnQixTQUFTLENBQUNFLE9BQWYsRUFDSSxPQUZnQyxDQUV6Qjs7QUFDWEYsSUFBQUEsU0FBUyxDQUFDRyxPQUFWLEdBQW9CSCxTQUFTLENBQUNHLE9BQVYsSUFBcUJILFNBQVMsQ0FBQ0ksSUFBVixDQUFlQyxLQUFmLENBQXFCLFlBQXJCLEVBQW1DQyxHQUFuQyxHQUF5Q0MsT0FBekMsQ0FBaUQsT0FBakQsRUFBMEQsRUFBMUQsQ0FBekM7QUFDQSxRQUFJQyxHQUFHLEdBQUcsSUFBSTFELEVBQUUsQ0FBQzJELFNBQUgsQ0FBYUMsWUFBakIsRUFBVjtBQUNBRixJQUFBQSxHQUFHLENBQUNHLE1BQUosR0FBYTNCLElBQUksSUFBSWdCLFNBQVMsQ0FBQ2hCLElBQS9CO0FBQ0F3QixJQUFBQSxHQUFHLENBQUNSLFNBQUosR0FBZ0JBLFNBQVMsQ0FBQ0csT0FBMUI7QUFDQUssSUFBQUEsR0FBRyxDQUFDSSxPQUFKLEdBQWNYLFdBQWQ7QUFDQSxXQUFPTyxHQUFQO0FBQ0gsR0FoSHlCO0FBa0gxQkssRUFBQUEsT0FsSDBCLG1CQWtIbEJDLE9BbEhrQixFQWtIVEMsUUFsSFMsRUFrSENDLEdBbEhELEVBa0hNO0FBQUE7O0FBQzVCLFFBQUlDLElBQUo7O0FBQ0EsWUFBUUgsT0FBUjtBQUNJLFdBQUssQ0FBTDtBQUFRO0FBQ0pHLFFBQUFBLElBQUksR0FBRyxDQUNILElBQUluRSxFQUFFLENBQUNvRSxPQUFQLENBQWUsRUFBZixFQUFtQixFQUFuQixDQURHLEVBRUgsSUFBSXBFLEVBQUUsQ0FBQ3FFLE1BQVAsQ0FBYyxFQUFkLEVBQWtCLENBQWxCLEVBQXFCLEtBQUtuQyxJQUFMLENBQVVvQyxNQUFWLEdBQW1CLENBQXhDLENBRkcsQ0FBUDtBQUlBOztBQUNKLFdBQUssQ0FBTDtBQUFRO0FBQ0pILFFBQUFBLElBQUksR0FBRyxDQUNILElBQUluRSxFQUFFLENBQUNvRSxPQUFQLENBQWUsRUFBZixFQUFtQixFQUFuQixDQURHLEVBRUgsSUFBSXBFLEVBQUUsQ0FBQ3FFLE1BQVAsQ0FBYyxFQUFkLEVBQWtCLEtBQUtuQyxJQUFMLENBQVVxQyxLQUFWLEdBQWtCLENBQXBDLEVBQXVDLENBQXZDLENBRkcsQ0FBUDtBQUlBOztBQUNKLFdBQUssQ0FBTDtBQUFRO0FBQ0pKLFFBQUFBLElBQUksR0FBRyxDQUNILElBQUluRSxFQUFFLENBQUNvRSxPQUFQLENBQWUsRUFBZixFQUFtQixFQUFuQixDQURHLEVBRUgsSUFBSXBFLEVBQUUsQ0FBQ3FFLE1BQVAsQ0FBYyxFQUFkLEVBQWtCLENBQWxCLEVBQXFCLEtBQUtuQyxJQUFMLENBQVVvQyxNQUFWLEdBQW1CLENBQUMsQ0FBekMsQ0FGRyxDQUFQO0FBSUE7O0FBQ0osV0FBSyxDQUFMO0FBQVE7QUFDSkgsUUFBQUEsSUFBSSxHQUFHLENBQ0gsSUFBSW5FLEVBQUUsQ0FBQ29FLE9BQVAsQ0FBZSxFQUFmLEVBQW1CLEVBQW5CLENBREcsRUFFSCxJQUFJcEUsRUFBRSxDQUFDcUUsTUFBUCxDQUFjLEVBQWQsRUFBa0IsS0FBS25DLElBQUwsQ0FBVXFDLEtBQVYsR0FBa0IsQ0FBQyxDQUFyQyxFQUF3QyxDQUF4QyxDQUZHLENBQVA7QUFJQTs7QUFDSjtBQUFTO0FBQ0xKLFFBQUFBLElBQUksR0FBRyxDQUNILElBQUluRSxFQUFFLENBQUNvRSxPQUFQLENBQWUsRUFBZixFQUFtQixFQUFuQixDQURHLENBQVA7QUFHQTtBQTdCUjs7QUErQkEsUUFBSUgsUUFBUSxJQUFJQyxHQUFoQixFQUFxQjtBQUNqQkMsTUFBQUEsSUFBSSxDQUFDSyxJQUFMLENBQVUsSUFBSXhFLEVBQUUsQ0FBQ3lFLFFBQVAsQ0FBZ0IsWUFBTTtBQUM1QixZQUFJUCxHQUFKLEVBQVM7QUFDTCxVQUFBLEtBQUksQ0FBQ3RCLEtBQUwsQ0FBVzhCLGNBQVgsQ0FBMEIsS0FBSSxDQUFDeEMsSUFBL0I7O0FBQ0EsZUFBSyxJQUFJeUMsQ0FBQyxHQUFHLEtBQUksQ0FBQy9CLEtBQUwsQ0FBV2dDLFdBQVgsQ0FBdUJDLE1BQXZCLEdBQWdDLENBQTdDLEVBQWdERixDQUFDLElBQUksQ0FBckQsRUFBd0RBLENBQUMsRUFBekQsRUFBNkQ7QUFDekQsZ0JBQUksS0FBSSxDQUFDL0IsS0FBTCxDQUFXZ0MsV0FBWCxDQUF1QkQsQ0FBdkIsRUFBMEJHLE1BQTFCLElBQW9DLEtBQUksQ0FBQzVDLElBQUwsQ0FBVTZDLE9BQWxELEVBQTJEO0FBQ3ZELGNBQUEsS0FBSSxDQUFDbkMsS0FBTCxDQUFXZ0MsV0FBWCxDQUF1QkksTUFBdkIsQ0FBOEJMLENBQTlCLEVBQWlDLENBQWpDOztBQUNBO0FBQ0g7QUFDSjtBQUNKOztBQUNEVixRQUFBQSxRQUFRO0FBQ1gsT0FYUyxDQUFWO0FBWUg7O0FBQ0QsU0FBSy9CLElBQUwsQ0FBVStDLFNBQVYsQ0FBb0IsSUFBSWpGLEVBQUUsQ0FBQ2tGLFFBQVAsQ0FBZ0JmLElBQWhCLENBQXBCO0FBQ0gsR0FsS3lCO0FBb0sxQmdCLEVBQUFBLFdBcEswQix5QkFvS1o7QUFDVjtBQUNBLFNBQUt2QyxLQUFMLENBQVd3QyxVQUFYLEdBQXdCLEtBQUtsRCxJQUFMLENBQVU2QyxPQUFsQztBQUNIO0FBdkt5QixDQUFULENBQXJCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbiAqIEBhdXRob3Iga0wgPGtsazBAcXEuY29tPlxyXG4gKiBAZGF0ZSAyMDE5LzUvMTVcclxuICogQGRvYyBMaXN0IEl0ZW0gY29tcG9uZW50Li5cclxuICog6K+05piO77yaXHJcbiAqICAgICAgMS4gVGhpcyBjb21wb25lbnQgbXVzdCBiZSB1c2VkIGluIGNvbmp1bmN0aW9uIHdpdGggdGhlIExpc3QgY29tcG9uZW50LiAoU3VwcG9ydGluZyAuLilcclxuICogQGVuZFxyXG4gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xyXG5jb25zdCBTZWxlY3RlZFR5cGUgPSBjYy5FbnVtKHtcclxuICAgIE5PTkU6IDAsXHJcbiAgICBUT0dHTEU6IDEsIC8vIFNpbmdsZSAoU2luZ2xlIG5vZGUgc2hvdyAvIGhpZGUpXHJcbiAgICBTV0lUQ0g6IDIsIC8vIFN3aXRjaCAoc2luZ2xlIFNwcml0ZSBzd2l0Y2ggU3ByaXRlRnJhbWUpXHJcbn0pO1xyXG5cclxuY2MuQmFzZUl0ZW1DdXN0b20gID0gY2MuQ2xhc3Moe1xyXG4gICAgZWRpdG9yOiB7XHJcbiAgICAgICAgZGlzYWxsb3dNdWx0aXBsZTogZmFsc2UsXHJcbiAgICAgICAgbWVudTogJ0N1c3RvbSBjb21wb25lbnQgLyBMaXN0IEl0ZW0nLFxyXG4gICAgICAgIGV4ZWN1dGlvbk9yZGVyOiAtNTAwMSwgICAgICAgICAvLyBCZWZvcmUgTGlzdFxyXG4gICAgfSxcclxuICAgIGV4dGVuZHM6IGNjLlZvekJhc2VDb21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIHNlbGVjdGVkTW9kZToge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBTZWxlY3RlZFR5cGUuTk9ORSxcclxuICAgICAgICAgICAgdHlwZTogU2VsZWN0ZWRUeXBlLFxyXG4gICAgICAgICAgICB0b29sdGlwOiBDQ19ERVYgJiYgJ1NlbGVjdCBtb2RlJyxcclxuICAgICAgICAgICAgLy8gZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vICAgICByZXR1cm4gdGhpcy5fc2xpZGVUeXBlO1xyXG4gICAgICAgICAgICAvLyB9LFxyXG4gICAgICAgICAgICAvLyBzZXQ6IGZ1bmN0aW9uICh2YWwpIHtcclxuICAgICAgICAgICAgLy8gICAgIGlmICh2YWwgIT0gbnVsbClcclxuICAgICAgICAgICAgLy8gICAgICAgICB0aGlzLl9zbGlkZVR5cGUgPSB2YWw7XHJcbiAgICAgICAgICAgIC8vIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHNlbGVjdGVkRmxhZzoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5Ob2RlLFxyXG4gICAgICAgICAgICB2aXNpYmxlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgYm9vbCA9IHRoaXMuc2VsZWN0ZWRNb2RlID4gMDtcclxuICAgICAgICAgICAgICAgIGlmICghYm9vbClcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkRmxhZyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYm9vbDtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNlbGVjdGVkU3ByaXRlRnJhbWU6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuU3ByaXRlRnJhbWUsXHJcbiAgICAgICAgICAgIHZpc2libGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGxldCBib29sID0gdGhpcy5zZWxlY3RlZE1vZGUgPT0gU2VsZWN0ZWRUeXBlLlNXSVRDSDtcclxuICAgICAgICAgICAgICAgIGlmICghYm9vbClcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkU3ByaXRlRnJhbWUgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGJvb2w7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfSxcclxuICAgICAgICBhZGFwdGl2ZVNpemU6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UsXHJcbiAgICAgICAgICAgIHRvb2x0aXA6IENDX0RFViAmJiAnQWRhcHRpdmUgc2l6ZSAod2lkdGggb3IgaGVpZ2h0KScsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBfc2VsZWN0ZWQ6IGZhbHNlLFxyXG4gICAgICAgIHNlbGVjdGVkOiB7XHJcbiAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLFxyXG4gICAgICAgICAgICBnZXQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0ZWQ7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNldCh2YWwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NlbGVjdGVkID0gdmFsO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNlbGVjdGVkRmxhZylcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHRoaXMuc2VsZWN0ZWRNb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBTZWxlY3RlZFR5cGUuVE9HR0xFOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkRmxhZy5hY3RpdmUgPSB2YWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgU2VsZWN0ZWRUeXBlLlNXSVRDSDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5zZWxlY3RlZEZsYWcubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkRmxhZy5zcHJpdGVGcmFtZSA9IHZhbCA/IHRoaXMuc2VsZWN0ZWRTcHJpdGVGcmFtZSA6IHRoaXMuX3Vuc2VsZWN0ZWRTcHJpdGVGcmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIF9idG5Db206IG51bGwsXHJcbiAgICAgICAgYnRuQ29tOiB7XHJcbiAgICAgICAgICAgIHZpc2libGU6IGZhbHNlLFxyXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fYnRuQ29tKVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2J0bkNvbSA9IHRoaXMubm9kZS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9idG5Db207XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgfSxcclxuXHJcbiAgICBvbkRlc3Ryb3koKSB7XHJcbiAgICAgICAgdGhpcy5ub2RlLm9mZihjYy5Ob2RlLkV2ZW50VHlwZS5TSVpFX0NIQU5HRUQsIHRoaXMuX29uU2l6ZUNoYW5nZSwgdGhpcyk7XHJcbiAgICB9LFxyXG5cclxuICAgIF9yZWdpc3RlckV2ZW50KCkge1xyXG4gICAgICAgIGlmICghdGhpcy5ldmVudFJlZykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5idG5Db20gJiYgdGhpcy5fbGlzdC5zZWxlY3RlZE1vZGUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJ0bkNvbS5jbGlja0V2ZW50cy51bnNoaWZ0KHRoaXMuY3JlYXRlRXZ0KHRoaXMsICdvbkNsaWNrVGhpcycpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5hZGFwdGl2ZVNpemUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5TSVpFX0NIQU5HRUQsIHRoaXMuX29uU2l6ZUNoYW5nZSwgdGhpcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5ldmVudFJlZyA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBfb25TaXplQ2hhbmdlKCkge1xyXG4gICAgICAgIHRoaXMuX2xpc3QuX29uSXRlbUFkYXB0aXZlKHRoaXMubm9kZSk7XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGUgZXZlbnRcclxuICAgICAqIEBwYXJhbSB7Y2MuQ29tcG9uZW50fSBjb21wb25lbnQgQ29tcG9uZW50IHNjcmlwdFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGhhbmRsZXJOYW1lIFRyaWdnZXIgZnVuY3Rpb24gbmFtZVxyXG4gICAgICogQHBhcmFtIHtjYy5Ob2RlfSBub2RlIFdoZXJlIHRoZSBjb21wb25lbnRzIGFyZSBub2Rl77yIVGFrZSBpdCB3aXRob3V0IHRyYW5zbWl0dGluZyBjb21wb25lbnQubm9kZe+8iVxyXG4gICAgICogQHJldHVybnMgY2MuQ29tcG9uZW50LkV2ZW50SGFuZGxlclxyXG4gICAgICovXHJcbiAgICBjcmVhdGVFdnQoY29tcG9uZW50LCBoYW5kbGVyTmFtZSwgbm9kZSkge1xyXG4gICAgICAgIGlmICghY29tcG9uZW50LmlzVmFsaWQpXHJcbiAgICAgICAgICAgIHJldHVybjsvL1NvbWUgYXJlIGxvYWRlZCBhc3luY2hyb25vdXNseSwgYW5kIG5vZGVzIGFyZSBkZXN0cm95ZWQgYXMgd2VsbC5cclxuICAgICAgICBjb21wb25lbnQuY29tTmFtZSA9IGNvbXBvbmVudC5jb21OYW1lIHx8IGNvbXBvbmVudC5uYW1lLm1hdGNoKC9cXDwoLio/KVxcPi9nKS5wb3AoKS5yZXBsYWNlKC9cXDx8Pi9nLCAnJyk7XHJcbiAgICAgICAgbGV0IGV2dCA9IG5ldyBjYy5Db21wb25lbnQuRXZlbnRIYW5kbGVyKCk7XHJcbiAgICAgICAgZXZ0LnRhcmdldCA9IG5vZGUgfHwgY29tcG9uZW50Lm5vZGU7XHJcbiAgICAgICAgZXZ0LmNvbXBvbmVudCA9IGNvbXBvbmVudC5jb21OYW1lO1xyXG4gICAgICAgIGV2dC5oYW5kbGVyID0gaGFuZGxlck5hbWU7XHJcbiAgICAgICAgcmV0dXJuIGV2dDtcclxuICAgIH0sXHJcblxyXG4gICAgc2hvd0FuaShhbmlUeXBlLCBjYWxsRnVuYywgZGVsKSB7XHJcbiAgICAgICAgbGV0IGFjdHM7XHJcbiAgICAgICAgc3dpdGNoIChhbmlUeXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgMDogLy9EaXNhcHBlYXJhbmNlXHJcbiAgICAgICAgICAgICAgICBhY3RzID0gW1xyXG4gICAgICAgICAgICAgICAgICAgIG5ldyBjYy5zY2FsZVRvKC4yLCAuNyksXHJcbiAgICAgICAgICAgICAgICAgICAgbmV3IGNjLm1vdmVCeSguMywgMCwgdGhpcy5ub2RlLmhlaWdodCAqIDIpLFxyXG4gICAgICAgICAgICAgICAgXTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDE6IC8vRGlzYXBwZWFyIHJpZ2h0XHJcbiAgICAgICAgICAgICAgICBhY3RzID0gW1xyXG4gICAgICAgICAgICAgICAgICAgIG5ldyBjYy5zY2FsZVRvKC4yLCAuNyksXHJcbiAgICAgICAgICAgICAgICAgICAgbmV3IGNjLm1vdmVCeSguMywgdGhpcy5ub2RlLndpZHRoICogMiwgMCksXHJcbiAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMjogLy9EaXNhcHBlYXIgZG93blxyXG4gICAgICAgICAgICAgICAgYWN0cyA9IFtcclxuICAgICAgICAgICAgICAgICAgICBuZXcgY2Muc2NhbGVUbyguMiwgLjcpLFxyXG4gICAgICAgICAgICAgICAgICAgIG5ldyBjYy5tb3ZlQnkoLjMsIDAsIHRoaXMubm9kZS5oZWlnaHQgKiAtMiksXHJcbiAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMzogLy9EaXNhcHBlYXIgbGVmdFxyXG4gICAgICAgICAgICAgICAgYWN0cyA9IFtcclxuICAgICAgICAgICAgICAgICAgICBuZXcgY2Muc2NhbGVUbyguMiwgLjcpLFxyXG4gICAgICAgICAgICAgICAgICAgIG5ldyBjYy5tb3ZlQnkoLjMsIHRoaXMubm9kZS53aWR0aCAqIC0yLCAwKSxcclxuICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDogLy8gRGVmYXVsdDogem9vbSBvdXRcclxuICAgICAgICAgICAgICAgIGFjdHMgPSBbXHJcbiAgICAgICAgICAgICAgICAgICAgbmV3IGNjLnNjYWxlVG8oLjMsIC4xKSxcclxuICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNhbGxGdW5jIHx8IGRlbCkge1xyXG4gICAgICAgICAgICBhY3RzLnB1c2gobmV3IGNjLkNhbGxGdW5jKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChkZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9saXN0Ll9kZWxTaW5nbGVJdGVtKHRoaXMubm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgbiA9IHRoaXMuX2xpc3QuZGlzcGxheURhdGEubGVuZ3RoIC0gMTsgbiA+PSAwOyBuLS0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2xpc3QuZGlzcGxheURhdGFbbl0ubGlzdElkID09IHRoaXMubm9kZS5fbGlzdElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9saXN0LmRpc3BsYXlEYXRhLnNwbGljZShuLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2FsbEZ1bmMoKTtcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm5vZGUucnVuQWN0aW9uKG5ldyBjYy5TZXF1ZW5jZShhY3RzKSk7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uQ2xpY2tUaGlzKCkge1xyXG4gICAgICAgIC8vIGlmICh0aGlzLl9saXN0LnNlbGVjdGVkTW9kZSA9PSAxKVxyXG4gICAgICAgIHRoaXMuX2xpc3Quc2VsZWN0ZWRJZCA9IHRoaXMubm9kZS5fbGlzdElkO1xyXG4gICAgfSxcclxufSk7XHJcbiJdfQ==