
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/abase/BaseItemCustom.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'fa9ebx6Fq9Lza7nAIGoXXOU', 'BaseItemCustom');
// scripts/abase/BaseItemCustom.js

"use strict";

/******************************************
 * @author kL <klk0@qq.com>
 * @date 2019/5/15
 * @doc List Item component..
 * 说明：
 *      1. This component must be used in conjunction with the List component. (Supporting ..)
 * @end
 ******************************************/
var SelectedType = cc.Enum({
  NONE: 0,
  TOGGLE: 1,
  // Single (Single node show / hide)
  SWITCH: 2 // Switch (single Sprite switch SpriteFrame)

});
cc.BaseItemCustom = cc.Class({
  editor: {
    disallowMultiple: false,
    menu: 'Custom component / List Item',
    executionOrder: -5001 // Before List

  },
  "extends": cc.VozBaseComponent,
  properties: {
    selectedMode: {
      "default": SelectedType.NONE,
      type: SelectedType,
      tooltip: CC_DEV && 'Select mode' // get: function () {
      //     return this._slideType;
      // },
      // set: function (val) {
      //     if (val != null)
      //         this._slideType = val;
      // }

    },
    selectedFlag: {
      "default": null,
      type: cc.Node,
      visible: function visible() {
        var bool = this.selectedMode > 0;
        if (!bool) this.selectedFlag = null;
        return bool;
      }
    },
    selectedSpriteFrame: {
      "default": null,
      type: cc.SpriteFrame,
      visible: function visible() {
        var bool = this.selectedMode == SelectedType.SWITCH;
        if (!bool) this.selectedSpriteFrame = null;
        return bool;
      }
    },
    adaptiveSize: {
      "default": false,
      tooltip: CC_DEV && 'Adaptive size (width or height)'
    },
    _selected: false,
    selected: {
      visible: false,
      get: function get() {
        return this._selected;
      },
      set: function set(val) {
        this._selected = val;
        if (!this.selectedFlag) return;

        switch (this.selectedMode) {
          case SelectedType.TOGGLE:
            this.selectedFlag.active = val;
            break;

          case SelectedType.SWITCH:
            // this.selectedFlag.node.active = true;
            this.selectedFlag.spriteFrame = val ? this.selectedSpriteFrame : this._unselectedSpriteFrame;
            break;
        }
      }
    },
    _btnCom: null,
    btnCom: {
      visible: false,
      get: function get() {
        if (!this._btnCom) this._btnCom = this.node.getComponent(cc.Button);
        return this._btnCom;
      }
    }
  },
  onDestroy: function onDestroy() {
    this.node.off(cc.Node.EventType.SIZE_CHANGED, this._onSizeChange, this);
  },
  _registerEvent: function _registerEvent() {
    if (!this.eventReg) {
      if (this.btnCom && this._list.selectedMode > 0) {
        this.btnCom.clickEvents.unshift(this.createEvt(this, 'onClickThis'));
      }

      if (this.adaptiveSize) {
        this.node.on(cc.Node.EventType.SIZE_CHANGED, this._onSizeChange, this);
      }

      this.eventReg = true;
    }
  },
  _onSizeChange: function _onSizeChange() {
    this._list._onItemAdaptive(this.node);
  },

  /**
   * Create event
   * @param {cc.Component} component Component script
   * @param {string} handlerName Trigger function name
   * @param {cc.Node} node Where the components are node（Take it without transmitting component.node）
   * @returns cc.Component.EventHandler
   */
  createEvt: function createEvt(component, handlerName, node) {
    if (!component.isValid) return; //Some are loaded asynchronously, and nodes are destroyed as well.

    component.comName = component.comName || component.name.match(/\<(.*?)\>/g).pop().replace(/\<|>/g, '');
    var evt = new cc.Component.EventHandler();
    evt.target = node || component.node;
    evt.component = component.comName;
    evt.handler = handlerName;
    return evt;
  },
  showAni: function showAni(aniType, callFunc, del) {
    var _this = this;

    var acts;

    switch (aniType) {
      case 0:
        //Disappearance
        acts = [new cc.scaleTo(.2, .7), new cc.moveBy(.3, 0, this.node.height * 2)];
        break;

      case 1:
        //Disappear right
        acts = [new cc.scaleTo(.2, .7), new cc.moveBy(.3, this.node.width * 2, 0)];
        break;

      case 2:
        //Disappear down
        acts = [new cc.scaleTo(.2, .7), new cc.moveBy(.3, 0, this.node.height * -2)];
        break;

      case 3:
        //Disappear left
        acts = [new cc.scaleTo(.2, .7), new cc.moveBy(.3, this.node.width * -2, 0)];
        break;

      default:
        // Default: zoom out
        acts = [new cc.scaleTo(.3, .1)];
        break;
    }

    if (callFunc || del) {
      acts.push(new cc.CallFunc(function () {
        if (del) {
          _this._list._delSingleItem(_this.node);

          for (var n = _this._list.displayData.length - 1; n >= 0; n--) {
            if (_this._list.displayData[n].listId == _this.node._listId) {
              _this._list.displayData.splice(n, 1);

              break;
            }
          }
        }

        callFunc();
      }));
    }

    this.node.runAction(new cc.Sequence(acts));
  },
  onClickThis: function onClickThis() {
    // if (this._list.selectedMode == 1)
    this._list.selectedId = this.node._listId;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9zY3JpcHRzL2FiYXNlL0Jhc2VJdGVtQ3VzdG9tLmpzIl0sIm5hbWVzIjpbIlNlbGVjdGVkVHlwZSIsImNjIiwiRW51bSIsIk5PTkUiLCJUT0dHTEUiLCJTV0lUQ0giLCJCYXNlSXRlbUN1c3RvbSIsIkNsYXNzIiwiZWRpdG9yIiwiZGlzYWxsb3dNdWx0aXBsZSIsIm1lbnUiLCJleGVjdXRpb25PcmRlciIsIlZvekJhc2VDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwic2VsZWN0ZWRNb2RlIiwidHlwZSIsInRvb2x0aXAiLCJDQ19ERVYiLCJzZWxlY3RlZEZsYWciLCJOb2RlIiwidmlzaWJsZSIsImJvb2wiLCJzZWxlY3RlZFNwcml0ZUZyYW1lIiwiU3ByaXRlRnJhbWUiLCJhZGFwdGl2ZVNpemUiLCJfc2VsZWN0ZWQiLCJzZWxlY3RlZCIsImdldCIsInNldCIsInZhbCIsImFjdGl2ZSIsInNwcml0ZUZyYW1lIiwiX3Vuc2VsZWN0ZWRTcHJpdGVGcmFtZSIsIl9idG5Db20iLCJidG5Db20iLCJub2RlIiwiZ2V0Q29tcG9uZW50IiwiQnV0dG9uIiwib25EZXN0cm95Iiwib2ZmIiwiRXZlbnRUeXBlIiwiU0laRV9DSEFOR0VEIiwiX29uU2l6ZUNoYW5nZSIsIl9yZWdpc3RlckV2ZW50IiwiZXZlbnRSZWciLCJfbGlzdCIsImNsaWNrRXZlbnRzIiwidW5zaGlmdCIsImNyZWF0ZUV2dCIsIm9uIiwiX29uSXRlbUFkYXB0aXZlIiwiY29tcG9uZW50IiwiaGFuZGxlck5hbWUiLCJpc1ZhbGlkIiwiY29tTmFtZSIsIm5hbWUiLCJtYXRjaCIsInBvcCIsInJlcGxhY2UiLCJldnQiLCJDb21wb25lbnQiLCJFdmVudEhhbmRsZXIiLCJ0YXJnZXQiLCJoYW5kbGVyIiwic2hvd0FuaSIsImFuaVR5cGUiLCJjYWxsRnVuYyIsImRlbCIsImFjdHMiLCJzY2FsZVRvIiwibW92ZUJ5IiwiaGVpZ2h0Iiwid2lkdGgiLCJwdXNoIiwiQ2FsbEZ1bmMiLCJfZGVsU2luZ2xlSXRlbSIsIm4iLCJkaXNwbGF5RGF0YSIsImxlbmd0aCIsImxpc3RJZCIsIl9saXN0SWQiLCJzcGxpY2UiLCJydW5BY3Rpb24iLCJTZXF1ZW5jZSIsIm9uQ2xpY2tUaGlzIiwic2VsZWN0ZWRJZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBTUEsWUFBWSxHQUFHQyxFQUFFLENBQUNDLElBQUgsQ0FBUTtBQUN6QkMsRUFBQUEsSUFBSSxFQUFFLENBRG1CO0FBRXpCQyxFQUFBQSxNQUFNLEVBQUUsQ0FGaUI7QUFFZDtBQUNYQyxFQUFBQSxNQUFNLEVBQUUsQ0FIaUIsQ0FHZDs7QUFIYyxDQUFSLENBQXJCO0FBTUFKLEVBQUUsQ0FBQ0ssY0FBSCxHQUFxQkwsRUFBRSxDQUFDTSxLQUFILENBQVM7QUFDMUJDLEVBQUFBLE1BQU0sRUFBRTtBQUNKQyxJQUFBQSxnQkFBZ0IsRUFBRSxLQURkO0FBRUpDLElBQUFBLElBQUksRUFBRSw4QkFGRjtBQUdKQyxJQUFBQSxjQUFjLEVBQUUsQ0FBQyxJQUhiLENBRzJCOztBQUgzQixHQURrQjtBQU0xQixhQUFTVixFQUFFLENBQUNXLGdCQU5jO0FBUTFCQyxFQUFBQSxVQUFVLEVBQUU7QUFDUkMsSUFBQUEsWUFBWSxFQUFFO0FBQ1YsaUJBQVNkLFlBQVksQ0FBQ0csSUFEWjtBQUVWWSxNQUFBQSxJQUFJLEVBQUVmLFlBRkk7QUFHVmdCLE1BQUFBLE9BQU8sRUFBRUMsTUFBTSxJQUFJLGFBSFQsQ0FJVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFWVSxLQUROO0FBYVJDLElBQUFBLFlBQVksRUFBRTtBQUNWLGlCQUFTLElBREM7QUFFVkgsTUFBQUEsSUFBSSxFQUFFZCxFQUFFLENBQUNrQixJQUZDO0FBR1ZDLE1BQUFBLE9BQU8sRUFBRSxtQkFBWTtBQUNqQixZQUFJQyxJQUFJLEdBQUcsS0FBS1AsWUFBTCxHQUFvQixDQUEvQjtBQUNBLFlBQUksQ0FBQ08s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QyxXQUFYLENBQXVCQyxNQUF2QixHQUFnQyxDQUE3QyxFQUFnREYsQ0FBQyxJQUFJLENBQXJELEVBQXdEQSxDQUFDLEVBQXpELEVBQTZEO0FBQ3pELGdCQUFJLEtBQUksQ0FBQy9CLEtBQUwsQ0FBV2dDLFdBQVgsQ0FBdUJELENBQXZCLEVBQTBCRyxNQUExQixJQUFvQyxLQUFJLENBQUM1QyxJQUFMLENBQVU2QyxPQUFsRCxFQUEyRDtBQUN2RCxjQUFBLEtBQUksQ0FBQ25DLEtBQUwsQ0FBV2dDLFdBQVgsQ0FBdUJJLE1BQXZCLENBQThCTCxDQUE5QixFQUFpQyxDQUFqQzs7QUFDQTtBQUNIO0FBQ0o7QUFDSjs7QUFDRFYsUUFBQUEsUUFBUTtBQUNYLE9BWFMsQ0FBVjtBQVlIOztBQUNELFNBQUsvQixJQUFMLENBQVUrQyxTQUFWLENBQW9CLElBQUlqRixFQUFFLENBQUNrRixRQUFQLENBQWdCZixJQUFoQixDQUFwQjtBQUNILEdBbEt5QjtBQW9LMUJnQixFQUFBQSxXQXBLMEIseUJBb0taO0FBQ1Y7QUFDQSxTQUFLdkMsS0FBTCxDQUFXd0MsVUFBWCxHQUF3QixLQUFLbEQsSUFBTCxDQUFVNkMsT0FBbEM7QUFDSDtBQXZLeUIsQ0FBVCxDQUFyQiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICogQGF1dGhvciBrTCA8a2xrMEBxcS5jb20+XG4gKiBAZGF0ZSAyMDE5LzUvMTVcbiAqIEBkb2MgTGlzdCBJdGVtIGNvbXBvbmVudC4uXG4gKiDor7TmmI7vvJpcbiAqICAgICAgMS4gVGhpcyBjb21wb25lbnQgbXVzdCBiZSB1c2VkIGluIGNvbmp1bmN0aW9uIHdpdGggdGhlIExpc3QgY29tcG9uZW50LiAoU3VwcG9ydGluZyAuLilcbiAqIEBlbmRcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5jb25zdCBTZWxlY3RlZFR5cGUgPSBjYy5FbnVtKHtcbiAgICBOT05FOiAwLFxuICAgIFRPR0dMRTogMSwgLy8gU2luZ2xlIChTaW5nbGUgbm9kZSBzaG93IC8gaGlkZSlcbiAgICBTV0lUQ0g6IDIsIC8vIFN3aXRjaCAoc2luZ2xlIFNwcml0ZSBzd2l0Y2ggU3ByaXRlRnJhbWUpXG59KTtcblxuY2MuQmFzZUl0ZW1DdXN0b20gID0gY2MuQ2xhc3Moe1xuICAgIGVkaXRvcjoge1xuICAgICAgICBkaXNhbGxvd011bHRpcGxlOiBmYWxzZSxcbiAgICAgICAgbWVudTogJ0N1c3RvbSBjb21wb25lbnQgLyBMaXN0IEl0ZW0nLFxuICAgICAgICBleGVjdXRpb25PcmRlcjogLTUwMDEsICAgICAgICAgLy8gQmVmb3JlIExpc3RcbiAgICB9LFxuICAgIGV4dGVuZHM6IGNjLlZvekJhc2VDb21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIHNlbGVjdGVkTW9kZToge1xuICAgICAgICAgICAgZGVmYXVsdDogU2VsZWN0ZWRUeXBlLk5PTkUsXG4gICAgICAgICAgICB0eXBlOiBTZWxlY3RlZFR5cGUsXG4gICAgICAgICAgICB0b29sdGlwOiBDQ19ERVYgJiYgJ1NlbGVjdCBtb2RlJyxcbiAgICAgICAgICAgIC8vIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gICAgIHJldHVybiB0aGlzLl9zbGlkZVR5cGU7XG4gICAgICAgICAgICAvLyB9LFxuICAgICAgICAgICAgLy8gc2V0OiBmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgICAgICAvLyAgICAgaWYgKHZhbCAhPSBudWxsKVxuICAgICAgICAgICAgLy8gICAgICAgICB0aGlzLl9zbGlkZVR5cGUgPSB2YWw7XG4gICAgICAgICAgICAvLyB9XG4gICAgICAgIH0sXG4gICAgICAgIHNlbGVjdGVkRmxhZzoge1xuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6IGNjLk5vZGUsXG4gICAgICAgICAgICB2aXNpYmxlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgbGV0IGJvb2wgPSB0aGlzLnNlbGVjdGVkTW9kZSA+IDA7XG4gICAgICAgICAgICAgICAgaWYgKCFib29sKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkRmxhZyA9IG51bGw7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGJvb2w7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBzZWxlY3RlZFNwcml0ZUZyYW1lOiB7XG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxuICAgICAgICAgICAgdHlwZTogY2MuU3ByaXRlRnJhbWUsXG4gICAgICAgICAgICB2aXNpYmxlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgbGV0IGJvb2wgPSB0aGlzLnNlbGVjdGVkTW9kZSA9PSBTZWxlY3RlZFR5cGUuU1dJVENIO1xuICAgICAgICAgICAgICAgIGlmICghYm9vbClcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFNwcml0ZUZyYW1lID0gbnVsbDtcbiAgICAgICAgICAgICAgICByZXR1cm4gYm9vbDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIGFkYXB0aXZlU2l6ZToge1xuICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UsXG4gICAgICAgICAgICB0b29sdGlwOiBDQ19ERVYgJiYgJ0FkYXB0aXZlIHNpemUgKHdpZHRoIG9yIGhlaWdodCknLFxuICAgICAgICB9LFxuICAgICAgICBfc2VsZWN0ZWQ6IGZhbHNlLFxuICAgICAgICBzZWxlY3RlZDoge1xuICAgICAgICAgICAgdmlzaWJsZTogZmFsc2UsXG4gICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdGVkO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldCh2YWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zZWxlY3RlZCA9IHZhbDtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc2VsZWN0ZWRGbGFnKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgc3dpdGNoICh0aGlzLnNlbGVjdGVkTW9kZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFNlbGVjdGVkVHlwZS5UT0dHTEU6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkRmxhZy5hY3RpdmUgPSB2YWw7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBTZWxlY3RlZFR5cGUuU1dJVENIOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5zZWxlY3RlZEZsYWcubm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEZsYWcuc3ByaXRlRnJhbWUgPSB2YWwgPyB0aGlzLnNlbGVjdGVkU3ByaXRlRnJhbWUgOiB0aGlzLl91bnNlbGVjdGVkU3ByaXRlRnJhbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIF9idG5Db206IG51bGwsXG4gICAgICAgIGJ0bkNvbToge1xuICAgICAgICAgICAgdmlzaWJsZTogZmFsc2UsXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2J0bkNvbSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYnRuQ29tID0gdGhpcy5ub2RlLmdldENvbXBvbmVudChjYy5CdXR0b24pO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9idG5Db207XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgfSxcblxuICAgIG9uRGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5ub2RlLm9mZihjYy5Ob2RlLkV2ZW50VHlwZS5TSVpFX0NIQU5HRUQsIHRoaXMuX29uU2l6ZUNoYW5nZSwgdGhpcyk7XG4gICAgfSxcblxuICAgIF9yZWdpc3RlckV2ZW50KCkge1xuICAgICAgICBpZiAoIXRoaXMuZXZlbnRSZWcpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmJ0bkNvbSAmJiB0aGlzLl9saXN0LnNlbGVjdGVkTW9kZSA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmJ0bkNvbS5jbGlja0V2ZW50cy51bnNoaWZ0KHRoaXMuY3JlYXRlRXZ0KHRoaXMsICdvbkNsaWNrVGhpcycpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmFkYXB0aXZlU2l6ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5TSVpFX0NIQU5HRUQsIHRoaXMuX29uU2l6ZUNoYW5nZSwgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmV2ZW50UmVnID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBfb25TaXplQ2hhbmdlKCkge1xuICAgICAgICB0aGlzLl9saXN0Ll9vbkl0ZW1BZGFwdGl2ZSh0aGlzLm5vZGUpO1xuICAgIH0sXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGV2ZW50XG4gICAgICogQHBhcmFtIHtjYy5Db21wb25lbnR9IGNvbXBvbmVudCBDb21wb25lbnQgc2NyaXB0XG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGhhbmRsZXJOYW1lIFRyaWdnZXIgZnVuY3Rpb24gbmFtZVxuICAgICAqIEBwYXJhbSB7Y2MuTm9kZX0gbm9kZSBXaGVyZSB0aGUgY29tcG9uZW50cyBhcmUgbm9kZe+8iFRha2UgaXQgd2l0aG91dCB0cmFuc21pdHRpbmcgY29tcG9uZW50Lm5vZGXvvIlcbiAgICAgKiBAcmV0dXJucyBjYy5Db21wb25lbnQuRXZlbnRIYW5kbGVyXG4gICAgICovXG4gICAgY3JlYXRlRXZ0KGNvbXBvbmVudCwgaGFuZGxlck5hbWUsIG5vZGUpIHtcbiAgICAgICAgaWYgKCFjb21wb25lbnQuaXNWYWxpZClcbiAgICAgICAgICAgIHJldHVybjsvL1NvbWUgYXJlIGxvYWRlZCBhc3luY2hyb25vdXNseSwgYW5kIG5vZGVzIGFyZSBkZXN0cm95ZWQgYXMgd2VsbC5cbiAgICAgICAgY29tcG9uZW50LmNvbU5hbWUgPSBjb21wb25lbnQuY29tTmFtZSB8fCBjb21wb25lbnQubmFtZS5tYXRjaCgvXFw8KC4qPylcXD4vZykucG9wKCkucmVwbGFjZSgvXFw8fD4vZywgJycpO1xuICAgICAgICBsZXQgZXZ0ID0gbmV3IGNjLkNvbXBvbmVudC5FdmVudEhhbmRsZXIoKTtcbiAgICAgICAgZXZ0LnRhcmdldCA9IG5vZGUgfHwgY29tcG9uZW50Lm5vZGU7XG4gICAgICAgIGV2dC5jb21wb25lbnQgPSBjb21wb25lbnQuY29tTmFtZTtcbiAgICAgICAgZXZ0LmhhbmRsZXIgPSBoYW5kbGVyTmFtZTtcbiAgICAgICAgcmV0dXJuIGV2dDtcbiAgICB9LFxuXG4gICAgc2hvd0FuaShhbmlUeXBlLCBjYWxsRnVuYywgZGVsKSB7XG4gICAgICAgIGxldCBhY3RzO1xuICAgICAgICBzd2l0Y2ggKGFuaVR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgMDogLy9EaXNhcHBlYXJhbmNlXG4gICAgICAgICAgICAgICAgYWN0cyA9IFtcbiAgICAgICAgICAgICAgICAgICAgbmV3IGNjLnNjYWxlVG8oLjIsIC43KSxcbiAgICAgICAgICAgICAgICAgICAgbmV3IGNjLm1vdmVCeSguMywgMCwgdGhpcy5ub2RlLmhlaWdodCAqIDIpLFxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDE6IC8vRGlzYXBwZWFyIHJpZ2h0XG4gICAgICAgICAgICAgICAgYWN0cyA9IFtcbiAgICAgICAgICAgICAgICAgICAgbmV3IGNjLnNjYWxlVG8oLjIsIC43KSxcbiAgICAgICAgICAgICAgICAgICAgbmV3IGNjLm1vdmVCeSguMywgdGhpcy5ub2RlLndpZHRoICogMiwgMCksXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMjogLy9EaXNhcHBlYXIgZG93blxuICAgICAgICAgICAgICAgIGFjdHMgPSBbXG4gICAgICAgICAgICAgICAgICAgIG5ldyBjYy5zY2FsZVRvKC4yLCAuNyksXG4gICAgICAgICAgICAgICAgICAgIG5ldyBjYy5tb3ZlQnkoLjMsIDAsIHRoaXMubm9kZS5oZWlnaHQgKiAtMiksXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMzogLy9EaXNhcHBlYXIgbGVmdFxuICAgICAgICAgICAgICAgIGFjdHMgPSBbXG4gICAgICAgICAgICAgICAgICAgIG5ldyBjYy5zY2FsZVRvKC4yLCAuNyksXG4gICAgICAgICAgICAgICAgICAgIG5ldyBjYy5tb3ZlQnkoLjMsIHRoaXMubm9kZS53aWR0aCAqIC0yLCAwKSxcbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDogLy8gRGVmYXVsdDogem9vbSBvdXRcbiAgICAgICAgICAgICAgICBhY3RzID0gW1xuICAgICAgICAgICAgICAgICAgICBuZXcgY2Muc2NhbGVUbyguMywgLjEpLFxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNhbGxGdW5jIHx8IGRlbCkge1xuICAgICAgICAgICAgYWN0cy5wdXNoKG5ldyBjYy5DYWxsRnVuYygoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGRlbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9saXN0Ll9kZWxTaW5nbGVJdGVtKHRoaXMubm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IG4gPSB0aGlzLl9saXN0LmRpc3BsYXlEYXRhLmxlbmd0aCAtIDE7IG4gPj0gMDsgbi0tKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fbGlzdC5kaXNwbGF5RGF0YVtuXS5saXN0SWQgPT0gdGhpcy5ub2RlLl9saXN0SWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9saXN0LmRpc3BsYXlEYXRhLnNwbGljZShuLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYWxsRnVuYygpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubm9kZS5ydW5BY3Rpb24obmV3IGNjLlNlcXVlbmNlKGFjdHMpKTtcbiAgICB9LFxuXG4gICAgb25DbGlja1RoaXMoKSB7XG4gICAgICAgIC8vIGlmICh0aGlzLl9saXN0LnNlbGVjdGVkTW9kZSA9PSAxKVxuICAgICAgICB0aGlzLl9saXN0LnNlbGVjdGVkSWQgPSB0aGlzLm5vZGUuX2xpc3RJZDtcbiAgICB9LFxufSk7XG4iXX0=