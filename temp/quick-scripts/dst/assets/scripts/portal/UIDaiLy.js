
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/portal/UIDaiLy.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '7698dZ+jKBGNYlNkP0acvxs', 'UIDaiLy');
// scripts/portal/UIDaiLy.js

"use strict";

var Listview = require('Listview');

cc.Class({
  "extends": cc.VozBaseComponent,
  properties: {
    listview: Listview,
    listArea: [cc.Sprite],
    listBg: [cc.SpriteFrame],
    _listArea: []
  },
  onLoad: function onLoad() {
    this.listDaiLy = [];
    this._listArea = ["ja", "ko"];
    this.listview.numItems = this.listDaiLy.length;
  },
  onEnable: function onEnable() {
    mm.Loading.show();
    SmartFoxSDK.PortalController.ZoneInstance.addEventListenerExtension(CasinoEvent.RESPONSE_NAME.LIST_AGENCY_RES, this.onListAgency, this);
    var request = new CasinoRequest.ListAgencyRequest();
    SmartFoxSDK.PortalController.ZoneInstance.send(request.toSRequest());

    if (this.node.zIndex <= cc.lastZIndex) {
      this.node.zIndex = cc.lastZIndex + 1;
    }
  },
  onDisable: function onDisable() {
    SmartFoxSDK.PortalController.ZoneInstance.removeEventListenerExtension(CasinoEvent.RESPONSE_NAME.LIST_AGENCY_RES, this.onListAgency, this);
  },
  eventClose: function eventClose() {
    mm.audio.playButton();
    this.back();
  },
  onListAgency: function onListAgency(event) {
    mm.Loading.hide();
    var listAgency = new CasinoEvent.ListAgencyEvent().fromEvent(event);
    this.listBaseDaiLy = listAgency;
    this.listDaiLy = listAgency;
    console.log(listAgency);
    this.eventSelectArea(null, this.getLastArea());
  },
  onListRender: function onListRender(item, idx) {
    var rank = this.listDaiLy[idx];
    item.getComponent(item.name).init(rank, idx);
    item.getComponent(item.name).addEventSelect(function (dataSelect) {
      mm.audio.playButton();
      this.show('UIPayment', {
        pop: true,
        src: 'portal',
        data: {
          nickname: dataSelect.name,
          agName: dataSelect.agName,
          area: dataSelect.zone
        }
      });
    });
  },
  onListSelected: function onListSelected(item, selectedId, lastSelectedId, val) {
    if (!item) return;
    var list = item.listItem._list;
    var str = 'Danh sách hoạt động hiện tại là:' + list.node.name + '，Lựa chọn hiện tại là：' + selectedId + '，Lựa chọn cuối cùng là：' + lastSelectedId;

    if (list.selectedMode == 2) {
      //Nếu nó là chế độ đa lựa chọn
      str += '，Giá trị hiện tại：' + val;
    }

    console.log(str);
  },
  eventSelectArea: function eventSelectArea(event, data) {
    if (event != null) mm.audio.playButton();
    var listArea = this.getDailyInArea(data);
    this.listDaiLy = listArea;
    this.listview.numItems = listArea.length;

    for (var i = 0; i < 3; i++) {
      this.listArea[i].spriteFrame = this.listBg[0];
    }

    this.listArea[data].spriteFrame = this.listBg[1];
  },
  getDailyInArea: function getDailyInArea(posArea) {
    var area = this._listArea[posArea];
    var listArea = [];

    for (var i = 0; i < this.listBaseDaiLy.length; i++) {
      if (this.listBaseDaiLy[i].zone == area) listArea.push(this.listBaseDaiLy[i]);
    }

    return listArea;
  },
  getLastArea: function getLastArea() {
    var localStorage = cc.sys.localStorage;

    if (localStorage.getItem("last_area") === null || localStorage.getItem("last_area") === undefined) {
      localStorage.setItem("last_area", "ja");
    }

    var area = localStorage.getItem("last_area");
    if (area == "ja") return 0;else return 1;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9zY3JpcHRzL3BvcnRhbC9VSURhaUx5LmpzIl0sIm5hbWVzIjpbIkxpc3R2aWV3IiwicmVxdWlyZSIsImNjIiwiQ2xhc3MiLCJWb3pCYXNlQ29tcG9uZW50IiwicHJvcGVydGllcyIsImxpc3R2aWV3IiwibGlzdEFyZWEiLCJTcHJpdGUiLCJsaXN0QmciLCJTcHJpdGVGcmFtZSIsIl9saXN0QXJlYSIsIm9uTG9hZCIsImxpc3REYWlMeSIsIm51bUl0ZW1zIiwibGVuZ3RoIiwib25FbmFibGUiLCJtbSIsIkxvYWRpbmciLCJzaG93IiwiU21hcnRGb3hTREsiLCJQb3J0YWxDb250cm9sbGVyIiwiWm9uZUluc3RhbmNlIiwiYWRkRXZlbnRMaXN0ZW5lckV4dGVuc2lvbiIsIkNhc2lub0V2ZW50IiwiUkVTUE9OU0VfTkFNRSIsIkxJU1RfQUdFTkNZX1JFUyIsIm9uTGlzdEFnZW5jeSIsInJlcXVlc3QiLCJDYXNpbm9SZXF1ZXN0IiwiTGlzdEFnZW5jeVJlcXVlc3QiLCJzZW5kIiwidG9TUmVxdWVzdCIsIm5vZGUiLCJ6SW5kZXgiLCJsYXN0WkluZGV4Iiwib25EaXNhYmxlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lckV4dGVuc2lvbiIsImV2ZW50Q2xvc2UiLCJhdWRpbyIsInBsYXlCdXR0b24iLCJiYWNrIiwiZXZlbnQiLCJoaWRlIiwibGlzdEFnZW5jeSIsIkxpc3RBZ2VuY3lFdmVudCIsImZyb21FdmVudCIsImxpc3RCYXNlRGFpTHkiLCJjb25zb2xlIiwibG9nIiwiZXZlbnRTZWxlY3RBcmVhIiwiZ2V0TGFzdEFyZWEiLCJvbkxpc3RSZW5kZXIiLCJpdGVtIiwiaWR4IiwicmFuayIsImdldENvbXBvbmVudCIsIm5hbWUiLCJpbml0IiwiYWRkRXZlbnRTZWxlY3QiLCJkYXRhU2VsZWN0IiwicG9wIiwic3JjIiwiZGF0YSIsIm5pY2tuYW1lIiwiYWdOYW1lIiwiYXJlYSIsInpvbmUiLCJvbkxpc3RTZWxlY3RlZCIsInNlbGVjdGVkSWQiLCJsYXN0U2VsZWN0ZWRJZCIsInZhbCIsImxpc3QiLCJsaXN0SXRlbSIsIl9saXN0Iiwic3RyIiwic2VsZWN0ZWRNb2RlIiwiZ2V0RGFpbHlJbkFyZWEiLCJpIiwic3ByaXRlRnJhbWUiLCJwb3NBcmVhIiwicHVzaCIsImxvY2FsU3RvcmFnZSIsInN5cyIsImdldEl0ZW0iLCJ1bmRlZmluZWQiLCJzZXRJdGVtIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQUQsQ0FBeEI7O0FBQ0FDLEVBQUUsQ0FBQ0MsS0FBSCxDQUFTO0FBQ0wsYUFBU0QsRUFBRSxDQUFDRSxnQkFEUDtBQUdMQyxFQUFBQSxVQUFVLEVBQUU7QUFDUkMsSUFBQUEsUUFBUSxFQUFNTixRQUROO0FBRVJPLElBQUFBLFFBQVEsRUFBTSxDQUFDTCxFQUFFLENBQUNNLE1BQUosQ0FGTjtBQUdSQyxJQUFBQSxNQUFNLEVBQVEsQ0FBQ1AsRUFBRSxDQUFDUSxXQUFKLENBSE47QUFJUkMsSUFBQUEsU0FBUyxFQUFJO0FBSkwsR0FIUDtBQVNMQyxFQUFBQSxNQVRLLG9CQVNJO0FBQ0wsU0FBS0MsU0FBTCxHQUFpQixFQUFqQjtBQUNBLFNBQUtGLFNBQUwsR0FBaUIsQ0FBQyxJQUFELEVBQU8sSUFBUCxDQUFqQjtBQUNBLFNBQUtMLFFBQUwsQ0FBY1EsUUFBZCxHQUF5QixLQUFLRCxTQUFMLENBQWVFLE1BQXhDO0FBQ0gsR0FiSTtBQWNMQyxFQUFBQSxRQWRLLHNCQWNLO0FBQ05DLElBQUFBLEVBQUUsQ0FBQ0MsT0FBSCxDQUFXQyxJQUFYO0FBQ0FDLElBQUFBLFdBQVcsQ0FBQ0MsZ0JBQVosQ0FBNkJDLFlBQTdCLENBQTBDQyx5QkFBMUMsQ0FBb0VDLFdBQVcsQ0FBQ0MsYUFBWixDQUEwQkMsZUFBOUYsRUFBK0csS0FBS0MsWUFBcEgsRUFBa0ksSUFBbEk7QUFDQSxRQUFJQyxPQUFPLEdBQUcsSUFBSUMsYUFBYSxDQUFDQyxpQkFBbEIsRUFBZDtBQUNBVixJQUFBQSxXQUFXLENBQUNDLGdC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QUNWLFFBQUkrQixZQUFZLEdBQUdoRixFQUFFLENBQUNpRixHQUFILENBQU9ELFlBQTFCOztBQUNBLFFBQUlBLFlBQVksQ0FBQ0UsT0FBYixDQUFxQixXQUFyQixNQUFzQyxJQUF0QyxJQUE4Q0YsWUFBWSxDQUFDRSxPQUFiLENBQXFCLFdBQXJCLE1BQXNDQyxTQUF4RixFQUFtRztBQUMvRkgsTUFBQUEsWUFBWSxDQUFDSSxPQUFiLENBQXFCLFdBQXJCLEVBQWtDLElBQWxDO0FBQ0g7O0FBQ0QsUUFBSXBCLElBQUksR0FBR2dCLFlBQVksQ0FBQ0UsT0FBYixDQUFxQixXQUFyQixDQUFYO0FBQ0EsUUFBSWxCLElBQUksSUFBSSxJQUFaLEVBQ0ksT0FBUSxDQUFSLENBREosS0FHSSxPQUFPLENBQVA7QUFDUDtBQXRGSSxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBMaXN0dmlldyA9IHJlcXVpcmUoJ0xpc3R2aWV3Jyk7XG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuVm96QmFzZUNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgbGlzdHZpZXcgICAgOiBMaXN0dmlldyxcbiAgICAgICAgbGlzdEFyZWEgICAgOiBbY2MuU3ByaXRlXSxcbiAgICAgICAgbGlzdEJnICAgICAgOiBbY2MuU3ByaXRlRnJhbWVdLFxuICAgICAgICBfbGlzdEFyZWEgIDogW11cbiAgICB9LFxuICAgIG9uTG9hZCgpIHtcbiAgICAgICAgdGhpcy5saXN0RGFpTHkgPSBbXTtcbiAgICAgICAgdGhpcy5fbGlzdEFyZWEgPSBbXCJqYVwiLCBcImtvXCJdO1xuICAgICAgICB0aGlzLmxpc3R2aWV3Lm51bUl0ZW1zID0gdGhpcy5saXN0RGFpTHkubGVuZ3RoO1xuICAgIH0sXG4gICAgb25FbmFibGUoKXtcbiAgICAgICAgbW0uTG9hZGluZy5zaG93KCk7XG4gICAgICAgIFNtYXJ0Rm94U0RLLlBvcnRhbENvbnRyb2xsZXIuWm9uZUluc3RhbmNlLmFkZEV2ZW50TGlzdGVuZXJFeHRlbnNpb24oQ2FzaW5vRXZlbnQuUkVTUE9OU0VfTkFNRS5MSVNUX0FHRU5DWV9SRVMsIHRoaXMub25MaXN0QWdlbmN5LCB0aGlzKTtcbiAgICAgICAgbGV0IHJlcXVlc3QgPSBuZXcgQ2FzaW5vUmVxdWVzdC5MaXN0QWdlbmN5UmVxdWVzdCgpO1xuICAgICAgICBTbWFydEZveFNESy5Qb3J0YWxDb250cm9sbGVyLlpvbmVJbnN0YW5jZS5zZW5kKHJlcXVlc3QudG9TUmVxdWVzdCgpKTtcbiAgICAgICAgaWYgKHRoaXMubm9kZS56SW5kZXggPD0gY2MubGFzdFpJbmRleCl7XG4gICAgICAgICAgICB0aGlzLm5vZGUuekluZGV4ID0gY2MubGFzdFpJbmRleCsxO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBvbkRpc2FibGUoKXtcbiAgICAgICAgU21hcnRGb3hTREsuUG9ydGFsQ29udHJvbGxlci5ab25lSW5zdGFuY2UucmVtb3ZlRXZlbnRMaXN0ZW5lckV4dGVuc2lvbihDYXNpbm9FdmVudC5SRVNQT05TRV9OQU1FLkxJU1RfQUdFTkNZX1JFUywgdGhpcy5vbkxpc3RBZ2VuY3ksIHRoaXMpO1xuICAgIH0sXG4gICAgZXZlbnRDbG9zZSgpIHtcbiAgICAgICAgbW0uYXVkaW8ucGxheUJ1dHRvbigpO1xuICAgICAgICB0aGlzLmJhY2soKTtcbiAgICB9LFxuICAgIG9uTGlzdEFnZW5jeShldmVudCl7XG4gICAgICAgIG1tLkxvYWRpbmcuaGlkZSgpO1xuICAgICAgICBsZXQgbGlzdEFnZW5jeSA9IG5ldyBDYXNpbm9FdmVudC5MaXN0QWdlbmN5RXZlbnQoKS5mcm9tRXZlbnQoZXZlbnQpO1xuICAgICAgICB0aGlzLmxpc3RCYXNlRGFpTHkgPSBsaXN0QWdlbmN5O1xuICAgICAgICB0aGlzLmxpc3REYWlMeSA9IGxpc3RBZ2VuY3k7XG4gICAgICAgIGNvbnNvbGUubG9nKGxpc3RBZ2VuY3kpO1xuICAgICAgICB0aGlzLmV2ZW50U2VsZWN0QXJlYShudWxsLCB0aGlzLmdldExhc3RBcmVhKCkpO1xuICAgIH0sXG4gICAgb25MaXN0UmVuZGVyKGl0ZW0sIGlkeCkge1xuICAgICAgICBsZXQgcmFuayA9IHRoaXMubGlzdERhaUx5W2lkeF07XG4gICAgICAgIGl0ZW0uZ2V0Q29tcG9uZW50KGl0ZW0ubmFtZSkuaW5pdChyYW5rLCBpZHgpO1xuICAgICAgICBpdGVtLmdldENvbXBvbmVudChpdGVtLm5hbWUpLmFkZEV2ZW50U2VsZWN0KGZ1bmN0aW9uIChkYXRhU2VsZWN0KSB7XG4gICAgICAgICAgICBtbS5hdWRpby5wbGF5QnV0dG9uKCk7XG4gICAgICAgICAgICB0aGlzLnNob3coJ1VJUGF5bWVudCcsIHtwb3A6IHRydWUsIHNyYzogJ3BvcnRhbCcsIGRhdGEgOiB7bmlja25hbWU6IGRhdGFTZWxlY3QubmFtZSwgYWdOYW1lOiBkYXRhU2VsZWN0LmFnTmFtZSwgYXJlYSA6IGRhdGFTZWxlY3Quem9uZX19KTtcbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICBvbkxpc3RTZWxlY3RlZChpdGVtLCBzZWxlY3RlZElkLCBsYXN0U2VsZWN0ZWRJZCwgdmFsKSB7XG4gICAgICAgIGlmICghaXRlbSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgbGV0IGxpc3QgPSBpdGVtLmxpc3RJdGVtLl9saXN0O1xuICAgICAgICBsZXQgc3RyID0gJ0Rhbmggc8OhY2ggaG/huqF0IMSR4buZbmcgaGnhu4duIHThuqFpIGzDoDonICsgbGlzdC5ub2RlLm5hbWUgKyAn77yMTOG7sWEgY2jhu41uIGhp4buHbiB04bqhaSBsw6DvvJonICsgc2VsZWN0ZWRJZCArICfvvIxM4buxYSBjaOG7jW4gY3Xhu5FpIGPDuW5nIGzDoO+8micgKyBsYXN0U2VsZWN0ZWRJZDtcbiAgICAgICAgaWYgKGxpc3Quc2VsZWN0ZWRNb2RlID09IDIpIHsgLy9O4bq/dSBuw7MgbMOgIGNo4bq/IMSR4buZIMSRYSBs4buxYSBjaOG7jW5cbiAgICAgICAgICAgIHN0ciArPSAn77yMR2nDoSB0cuG7iyBoaeG7h24gdOG6oWnvvJonICsgdmFsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUubG9nKHN0cik7XG4gICAgfSxcbiAgICBldmVudFNlbGVjdEFyZWEoZXZlbnQsIGRhdGEpIHtcbiAgICAgICAgaWYgKGV2ZW50ICE9IG51bGwpXG4gICAgICAgICAgICBtbS5hdWRpby5wbGF5QnV0dG9uKCk7XG4gICAgICAgIGxldCBsaXN0QXJlYSAgICAgICAgICAgPSB0aGlzLmdldERhaWx5SW5BcmVhKGRhdGEpO1xuICAgICAgICB0aGlzLmxpc3REYWlMeSAgICAgICAgID0gbGlzdEFyZWE7XG4gICAgICAgIHRoaXMubGlzdHZpZXcubnVtSXRlbXMgPSBsaXN0QXJlYS5sZW5ndGg7XG4gICAgICAgIGZvciAobGV0IGk9MDsgaTwgMzsgaSsrKXtcbiAgICAgICAgICAgIHRoaXMubGlzdEFyZWFbaV0uc3ByaXRlRnJhbWUgPSB0aGlzLmxpc3RCZ1swXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmxpc3RBcmVhW2RhdGFdLnNwcml0ZUZyYW1lID0gdGhpcy5saXN0QmdbMV07XG4gICAgfSxcbiAgICBnZXREYWlseUluQXJlYShwb3NBcmVhKSB7XG4gICAgICAgIGxldCBhcmVhID0gdGhpcy5fbGlzdEFyZWFbcG9zQXJlYV07XG4gICAgICAgIGxldCBsaXN0QXJlYSA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpPTA7IGk8IHRoaXMubGlzdEJhc2VEYWlMeS5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgIGlmICggdGhpcy5saXN0QmFzZURhaUx5W2ldLnpvbmUgPT0gYXJlYSlcbiAgICAgICAgICAgICAgIGxpc3RBcmVhLnB1c2godGhpcy5saXN0QmFzZURhaUx5W2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGlzdEFyZWE7XG4gICAgfSxcbiAgICBnZXRMYXN0QXJlYSgpIHtcbiAgICAgICAgbGV0IGxvY2FsU3RvcmFnZSA9IGNjLnN5cy5sb2NhbFN0b3JhZ2U7XG4gICAgICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImxhc3RfYXJlYVwiKSA9PT0gbnVsbCB8fCBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImxhc3RfYXJlYVwiKSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImxhc3RfYXJlYVwiLCBcImphXCIpO1xuICAgICAgICB9XG4gICAgICAgIGxldCBhcmVhID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJsYXN0X2FyZWFcIik7XG4gICAgICAgIGlmIChhcmVhID09IFwiamFcIilcbiAgICAgICAgICAgIHJldHVybiAgMDtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxufSk7XG4iXX0=