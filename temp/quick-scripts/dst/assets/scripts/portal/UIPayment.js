
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/portal/UIPayment.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'abfc05QDbBCroaZ4Iewkmk2', 'UIPayment');
// scripts/portal/UIPayment.js

"use strict";

cc.Class({
  "extends": cc.VozBaseComponent,
  properties: {
    edit_user_re: cc.EditBox,
    edit_user_re_again: cc.EditBox,
    edit_money: cc.EditBox,
    lbTyLe: cc.Label,
    lbMyMoney: cc.Label,
    lbMoneyRev: cc.Label,
    lbTienTe: cc.Label,
    lbDesTrans: cc.Label,
    warningNode: cc.Node,
    lbIsDaiLy: cc.Label,
    lbNickName: cc.Label,
    lbGold: cc.Label,
    lbDes: cc.Label,
    _area: "ja",
    _moneyConvert: 0,
    _isDaiLy: false,
    listDaiLy: []
  },
  onEnable: function onEnable() {
    this.listDaiLy = [];
    SmartFoxSDK.PortalController.ZoneInstance.addEventListenerExtension(CasinoEvent.RESPONSE_NAME.LIST_AGENCY_RES, this.onListAgency, this);
    var request = new CasinoRequest.ListAgencyRequest();
    SmartFoxSDK.PortalController.ZoneInstance.send(request.toSRequest());

    if (this.node.zIndex <= cc.lastZIndex) {
      this.node.zIndex = cc.lastZIndex + 1;
    }

    if (this._data.nickname != null) {
      this.setLastArea(this._data.area);
      this.updateDaiLyInfo(this._data.nickname, this._data.agName);
    }

    this.warningNode.active = false;
    this._area = this.getLastArea();
    this.updateTyLe();
    this.lbMyMoney.string = Utils.addDotToNumber(GameVariables.getChip(SmartFoxSDK.PortalController.ZoneInstance.mySelf));
    ;
  },
  onDisable: function onDisable() {
    SmartFoxSDK.PortalController.ZoneInstance.removeEventListenerExtension(CasinoEvent.RESPONSE_NAME.LIST_AGENCY_RES, this.onListAgency, this);
  },
  onListAgency: function onListAgency(event) {
    mm.Loading.hide();
    this.listDaiLy = new CasinoEvent.ListAgencyEvent().fromEvent(event);
  },
  changeMoney: function changeMoney(editBox) {
    if (editBox == "") this.lbMoneyRev.string = "0";else this.lbMoneyRev.string = Utils.addDotToNumber(Math.floor(parseFloat(editBox)) / this._moneyConvert);
  },
  eventClose: function eventClose() {
    this.back();
    mm.audio.playButton();
  },
  updateDaiLyInfo: function updateDaiLyInfo(username, agName) {
    this.edit_user_re.string = username;
    this.edit_user_re_again.string = username;
    this.lbDesTrans.string = "Bán GOLD cho " + agName;
    this._data.agName = agName;
  },
  updateTyLe: function updateTyLe() {
    if (this._area == "ja") {
      this.lbTyLe.string = "Tỉ lệ quy đổi: 1YEN = 226.8";
      this.lbTienTe.string = "YEN";
      this._moneyConvert = 226.8;
    } else {
      this.lbTyLe.string = "Tỉ lệ quy đổi: 1WON = 20.52";
      this.lbTienTe.string = "WON";
      this._moneyConvert = 20.52;
    }
  },
  clickTransferMoney: function clickTransferMoney(event) {
    mm.audio.playButton();

    if (this.edit_user_re.string == "") {
      mm.Toast.showToast(1, "Tên người nhận không được trống");
      return;
    } // if(this.edit_user_re.string != this.edit_user_re_again.string){
    //     mm.Toast.showToast(1, "Nickname không khớp");
    //     return;
    // }


    if (this.edit_money.string == "") {
      mm.Toast.showToast(1, "Tiền không được trống");
      return;
    }

    if (parseInt(this.edit_money.string) < 10000) {
      mm.Toast.showToast(1, "Tiền phải lớn hơn 10.000");
      return;
    }

    this.showInfoWaring(this._data.agName);
  },
  showInfoWaring: function showInfoWaring(agenName) {
    if (agenName == undefined) agenName = "Không xác định!";
    this.warningNode.active = true;
    this.lbIsDaiLy.node.active = !this._isDaiLy;
    this.lbDes.string = "Chuyên GOLD cho " + agenName;
    this.lbNickName.string = this.edit_user_re.string;
    this.lbGold.string = Utils.addDotToNumber(this.edit_money.string) + " GOLD";
  },
  eventShowDaiLys: function eventShowDaiLys() {
    this.show("UIDaiLy", {
      pop: true,
      src: 'portal'
    });
  },
  eventChangeArea: function eventChangeArea() {
    if (this._area == "ja") this.setLastArea("ko");else this.setLastArea("ja");
    this._area = this.getLastArea();
    this.updateTyLe();
    this.changeMoney(this.edit_money.string);
  },
  setLastArea: function setLastArea(area) {
    var localStorage = cc.sys.localStorage;
    localStorage.setItem("last_area", area);
  },
  getLastArea: function getLastArea() {
    var localStorage = cc.sys.localStorage;

    if (localStorage.getItem("last_area") === null || localStorage.getItem("last_area") === undefined) {
      localStorage.setItem("last_area", "ja");
    }

    return localStorage.getItem("last_area");
  },
  eventDongY: function eventDongY() {
    var request = new CasinoRequest.TransferMoneyRequest();
    request.setMoneyTransfer(parseInt(this.edit_money.string));
    request.setUserRecived(this.edit_user_re.string);
    SmartFoxSDK.PortalController.ZoneInstance.send(request.toSRequest());
    mm.Loading.show();
    this.eventCancel();
  },
  eventCancel: function eventCancel() {
    this.warningNode.active = false;
  },
  eventGetInfoDaiLy: function eventGetInfoDaiLy() {
    this._isDaiLy = false;
    var nickName = this.edit_user_re.string;

    if (this.listDaiLy.length > 0) {
      for (var i = 0; i < this.listDaiLy.length; i++) {
        if (nickName == this.listDaiLy[i].name) {
          this._isDaiLy = true;
          this._area = this.listDaiLy[i].zone;
          this.updateDaiLyInfo(this.listDaiLy[i].name, this.listDaiLy[i].agName);
          this.updateTyLe();
          this.lbMyMoney.string = Utils.addDotToNumber(GameVariables.getChip(SmartFoxSDK.PortalController.ZoneInstance.mySelf));
          ;
        }
      }
    }
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xccG9ydGFsXFxVSVBheW1lbnQuanMiXSwibmFtZXMiOlsiY2MiLCJDbGFzcyIsIlZvekJhc2VDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwiZWRpdF91c2VyX3JlIiwiRWRpdEJveCIsImVkaXRfdXNlcl9yZV9hZ2FpbiIsImVkaXRfbW9uZXkiLCJsYlR5TGUiLCJMYWJlbCIsImxiTXlNb25leSIsImxiTW9uZXlSZXYiLCJsYlRpZW5UZSIsImxiRGVzVHJhbnMiLCJ3YXJuaW5nTm9kZSIsIk5vZGUiLCJsYklzRGFpTHkiLCJsYk5pY2tOYW1lIiwibGJHb2xkIiwibGJEZXMiLCJfYXJlYSIsIl9tb25leUNvbnZlcnQiLCJfaXNEYWlMeSIsImxpc3REYWlMeSIsIm9uRW5hYmxlIiwiU21hcnRGb3hTREsiLCJQb3J0YWxDb250cm9sbGVyIiwiWm9uZUluc3RhbmNlIiwiYWRkRXZlbnRMaXN0ZW5lckV4dGVuc2lvbiIsIkNhc2lub0V2ZW50IiwiUkVTUE9OU0VfTkFNRSIsIkxJU1RfQUdFTkNZX1JFUyIsIm9uTGlzdEFnZW5jeSIsInJlcXVlc3QiLCJDYXNpbm9SZXF1ZXN0IiwiTGlzdEFnZW5jeVJlcXVlc3QiLCJzZW5kIiwidG9TUmVxdWVzdCIsIm5vZGUiLCJ6SW5kZXgiLCJsYXN0WkluZGV4IiwiX2RhdGEiLCJuaWNrbmFtZSIsInNldExhc3RBcmVhIiwiYXJlYSIsInVwZGF0ZURhaUx5SW5mbyIsImFnTmFtZSIsImFjdGl2ZSIsImdldExhc3RBcmVhIiwidXBkYXRlVHlMZSIsInN0cmluZyIsIlV0aWxzIiwiYWRkRG90VG9OdW1iZXIiLCJHYW1lVmFyaWFibGVzIiwiZ2V0Q2hpcCIsIm15U2VsZiIsIm9uRGlzYWJsZSIsInJlbW92ZUV2ZW50TGlzdGVuZXJFeHRlbnNpb24iLCJldmVudCIsIm1tIiwiTG9hZGluZyIsImhpZGUiLCJMaXN0QWdlbmN5RXZlbnQiLCJmcm9tRXZlbnQiLCJjaGFuZ2VNb25leSIsImVkaXRCb3giLCJNYXRoIiwiZmxvb3IiLCJwYXJzZUZsb2F0IiwiZXZlbnRDbG9zZSIsImJhY2siLCJhdWRpbyIsInBsYXlCdXR0b24iLCJ1c2VybmFtZSIsImNsaWNrVHJhbnNmZXJNb25leSIsIlRvYXN0Iiwic2hvd1RvYXN0IiwicGFyc2VJbnQiLCJzaG93SW5mb1dhcmluZyIsImFnZW5OYW1lIiwidW5kZWZpbmVkIiwiZXZlbnRTaG93RGFpTHlzIiwic2hvdyIsInBvcCIsInNyYyIsImV2ZW50Q2hhbmdlQXJlYSIsImxvY2FsU3RvcmFnZSIsInN5cyIsInNldEl0ZW0iLCJnZXRJdGVtIiwiZXZlbnREb25nWSIsIlRyYW5zZmVyTW9uZXlSZXF1ZXN0Iiwic2V0TW9uZXlUcmFuc2ZlciIsInNldFVzZXJSZWNpdmVkIiwiZXZlbnRDYW5jZWwiLCJldmVudEdldEluZm9EYWlMeSIsIm5pY2tOYW1lIiwibGVuZ3RoIiwiaSIsIm5hbWUiLCJ6b25lIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBQSxFQUFFLENBQUNDLEtBQUgsQ0FBUztBQUNMLGFBQVNELEVBQUUsQ0FBQ0UsZ0JBRFA7QUFHTEMsRUFBQUEsVUFBVSxFQUFFO0FBQ1JDLElBQUFBLFlBQVksRUFBRUosRUFBRSxDQUFDSyxPQURUO0FBRVJDLElBQUFBLGtCQUFrQixFQUFFTixFQUFFLENBQUNLLE9BRmY7QUFHUkUsSUFBQUEsVUFBVSxFQUFFUCxFQUFFLENBQUNLLE9BSFA7QUFJUkcsSUFBQUEsTUFBTSxFQUFFUixFQUFFLENBQUNTLEtBSkg7QUFLUkMsSUFBQUEsU0FBUyxFQUFFVixFQUFFLENBQUNTLEtBTE47QUFNUkUsSUFBQUEsVUFBVSxFQUFFWCxFQUFFLENBQUNTLEtBTlA7QUFPUkcsSUFBQUEsUUFBUSxFQUFFWixFQUFFLENBQUNTLEtBUEw7QUFRUkksSUFBQUEsVUFBVSxFQUFFYixFQUFFLENBQUNTLEtBUlA7QUFTUkssSUFBQUEsV0FBVyxFQUFFZCxFQUFFLENBQUNlLElBVFI7QUFVUkMsSUFBQUEsU0FBUyxFQUFFaEIsRUFBRSxDQUFDUyxLQVZOO0FBV1JRLElBQUFBLFVBQVUsRUFBRWpCLEVBQUUsQ0FBQ1MsS0FYUDtBQVlSUyxJQUFBQSxNQUFNLEVBQUVsQixFQUFFLENBQUNTLEtBWkg7QUFhUlUsSUFBQUEsS0FBSyxFQUFFbkIsRUFBRSxDQUFDUyxLQWJGO0FBY1JXLElBQUFBLEtBQUssRUFBRSxJQWRDO0FBZVJDLElBQUFBLGFBQWEsRUFBRSxDQWZQO0FBZ0JSQyxJQUFBQSxRQUFRLEVBQUUsS0FoQkY7QUFpQlJDLElBQUFBLFNBQVMsRUFBRTtBQWpCSCxHQUhQO0FBc0JMQyxFQUFBQSxRQXRCSyxzQkFzQks7QUFDTixTQUFLRCxTQUFMLEdBQWlCLEVBQWpCO0FBQ0FFLElBQUFBLFdBQVcsQ0FBQ0MsZ0JBQVosQ0FBNkJDLFlBQTdCLENBQTBDQyx5QkFBMUMsQ0FBb0VDLFdBQVcsQ0FBQ0MsYUFBWixDQUEwQkMsZUFBOUYsRUFBK0csS0FBS0MsWUFBcEgsRUFBa0ksSUFBbEk7QUFDQSxRQUFJQyxPQUFPLEdBQUcsSUFBSUMsYUFBYSxDQUFDQyxpQkFBbEIsRUFBZDtBQUNBVixJQUFBQSxXQUFXLENBQUNDLGdCQUFaLENBQTZCQyxZQUE3QixDQUEwQ1MsSUFBMUMsQ0FBK0NILE9BQU8sQ0FBQ0ksVUFBUixFQUEvQzs7QUFFQSxRQUFJLEtBQUtDLElBQUwsQ0FBVUMsTUFBVixJQUFvQnZDLEVBQUUsQ0FBQ3dDLFVBQTNCLEVBQXNDO0FBQ2xDLFdBQUtGLElBQUwsQ0FBVUMsTUFBVixHQUFtQnZDLEVBQUUsQ0FBQ3dDLFVBQUgsR0FBYyxDQUFqQztBQUNIOztBQUNELFFBQUksS0FBS0MsS0FBTCxDQUFXQyxRQUFYLElBQXVCLElBQTNCLEVBQWdDO0FBQzVCLFdBQUtDLFdBQUwsQ0FBaUIsS0FBS0YsS0FBTCxDQUFXRyxJQUE1QjtBQUNBLFdBQUtDLGVBQUwsQ0FBcUIsS0FBS0osS0FBTCxDQUFXQyxRQUFoQyxFQUEwQyxLQUFLRCxLQUFMLENBQVdLLE1BQXJEO0FBQ0g7O0FBQ0QsU0FBS2hDLFdBQUwsQ0FBaUJpQyxNQUFqQixHQUEwQixLQUExQjtBQUNBLFNBQUszQixLQUFMLEdBQWEsS0FBSzRCLFdBQUwsRUFBYjtBQUNBLFNBQUtDLFVBQUw7QUFDQSxTQUFLdkMsU0FBTCxDQUFld0MsTUFBZixHQUF3QkMsS0FBSyxDQUFDQyxjQUFOLENBQXFCQyxhQUFhLENBQUNDLE9BQWQsQ0FBc0I3QixXQUFXLENBQUNDLGdCQUFaLENBQTZCQyxZQUE3QixDQUEwQzRCLE1BQWhFLENBQXJCLENBQXhCO0FBQXNIO0FBQ3pILEdBdkNJO0FBd0NMQyxFQUFBQSxTQXhDSyx1QkF3Q007QUFDUC9CLElBQUFBLFdBQVcsQ0FBQ0MsZ0JBQVosQ0FBNkJDLFlBQTdCLENBQTBDOEIsNEJBQTFDLENBQXVFNUIsV0FBVyxDQUFDQyxhQUFaLENBQTBCQyxlQUFqRyxFQUFrSCxLQUFLQyxZQUF2SCxFQUFxSSxJQUFySTtBQUNILEdBMUNJO0FBMkNMQSxFQUFBQSxZQTNDSyx3QkEyQ1EwQixLQTNDUixFQTJDYztBQUNmQyxJQUFBQSxFQUFFLENBQUNDLE9BQUgsQ0FBV0MsSUFBWDtBQUNBLFNBQUt0QyxTQUFMLEdBQWlCLElBQUlNLFdBQVcsQ0FBQ2lDLGVBQWhCLEdBQWtDQyxTQUFsQyxDQUE0Q0wsS0FBNUMsQ0FBakI7QUFDSCxHQTlDSTtBQStDTE0sRUFBQUEsV0EvQ0ssdUJBK0NPQyxPQS9DUCxFQStDZ0I7QUFDakIsUUFBSUEsT0FBTyxJQUFJLEVBQWYsRUFDSSxLQUFLdEQsVUFBTCxDQUFnQnVDLE1BQWhCLEdBQXlCLEdBQXpCLENBREosS0FHSSxLQUFLdkMsVUFBTCxDQUFnQnVDLE1BQWhCLEdBQXlCQyxLQUFLLENBQUNDLGNBQU4sQ0FBcUJjLElBQUksQ0FBQ0MsS0FBTCxDQUFXQyxVQUFVLENBQUNILE9BQUQsQ0FBckIsSUFBZ0MsS0FBSzVDLGFBQTFELENBQXpCO0FBQ1AsR0FwREk7QUFxRExnRCxFQUFBQSxVQXJESyx3QkFxRE87QUFDUixTQUFLQyxJQUFMO0FBQ0FYLElBQUFBLEVBQUUsQ0FBQ1ksS0FBSCxDQUFTQyxVQUFUO0FBQ0gsR0F4REk7QUF5REwzQixFQUFBQSxlQXpESywyQkF5RFc0QixRQXpEWCxFQXlEcUIzQixNQXpEckIsRUF5RDZCO0FBQzlCLFNBQUsxQyxZQUFMLENBQWtCOEMsTUFBbEIsR0FBa0N1QixRQUFsQztBQUNBLFNBQUtuRSxrQkFBTCxDQUF3QjRDLE1BQXhCLEdBQWtDdUIsUUFBbEM7QUFDQSxTQUFLNUQsVUFBTCxDQUFnQnFDLE1BQWhCLEdBQTBCLGtCQUFnQkosTUFBMUM7QUFDQSxTQUFLTCxLQUFMLENBQVdLLE1BQVgsR0FBb0JBLE1BQXBCO0FBQ0gsR0E5REk7QUErRExHLEVBQUFBLFVBL0RLLHdCQStEUTtBQUNULFFBQUksS0FBSzdCLEtBQUwsSUFBYyxJQUFsQixFQUF1QjtBQUNuQixXQUFLWixNQUFMLENBQVkwQyxNQUFaLEdBQXVCLDZCQUF2QjtBQUNBLFdBQUt0QyxRQUFMLENBQWNzQyxNQUFkLEdBQXVCLEtBQXZCO0FBQ0EsV0FBSzdCLGFBQUwsR0FBd0IsS0FBeEI7QUFDSCxLQUpELE1BSU07QUFDRixXQUFLYixNQUFMLENBQVkwQyxNQUFaLEdBQXFCLDZCQUFyQjtBQUNBLFdBQUt0QyxRQUFMLENBQWNzQyxNQUFkLEdBQXVCLEtBQXZCO0FBQ0EsV0FBSzdCLGFBQUwsR0FBdUIsS0FBdkI7QUFDSDtBQUNKLEdBekVJO0FBMEVMcUQsRUFBQUEsa0JBMUVLLDhCQTBFY2hCLEtBMUVkLEVBMEVvQjtBQUNyQkMsSUFBQUEsRUFBRSxDQUFDWSxLQUFILENBQVNDLFVBQVQ7O0FBQ0EsUUFBRyxLQUFLcEUsWUFBTCxDQUFrQjhDLE1BQWxCLElBQTRCLEVBQS9CLEVBQWtDO0FBQzlCUyxNQUFBQSxFQUFFLENBQUNnQixLQUFILENBQVNDLFNBQVQsQ0FBbUIsQ0FBbkIsRUFBc0IsaUNBQXRCO0FBQ0E7QUFDSCxLQUxvQixDQU1yQjtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0EsUUFBRyxLQUFLckUsVUFBTCxDQUFnQjJDLE1BQWhCLElBQTBCLEVBQTdCLEVBQWdDO0FBQzVCUyxNQUFBQSxFQUFFLENBQUNnQixLQUFILENBQVNDLFNBQVQsQ0FBbUIsQ0FBbkIsRUFBc0IsdUJBQXRCO0FBQ0E7QUFDSDs7QUFDRCxRQUFHQyxRQUFRLENBQUMsS0FBS3RFLFVBQUwsQ0FBZ0IyQyxNQUFqQixDQUFSLEdBQW1DLEtBQXRDLEVBQTRDO0FBQ3hDUyxNQUFBQSxFQUFFLENBQUNnQixLQUFILENBQVNDLFNBQVQsQ0FBbUIsQ0FBbkIsRUFBc0IsMEJBQXRCO0FBQ0E7QUFDSDs7QUFDRCxTQUFLRSxjQUFMLENBQW9CLEtBQUtyQyxLQUFMLENBQVdLLE1BQS9CO0FBQ0gsR0E3Rkk7QUE4RkxnQyxFQUFBQSxjQTlGSywwQkE4RlVDLFFBOUZWLEVBOEZvQjtBQUNyQixRQUFJQSxRQUFRLElBQUlDLFNBQWhCLEVBQ0lELFFBQVEsR0FBRyxpQkFBWDtBQUNKLFNBQUtqRSxXQUFMLENBQWlCaUMsTUFBakIsR0FBMEIsSUFBMUI7QUFDQSxTQUFLL0IsU0FBTCxDQUFlc0IsSUFBZixDQUFvQlMsTUFBcEIsR0FBNkIsQ0FBQyxLQUFLekIsUUFBbkM7QUFDQSxTQUFLSCxLQUFMLENBQVcrQixNQUFYLEdBQW9CLHFCQUFtQjZCLFFBQXZDO0FBQ0EsU0FBSzlELFVBQUwsQ0FBZ0JpQyxNQUFoQixHQUF5QixLQUFLOUMsWUFBTCxDQUFrQjhDLE1BQTNDO0FBQ0EsU0FBS2hDLE1BQUwsQ0FBWWdDLE1BQVosR0FBeUJDLEtBQUssQ0FBQ0MsY0FBTixDQUFxQixLQUFLN0MsVUFBTCxDQUFnQjJDLE1BQXJDLElBQStDLE9BQXhFO0FBQ0gsR0F0R0k7QUF1R0wrQixFQUFBQSxlQXZHSyw2QkF1R2E7QUFDZCxTQUFLQyxJQUFMLENBQVUsU0FBVixFQUFxQjtBQUFDQyxNQUFBQSxHQUFHLEVBQUUsSUFBTjtBQUFZQyxNQUFBQSxHQUFHLEVBQUU7QUFBakIsS0FBckI7QUFDSCxHQXpHSTtBQTBHTEMsRUFBQUEsZUExR0ssNkJBMEdhO0FBQ2QsUUFBSyxLQUFLakUsS0FBTCxJQUFjLElBQW5CLEVBQ0ksS0FBS3VCLFdBQUwsQ0FBaUIsSUFBakIsRUFESixLQUdJLEtBQUtBLFdBQUwsQ0FBaUIsSUFBakI7QUFDSixTQUFLdkIsS0FBTCxHQUFhLEtBQUs0QixXQUFMLEVBQWI7QUFDQSxTQUFLQyxVQUFMO0FBQ0EsU0FBS2UsV0FBTCxDQUFpQixLQUFLekQsVUFBTCxDQUFnQjJDLE1BQWpDO0FBQ0gsR0FsSEk7QUFtSExQLEVBQUFBLFdBbkhLLHVCQW1IT0MsSUFuSFAsRUFtSGE7QUFDZCxRQUFJMEMsWUFBWSxHQUFHdEYsRUFBRSxDQUFDdUYsR0FBSCxDQUFPRCxZQUExQjtBQUNBQSxJQUFBQSxZQUFZLENBQUNFLE9BQWIsQ0FBcUIsV0FBckIsRUFBa0M1QyxJQUFsQztBQUNILEdBdEhJO0FBdUhMSSxFQUFBQSxXQXZISyx5QkF1SFM7QUFDVixRQUFJc0MsWUFBWSxHQUFHdEYsRUFBRSxDQUFDdUYsR0FBSCxDQUFPRCxZQUExQjs7QUFDQSxRQUFJQSxZQUFZLENBQUNHLE9BQWIsQ0FBcUIsV0FBckIsTUFBc0MsSUFBdEMsSUFBOENILFlBQVksQ0FBQ0csT0FBYixDQUFxQixXQUFyQixNQUFzQ1QsU0FBeEYsRUFBbUc7QUFDL0ZNLE1BQUFBLFlBQVksQ0FBQ0UsT0FBYixDQUFxQixXQUFyQixFQUFrQyxJQUFsQztBQUNIOztBQUNELFdBQU9GLFlBQVksQ0FBQ0csT0FBYixDQUFxQixXQUFyQixDQUFQO0FBQ0gsR0E3SEk7QUE4SExDLEVBQUFBLFVBOUhLLHdCQThIUTtBQUNULFFBQUl6RCxPQUFPLEdBQUcsSUFBSUMsYUFBYSxDQUFDeUQsb0JBQWxCLEVBQWQ7QUFDQTFELElBQUFBLE9BQU8sQ0FBQzJELGdCQUFSLENBQXlCZixRQUFRLENBQUMsS0FBS3RFLFVBQUwsQ0FBZ0IyQyxNQUFqQixDQUFqQztBQUNBakIsSUFBQUEsT0FBTyxDQUFDNEQsY0FBUixDQUF1QixLQUFLekYsWUFBTCxDQUFrQjhDLE1BQXpDO0FBQ0F6QixJQUFBQSxXQUFXLENBQUNDLGdCQUFaLENBQTZCQyxZQUE3QixDQUEwQ1MsSUFBMUMsQ0FBK0NILE9BQU8sQ0FBQ0ksVUFBUixFQUEvQztBQUNBc0IsSUFBQUEsRUFBRSxDQUFDQyxPQUFILENBQVdzQixJQUFYO0FBQ0EsU0FBS1ksV0FBTDtBQUNILEdBcklJO0FBc0lMQSxFQUFBQSxXQXRJSyx5QkFzSVM7QUFDVixTQUFLaEYsV0FBTCxDQUFpQmlDLE1BQWpCLEdBQTBCLEtBQTFCO0FBQ0gsR0F4SUk7QUF5SUxnRCxFQUFBQSxpQkF6SUssK0JBeUllO0FBQ2hCLFNBQUt6RSxRQUFMLEdBQWdCLEtBQWhCO0FBQ0EsUUFBSTBFLFFBQVEsR0FBRyxLQUFLNUYsWUFBTCxDQUFrQjhDLE1BQWpDOztBQUNBLFFBQUksS0FBSzNCLFNBQUwsQ0FBZTBFLE1BQWYsR0FBd0IsQ0FBNUIsRUFBOEI7QUFDMUIsV0FBSyxJQUFJQyxDQUFDLEdBQUMsQ0FBWCxFQUFjQSxDQUFDLEdBQUUsS0FBSzNFLFNBQUwsQ0FBZTBFLE1BQWhDLEVBQXdDQyxDQUFDLEVBQXpDLEVBQTRDO0FBQ3hDLFlBQUlGLFFBQVEsSUFBSSxLQUFLekUsU0FBTCxDQUFlMkUsQ0FBZixFQUFrQkMsSUFBbEMsRUFBdUM7QUFDbkMsZUFBSzdFLFFBQUwsR0FBZ0IsSUFBaEI7QUFDQSxlQUFLRixLQUFMLEdBQWEsS0FBS0csU0FBTCxDQUFlMkUsQ0FBZixFQUFrQkUsSUFBL0I7QUFDQSxlQUFLdkQsZUFBTCxDQUFxQixLQUFLdEIsU0FBTCxDQUFlMkUsQ0FBZixFQUFrQkMsSUFBdkMsRUFBNkMsS0FBSzVFLFNBQUwsQ0FBZTJFLENBQWYsRUFBa0JwRCxNQUEvRDtBQUNBLGVBQUtHLFVBQUw7QUFDQSxlQUFLdkMsU0FBTCxDQUFld0MsTUFBZixHQUF3QkMsS0FBSyxDQUFDQyxjQUFOLENBQXFCQyxhQUFhLENBQUNDLE9BQWQsQ0FBc0I3QixXQUFXLENBQUNDLGdCQUFaLENBQTZCQyxZQUE3QixDQUEwQzRCLE1BQWhFLENBQXJCLENBQXhCO0FBQXNIO0FBRXpIO0FBQ0o7QUFDSjtBQUNKO0FBeEpJLENBQVQiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLlZvekJhc2VDb21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGVkaXRfdXNlcl9yZTogY2MuRWRpdEJveCxcclxuICAgICAgICBlZGl0X3VzZXJfcmVfYWdhaW46IGNjLkVkaXRCb3gsXHJcbiAgICAgICAgZWRpdF9tb25leTogY2MuRWRpdEJveCxcclxuICAgICAgICBsYlR5TGU6IGNjLkxhYmVsLFxyXG4gICAgICAgIGxiTXlNb25leTogY2MuTGFiZWwsXHJcbiAgICAgICAgbGJNb25leVJldjogY2MuTGFiZWwsXHJcbiAgICAgICAgbGJUaWVuVGU6IGNjLkxhYmVsLFxyXG4gICAgICAgIGxiRGVzVHJhbnM6IGNjLkxhYmVsLFxyXG4gICAgICAgIHdhcm5pbmdOb2RlOiBjYy5Ob2RlLFxyXG4gICAgICAgIGxiSXNEYWlMeTogY2MuTGFiZWwsXHJcbiAgICAgICAgbGJOaWNrTmFtZTogY2MuTGFiZWwsXHJcbiAgICAgICAgbGJHb2xkOiBjYy5MYWJlbCxcclxuICAgICAgICBsYkRlczogY2MuTGFiZWwsXHJcbiAgICAgICAgX2FyZWE6IFwiamFcIixcclxuICAgICAgICBfbW9uZXlDb252ZXJ0OiAwLFxyXG4gICAgICAgIF9pc0RhaUx5OiBmYWxzZSxcclxuICAgICAgICBsaXN0RGFpTHk6IFtdXHJcbiAgICB9LFxyXG4gICAgb25FbmFibGUoKXtcclxuICAgICAgICB0aGlzLmxpc3REYWlMeSA9IFtdO1xyXG4gICAgICAgIFNtYXJ0Rm94U0RLLlBvcnRhbENvbnRyb2xsZXIuWm9uZUluc3RhbmNlLmFkZEV2ZW50TGlzdGVuZXJFeHRlbnNpb24oQ2FzaW5vRXZlbnQuUkVTUE9OU0VfTkFNRS5MSVNUX0FHRU5DWV9SRVMsIHRoaXMub25MaXN0QWdlbmN5LCB0aGlzKTtcclxuICAgICAgICBsZXQgcmVxdWVzdCA9IG5ldyBDYXNpbm9SZXF1ZXN0Lkxpc3RBZ2VuY3lSZXF1ZXN0KCk7XHJcbiAgICAgICAgU21hcnRGb3hTREsuUG9ydGFsQ29udHJvbGxlci5ab25lSW5zdGFuY2Uuc2VuZChyZXF1ZXN0LnRvU1JlcXVlc3QoKSk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLm5vZGUuekluZGV4IDw9IGNjLmxhc3RaSW5kZXgpe1xyXG4gICAgICAgICAgICB0aGlzLm5vZGUuekluZGV4ID0gY2MubGFzdFpJbmRleCsxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5fZGF0YS5uaWNrbmFtZSAhPSBudWxsKXtcclxuICAgICAgICAgICAgdGhpcy5zZXRMYXN0QXJlYSh0aGlzLl9kYXRhLmFyZWEpO1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZURhaUx5SW5mbyh0aGlzLl9kYXRhLm5pY2tuYW1lLCB0aGlzLl9kYXRhLmFnTmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMud2FybmluZ05vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fYXJlYSA9IHRoaXMuZ2V0TGFzdEFyZWEoKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZVR5TGUoKTtcclxuICAgICAgICB0aGlzLmxiTXlNb25leS5zdHJpbmcgPSBVdGlscy5hZGREb3RUb051bWJlcihHYW1lVmFyaWFibGVzLmdldENoaXAoU21hcnRGb3hTREsuUG9ydGFsQ29udHJvbGxlci5ab25lSW5zdGFuY2UubXlTZWxmKSk7O1xyXG4gICAgfSxcclxuICAgIG9uRGlzYWJsZSgpe1xyXG4gICAgICAgIFNtYXJ0Rm94U0RLLlBvcnRhbENvbnRyb2xsZXIuWm9uZUluc3RhbmNlLnJlbW92ZUV2ZW50TGlzdGVuZXJFeHRlbnNpb24oQ2FzaW5vRXZlbnQuUkVTUE9OU0VfTkFNRS5MSVNUX0FHRU5DWV9SRVMsIHRoaXMub25MaXN0QWdlbmN5LCB0aGlzKTtcclxuICAgIH0sXHJcbiAgICBvbkxpc3RBZ2VuY3koZXZlbnQpe1xyXG4gICAgICAgIG1tLkxvYWRpbmcuaGlkZSgpO1xyXG4gICAgICAgIHRoaXMubGlzdERhaUx5ID0gbmV3IENhc2lub0V2ZW50Lkxpc3RBZ2VuY3lFdmVudCgpLmZyb21FdmVudChldmVudCk7XHJcbiAgICB9LFxyXG4gICAgY2hhbmdlTW9uZXkoZWRpdEJveCkge1xyXG4gICAgICAgIGlmIChlZGl0Qm94ID09IFwiXCIpXHJcbiAgICAgICAgICAgIHRoaXMubGJNb25leVJldi5zdHJpbmcgPSBcIjBcIjtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHRoaXMubGJNb25leVJldi5zdHJpbmcgPSBVdGlscy5hZGREb3RUb051bWJlcihNYXRoLmZsb29yKHBhcnNlRmxvYXQoZWRpdEJveCkpL3RoaXMuX21vbmV5Q29udmVydCk7XHJcbiAgICB9LFxyXG4gICAgZXZlbnRDbG9zZSgpe1xyXG4gICAgICAgIHRoaXMuYmFjaygpO1xyXG4gICAgICAgIG1tLmF1ZGlvLnBsYXlCdXR0b24oKTtcclxuICAgIH0sXHJcbiAgICB1cGRhdGVEYWlMeUluZm8odXNlcm5hbWUsIGFnTmFtZSkge1xyXG4gICAgICAgIHRoaXMuZWRpdF91c2VyX3JlLnN0cmluZyAgICAgICAgPSB1c2VybmFtZTtcclxuICAgICAgICB0aGlzLmVkaXRfdXNlcl9yZV9hZ2Fpbi5zdHJpbmcgID0gdXNlcm5hbWU7XHJcbiAgICAgICAgdGhpcy5sYkRlc1RyYW5zLnN0cmluZyAgPSBcIkLDoW4gR09MRCBjaG8gXCIrYWdOYW1lO1xyXG4gICAgICAgIHRoaXMuX2RhdGEuYWdOYW1lID0gYWdOYW1lO1xyXG4gICAgfSxcclxuICAgIHVwZGF0ZVR5TGUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2FyZWEgPT0gXCJqYVwiKXtcclxuICAgICAgICAgICAgdGhpcy5sYlR5TGUuc3RyaW5nICAgPSBcIlThu4kgbOG7hyBxdXkgxJHhu5VpOiAxWUVOID0gMjI2LjhcIjtcclxuICAgICAgICAgICAgdGhpcy5sYlRpZW5UZS5zdHJpbmcgPSBcIllFTlwiO1xyXG4gICAgICAgICAgICB0aGlzLl9tb25leUNvbnZlcnQgICA9ICAyMjYuODtcclxuICAgICAgICB9ZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubGJUeUxlLnN0cmluZyA9IFwiVOG7iSBs4buHIHF1eSDEkeG7lWk6IDFXT04gPSAyMC41MlwiO1xyXG4gICAgICAgICAgICB0aGlzLmxiVGllblRlLnN0cmluZyA9IFwiV09OXCI7XHJcbiAgICAgICAgICAgIHRoaXMuX21vbmV5Q29udmVydCAgID0gMjAuNTI7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGNsaWNrVHJhbnNmZXJNb25leShldmVudCl7XHJcbiAgICAgICAgbW0uYXVkaW8ucGxheUJ1dHRvbigpO1xyXG4gICAgICAgIGlmKHRoaXMuZWRpdF91c2VyX3JlLnN0cmluZyA9PSBcIlwiKXtcclxuICAgICAgICAgICAgbW0uVG9hc3Quc2hvd1RvYXN0KDEsIFwiVMOqbiBuZ8aw4budaSBuaOG6rW4ga2jDtG5nIMSRxrDhu6NjIHRy4buRbmdcIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gaWYodGhpcy5lZGl0X3VzZXJfcmUuc3RyaW5nICE9IHRoaXMuZWRpdF91c2VyX3JlX2FnYWluLnN0cmluZyl7XHJcbiAgICAgICAgLy8gICAgIG1tLlRvYXN0LnNob3dUb2FzdCgxLCBcIk5pY2tuYW1lIGtow7RuZyBraOG7m3BcIik7XHJcbiAgICAgICAgLy8gICAgIHJldHVybjtcclxuICAgICAgICAvLyB9XHJcbiAgICAgICAgaWYodGhpcy5lZGl0X21vbmV5LnN0cmluZyA9PSBcIlwiKXtcclxuICAgICAgICAgICAgbW0uVG9hc3Quc2hvd1RvYXN0KDEsIFwiVGnhu4FuIGtow7RuZyDEkcaw4bujYyB0cuG7kW5nXCIpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHBhcnNlSW50KHRoaXMuZWRpdF9tb25leS5zdHJpbmcpIDwgMTAwMDApe1xyXG4gICAgICAgICAgICBtbS5Ub2FzdC5zaG93VG9hc3QoMSwgXCJUaeG7gW4gcGjhuqNpIGzhu5tuIGjGoW4gMTAuMDAwXCIpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2hvd0luZm9XYXJpbmcodGhpcy5fZGF0YS5hZ05hbWUpO1xyXG4gICAgfSxcclxuICAgIHNob3dJbmZvV2FyaW5nKGFnZW5OYW1lKSB7XHJcbiAgICAgICAgaWYgKGFnZW5OYW1lID09IHVuZGVmaW5lZClcclxuICAgICAgICAgICAgYWdlbk5hbWUgPSBcIktow7RuZyB4w6FjIMSR4buLbmghXCI7XHJcbiAgICAgICAgdGhpcy53YXJuaW5nTm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMubGJJc0RhaUx5Lm5vZGUuYWN0aXZlID0gIXRoaXMuX2lzRGFpTHk7XHJcbiAgICAgICAgdGhpcy5sYkRlcy5zdHJpbmcgPSBcIkNodXnDqm4gR09MRCBjaG8gXCIrYWdlbk5hbWU7XHJcbiAgICAgICAgdGhpcy5sYk5pY2tOYW1lLnN0cmluZyA9IHRoaXMuZWRpdF91c2VyX3JlLnN0cmluZztcclxuICAgICAgICB0aGlzLmxiR29sZC5zdHJpbmcgICAgID0gVXRpbHMuYWRkRG90VG9OdW1iZXIodGhpcy5lZGl0X21vbmV5LnN0cmluZykgKyBcIiBHT0xEXCI7XHJcbiAgICB9LFxyXG4gICAgZXZlbnRTaG93RGFpTHlzKCkge1xyXG4gICAgICAgIHRoaXMuc2hvdyhcIlVJRGFpTHlcIiwge3BvcDogdHJ1ZSwgc3JjOiAncG9ydGFsJ30pO1xyXG4gICAgfSxcclxuICAgIGV2ZW50Q2hhbmdlQXJlYSgpIHtcclxuICAgICAgICBpZiAoIHRoaXMuX2FyZWEgPT0gXCJqYVwiKVxyXG4gICAgICAgICAgICB0aGlzLnNldExhc3RBcmVhKFwia29cIik7XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB0aGlzLnNldExhc3RBcmVhKFwiamFcIik7XHJcbiAgICAgICAgdGhpcy5fYXJlYSA9IHRoaXMuZ2V0TGFzdEFyZWEoKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZVR5TGUoKTtcclxuICAgICAgICB0aGlzLmNoYW5nZU1vbmV5KHRoaXMuZWRpdF9tb25leS5zdHJpbmcpO1xyXG4gICAgfSxcclxuICAgIHNldExhc3RBcmVhKGFyZWEpIHtcclxuICAgICAgICB2YXIgbG9jYWxTdG9yYWdlID0gY2Muc3lzLmxvY2FsU3RvcmFnZTtcclxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImxhc3RfYXJlYVwiLCBhcmVhKTtcclxuICAgIH0sXHJcbiAgICBnZXRMYXN0QXJlYSgpIHtcclxuICAgICAgICBsZXQgbG9jYWxTdG9yYWdlID0gY2Muc3lzLmxvY2FsU3RvcmFnZTtcclxuICAgICAgICBpZiAobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJsYXN0X2FyZWFcIikgPT09IG51bGwgfHwgbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJsYXN0X2FyZWFcIikgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImxhc3RfYXJlYVwiLCBcImphXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJsYXN0X2FyZWFcIik7XHJcbiAgICB9LFxyXG4gICAgZXZlbnREb25nWSgpIHtcclxuICAgICAgICBsZXQgcmVxdWVzdCA9IG5ldyBDYXNpbm9SZXF1ZXN0LlRyYW5zZmVyTW9uZXlSZXF1ZXN0KCk7XHJcbiAgICAgICAgcmVxdWVzdC5zZXRNb25leVRyYW5zZmVyKHBhcnNlSW50KHRoaXMuZWRpdF9tb25leS5zdHJpbmcpKTtcclxuICAgICAgICByZXF1ZXN0LnNldFVzZXJSZWNpdmVkKHRoaXMuZWRpdF91c2VyX3JlLnN0cmluZyk7XHJcbiAgICAgICAgU21hcnRGb3hTREsuUG9ydGFsQ29udHJvbGxlci5ab25lSW5zdGFuY2Uuc2VuZChyZXF1ZXN0LnRvU1JlcXVlc3QoKSk7XHJcbiAgICAgICAgbW0uTG9hZGluZy5zaG93KCk7XHJcbiAgICAgICAgdGhpcy5ldmVudENhbmNlbCgpO1xyXG4gICAgfSxcclxuICAgIGV2ZW50Q2FuY2VsKCkge1xyXG4gICAgICAgIHRoaXMud2FybmluZ05vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgZXZlbnRHZXRJbmZvRGFpTHkoKSB7XHJcbiAgICAgICAgdGhpcy5faXNEYWlMeSA9IGZhbHNlO1xyXG4gICAgICAgIGxldCBuaWNrTmFtZSA9IHRoaXMuZWRpdF91c2VyX3JlLnN0cmluZztcclxuICAgICAgICBpZiAodGhpcy5saXN0RGFpTHkubGVuZ3RoID4gMCl7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGk9MDsgaTwgdGhpcy5saXN0RGFpTHkubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICAgICAgaWYgKG5pY2tOYW1lID09IHRoaXMubGlzdERhaUx5W2ldLm5hbWUpe1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2lzRGFpTHkgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FyZWEgPSB0aGlzLmxpc3REYWlMeVtpXS56b25lO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRGFpTHlJbmZvKHRoaXMubGlzdERhaUx5W2ldLm5hbWUsIHRoaXMubGlzdERhaUx5W2ldLmFnTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVUeUxlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYk15TW9uZXkuc3RyaW5nID0gVXRpbHMuYWRkRG90VG9OdW1iZXIoR2FtZVZhcmlhYmxlcy5nZXRDaGlwKFNtYXJ0Rm94U0RLLlBvcnRhbENvbnRyb2xsZXIuWm9uZUluc3RhbmNlLm15U2VsZikpOztcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59KTtcclxuIl19