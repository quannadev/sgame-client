
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/kimcuong/KimCuongWinGame.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '48f05ZuHIZHeI3pfLCV5Lqt', 'KimCuongWinGame');
// scripts/kimcuong/KimCuongWinGame.js

"use strict";

var self;

var Helper = require("Helper");

cc.Class({
  "extends": cc.VozBaseComponent,
  properties: {
    lbMoneyWin: cc.Label,
    BonusFreeSpine: cc.Node,
    KimCuongNoHuCoin: cc.Node,
    KimCuongThangText: cc.Node,
    KimCuongThangLonCoin: cc.Node,
    FreeCount: cc.Node,
    NumberFreeSpine: cc.Node
  },
  onLoad: function onLoad() {
    self = this;
  },
  init: function init(obj) {
    this.KCV = obj;
  },
  runWinGame: function runWinGame() {
    var bgAll = this.node.getChildByName("bg_all");
    bgAll.active = true;

    if (this.KCV.isThangLon && !this.KCV.isNoHu) {
      this.KCV.playBigWin();
      this.runKimCuongThangLon();
    } else if (this.KCV.isNoHu) {
      this.KCV.playJackpot();
      this.runKimCuongNoHu();
    } else if (this.KCV.isFree) {
      this.runFreeSpine();
    } else if (this.KCV.isBonus) {
      this.KCV.playBonus();
      this.runBonusSpine();
    } else {
      console.log("updateFreeSpin");
      self.KCV.setMoneyWin(self.KCV.winMoney);
      self.updateFreeSpin();

      if (this.KCV.winMoney > 0) {
        this.KCV.playSpinWin();
        this.lbMoneyWin.node.active = true;
        Helper.numberTo(this.lbMoneyWin, 0, this.KCV.winMoney, 1200, true, function () {
          self.scheduleOnce(function () {
            self.lbMoneyWin.node.active = false;
            bgAll.active = false;
            self.KCV.autoQuay();
          }, 1);
        });
        this.KCV.winMoney = 0;
      } else {
        bgAll.active = false;
        self.KCV.autoQuay();
      }
    }

    if (this.KCV.type == 0) this.KCV.playSpinMis();
  },
  updateFreeSpin: function updateFreeSpin() {
    if (this.KCV.freeSpin < 1) this.FreeCount.active = false;else {
      this.FreeCount.active = true;
      self.FreeCount.getChildByName("lb_free_spine_count").getComponent(cc.Label).string = self.KCV.freeSpin;
    }
  },
  checkRunAgainWin: function checkRunAgainWin() {
    if (this.KCV.isBonus || this.KCV.winMoney > 0 || this.KCV.isFree || this.KCV.isNoHu || this.KCV.isThangLon || this.KCV.isAuto) this.runWinGame();
  },
  runFreeSpine: function runFreeSpine() {
    this.KCV.isFree = false;
    this.BonusFreeSpine.active = true;
    this.NumberFreeSpine.active = true;
    this.BonusFreeSpine.getComponent(sp.Skeleton).setAnimation(0, 'FreeSpine', true);
    this.NumberFreeSpine.getChildByName("lb_number_free_spine").getComponent(cc.Label).string = this.KCV.freeSpin;
    this.scheduleOnce(function () {
      self.node.getChildByName("bg_all").active = false;
      self.BonusFreeSpine.active = false;
      self.NumberFreeSpine.active = false;
      self.FreeCount.active = true;
      self.FreeCount.getChildByName("lb_free_spine_count").getComponent(cc.Label).string = self.KCV.freeSpin;
      this.checkRunAgainWin();
    }, 3);
  },
  runBonusSpine: function runBonusSpine() {
    this.KCV.isBonus = false;
    this.BonusFreeSpine.active = true;
    this.NumberFreeSpine.active = false;
    this.BonusFreeSpine.getComponent(sp.Skeleton).setAnimation(0, 'Bonusgame', true);
    this.scheduleOnce(function () {
      self.BonusFreeSpine.active = false;
      self.show("UIKimCuongBonusGame", {
        src: 'kimcuong',
        pop: true,
        data: self.KCV.freeGift
      });
    }, 2);
  },
  runKimCuongNoHu: function runKimCuongNoHu() {
    this.KCV.isNoHu = false;
    this.KimCuongNoHuCoin.active = true;
    this.KimCuongThangText.active = true;
    this.KimCuongThangText.getComponent(sp.Skeleton).setAnimation(0, "NoHu", true);
    var lbMoney = self.node.getChildByName("lb_number_win");
    lbMoney.setPosition(cc.v2(0, -160));
    lbMoney.active = true;
    Helper.numberTo(lbMoney.getComponent(cc.Label), 0, this.KCV.winMoney, 1200, true, function () {
      self.scheduleOnce(function () {
        var d = cc.moveTo(0.5, cc.v2(0, 50));
        lbMoney.runAction(cc.sequence(d, cc.delayTime(1), cc.callFunc(function () {
          self.node.getChildByName("bg_all").active = false;
          self.KimCuongNoHuCoin.active = false;
          self.KimCuongThangText.active = false;
          lbMoney.active = false;
          self.checkRunAgainWin();
        })));
      }, 5);
    });
  },
  runKimCuongThangLon: function runKimCuongThangLon() {
    this.KCV.isThangLon = false;
    this.KimCuongThangLonCoin.active = true;
    this.KimCuongThangText.active = true;
    this.KimCuongThangText.getComponent(sp.Skeleton).setAnimation(0, "ThangLon", true);
    var lbMoney = self.node.getChildByName("lb_number_win");
    lbMoney.setPosition(cc.v2(0, -100));
    lbMoney.active = true;
    Helper.numberTo(lbMoney.getComponent(cc.Label), 0, this.KCV.winMoney, 1200, true, function () {
      self.scheduleOnce(function () {
        var d = cc.moveTo(0.5, cc.v2(0, 50));
        lbMoney.runAction(cc.sequence(d, cc.delayTime(0.5), cc.callFunc(function () {
          lbMoney.active = false;
          self.node.getChildByName("bg_all").active = false;
          self.KimCuongThangLonCoin.active = false;
          self.KimCuongThangText.active = false;
          self.checkRunAgainWin();
        })));
      }, 3);
    });
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xca2ltY3VvbmdcXEtpbUN1b25nV2luR2FtZS5qcyJdLCJuYW1lcyI6WyJzZWxmIiwiSGVscGVyIiwicmVxdWlyZSIsImNjIiwiQ2xhc3MiLCJWb3pCYXNlQ29tcG9uZW50IiwicHJvcGVydGllcyIsImxiTW9uZXlXaW4iLCJMYWJlbCIsIkJvbnVzRnJlZVNwaW5lIiwiTm9kZSIsIktpbUN1b25nTm9IdUNvaW4iLCJLaW1DdW9uZ1RoYW5nVGV4dCIsIktpbUN1b25nVGhhbmdMb25Db2luIiwiRnJlZUNvdW50IiwiTnVtYmVyRnJlZVNwaW5lIiwib25Mb2FkIiwiaW5pdCIsIm9iaiIsIktDViIsInJ1bldpbkdhbWUiLCJiZ0FsbCIsIm5vZGUiLCJnZXRDaGlsZEJ5TmFtZSIsImFjdGl2ZSIsImlzVGhhbmdMb24iLCJpc05vSHUiLCJwbGF5QmlnV2luIiwicnVuS2ltQ3VvbmdUaGFuZ0xvbiIsInBsYXlKYWNrcG90IiwicnVuS2ltQ3VvbmdOb0h1IiwiaXNGcmVlIiwicnVuRnJlZVNwaW5lIiwiaXNCb251cyIsInBsYXlCb251cyIsInJ1bkJvbnVzU3BpbmUiLCJjb25zb2xlIiwibG9nIiwic2V0TW9uZXlXaW4iLCJ3aW5Nb25leSIsInVwZGF0ZUZyZWVTcGluIiwicGxheVNwaW5XaW4iLCJudW1iZXJUbyIsInNjaGVkdWxlT25jZSIsImF1dG9RdWF5IiwidHlwZSIsInBsYXlTcGluTWlzIiwiZnJlZVNwaW4iLCJnZXRDb21wb25lbnQiLCJzdHJpbmciLCJjaGVja1J1bkFnYWluV2luIiwiaXNBdXRvIiwic3AiLCJTa2VsZXRvbiIsInNldEFuaW1hdGlvbiIsInNob3ciLCJzcmMiLCJwb3AiLCJkYXRhIiwiZnJlZUdpZnQiLCJsYk1vbmV5Iiwic2V0UG9zaXRpb24iLCJ2MiIsImQiLCJtb3ZlVG8iLCJydW5BY3Rpb24iLCJzZXF1ZW5jZSIsImRlbGF5VGltZSIsImNhbGxGdW5jIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7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U0csQ0FUSDtBQVVILEtBWEQ7QUFZSDtBQXRJSSxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgc2VsZjtcclxubGV0IEhlbHBlciA9IHJlcXVpcmUoXCJIZWxwZXJcIik7XHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLlZvekJhc2VDb21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGxiTW9uZXlXaW4gICAgICAgICAgOiBjYy5MYWJlbCxcclxuICAgICAgICBCb251c0ZyZWVTcGluZSAgICAgIDogY2MuTm9kZSxcclxuICAgICAgICBLaW1DdW9uZ05vSHVDb2luICAgIDogY2MuTm9kZSxcclxuICAgICAgICBLaW1DdW9uZ1RoYW5nVGV4dCAgIDogY2MuTm9kZSxcclxuICAgICAgICBLaW1DdW9uZ1RoYW5nTG9uQ29pbjogY2MuTm9kZSxcclxuICAgICAgICBGcmVlQ291bnQgICAgICAgICAgIDogY2MuTm9kZSxcclxuICAgICAgICBOdW1iZXJGcmVlU3BpbmUgICAgIDogY2MuTm9kZSxcclxuICAgIH0sXHJcblxyXG4gICAgb25Mb2FkICgpIHtcclxuICAgICAgICBzZWxmID0gdGhpcztcclxuICAgIH0sXHJcbiAgICBpbml0KG9iaikge1xyXG4gICAgICAgIHRoaXMuS0NWID0gb2JqO1xyXG4gICAgfSxcclxuICAgIHJ1bldpbkdhbWUoKSB7XHJcbiAgICAgICAgbGV0IGJnQWxsICAgICA9IHRoaXMubm9kZS5nZXRDaGlsZEJ5TmFtZShcImJnX2FsbFwiKTtcclxuICAgICAgICBiZ0FsbC5hY3RpdmUgID0gdHJ1ZTtcclxuICAgICAgICBpZiAodGhpcy5LQ1YuaXNUaGFuZ0xvbiAmJiAhdGhpcy5LQ1YuaXNOb0h1KSB7XHJcbiAgICAgICAgICAgIHRoaXMuS0NWLnBsYXlCaWdXaW4oKTtcclxuICAgICAgICAgICB0aGlzLnJ1bktpbUN1b25nVGhhbmdMb24oKTtcclxuICAgICAgICB9ZWxzZSBpZiAodGhpcy5LQ1YuaXNOb0h1KXtcclxuICAgICAgICAgICAgdGhpcy5LQ1YucGxheUphY2twb3QoKTtcclxuICAgICAgICAgICAgdGhpcy5ydW5LaW1DdW9uZ05vSHUoKTtcclxuICAgICAgICB9ZWxzZSBpZiAodGhpcy5LQ1YuaXNGcmVlKXtcclxuICAgICAgICAgICAgdGhpcy5ydW5GcmVlU3BpbmUoKTtcclxuICAgICAgICB9ZWxzZSBpZiAodGhpcy5LQ1YuaXNCb251cyl7XHJcbiAgICAgICAgICAgIHRoaXMuS0NWLnBsYXlCb251cygpO1xyXG4gICAgICAgICAgICB0aGlzLnJ1bkJvbnVzU3BpbmUoKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1cGRhdGVGcmVlU3BpblwiKVxyXG4gICAgICAgICAgICBzZWxmLktDVi5zZXRNb25leVdpbihzZWxmLktDVi53aW5Nb25leSk7XHJcbiAgICAgICAgICAgIHNlbGYudXBkYXRlRnJlZVNwaW4oKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuS0NWLndpbk1vbmV5ID4gMCl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLktDVi5wbGF5U3BpbldpbigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sYk1vbmV5V2luLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIEhlbHBlci5udW1iZXJUbyh0aGlzLmxiTW9uZXlXaW4sIDAsIHRoaXMuS0NWLndpbk1vbmV5LCAxMjAwLCB0cnVlLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5sYk1vbmV5V2luLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJnQWxsLmFjdGl2ZSAgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5LQ1YuYXV0b1F1YXkoKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAxKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5LQ1Yud2luTW9uZXkgICA9IDA7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgYmdBbGwuYWN0aXZlICA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgc2VsZi5LQ1YuYXV0b1F1YXkoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5LQ1YudHlwZSA9PSAwKVxyXG4gICAgICAgICAgICB0aGlzLktDVi5wbGF5U3Bpbk1pcygpO1xyXG4gICAgfSxcclxuICAgIHVwZGF0ZUZyZWVTcGluKCkge1xyXG4gICAgICAgIGlmICh0aGlzLktDVi5mcmVlU3BpbiA8IDEpXHJcbiAgICAgICAgICAgIHRoaXMuRnJlZUNvdW50LmFjdGl2ZSAgICAgICA9IGZhbHNlO1xyXG4gICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuRnJlZUNvdW50LmFjdGl2ZSAgICAgICA9IHRydWU7XHJcbiAgICAgICAgICAgIHNlbGYuRnJlZUNvdW50LmdldENoaWxkQnlOYW1lKFwibGJfZnJlZV9zcGluZV9jb3VudFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IHNlbGYuS0NWLmZyZWVTcGluO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBjaGVja1J1bkFnYWluV2luKCkge1xyXG4gICAgICAgIGlmICh0aGlzLktDVi5pc0JvbnVzIHx8IHRoaXMuS0NWLndpbk1vbmV5ID4gMCB8fCB0aGlzLktDVi5pc0ZyZWUgfHwgdGhpcy5LQ1YuaXNOb0h1IHx8IHRoaXMuS0NWLmlzVGhhbmdMb24gfHwgdGhpcy5LQ1YuaXNBdXRvKVxyXG4gICAgICAgICAgICB0aGlzLnJ1bldpbkdhbWUoKTtcclxuICAgIH0sXHJcbiAgICBydW5GcmVlU3BpbmUoKSB7XHJcbiAgICAgICAgdGhpcy5LQ1YuaXNGcmVlICAgICAgICAgICAgID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5Cb251c0ZyZWVTcGluZS5hY3RpdmUgID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLk51bWJlckZyZWVTcGluZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuQm9udXNGcmVlU3BpbmUuZ2V0Q29tcG9uZW50KHNwLlNrZWxldG9uKS5zZXRBbmltYXRpb24oMCwgJ0ZyZWVTcGluZScsIHRydWUpO1xyXG4gICAgICAgIHRoaXMuTnVtYmVyRnJlZVNwaW5lLmdldENoaWxkQnlOYW1lKFwibGJfbnVtYmVyX2ZyZWVfc3BpbmVcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSB0aGlzLktDVi5mcmVlU3BpbjtcclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBzZWxmLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJiZ19hbGxcIikuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHNlbGYuQm9udXNGcmVlU3BpbmUuYWN0aXZlICA9IGZhbHNlO1xyXG4gICAgICAgICAgICBzZWxmLk51bWJlckZyZWVTcGluZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgc2VsZi5GcmVlQ291bnQuYWN0aXZlICAgICAgID0gdHJ1ZTtcclxuICAgICAgICAgICAgc2VsZi5GcmVlQ291bnQuZ2V0Q2hpbGRCeU5hbWUoXCJsYl9mcmVlX3NwaW5lX2NvdW50XCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gc2VsZi5LQ1YuZnJlZVNwaW47XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tSdW5BZ2FpbldpbigpO1xyXG4gICAgICAgIH0sIDMpO1xyXG4gICAgfSxcclxuICAgIHJ1bkJvbnVzU3BpbmUoKSB7XHJcbiAgICAgICAgdGhpcy5LQ1YuaXNCb251cyAgICAgICAgICAgID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5Cb251c0ZyZWVTcGluZS5hY3RpdmUgID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLk51bWJlckZyZWVTcGluZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLkJvbnVzRnJlZVNwaW5lLmdldENvbXBvbmVudChzcC5Ta2VsZXRvbikuc2V0QW5pbWF0aW9uKDAsICdCb251c2dhbWUnLCB0cnVlKTtcclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBzZWxmLkJvbnVzRnJlZVNwaW5lLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBzZWxmLnNob3coXCJVSUtpbUN1b25nQm9udXNHYW1lXCIsIHtzcmM6ICdraW1jdW9uZycsIHBvcDogdHJ1ZSwgZGF0YTogc2VsZi5LQ1YuZnJlZUdpZnR9KTtcclxuICAgICAgICB9LCAyKTtcclxuICAgIH0sXHJcbiAgICBydW5LaW1DdW9uZ05vSHUoKXtcclxuICAgICAgICB0aGlzLktDVi5pc05vSHUgICAgICAgICAgICAgICA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuS2ltQ3VvbmdOb0h1Q29pbi5hY3RpdmUgID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLktpbUN1b25nVGhhbmdUZXh0LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5LaW1DdW9uZ1RoYW5nVGV4dC5nZXRDb21wb25lbnQoc3AuU2tlbGV0b24pLnNldEFuaW1hdGlvbigwLCBcIk5vSHVcIiwgdHJ1ZSk7XHJcbiAgICAgICAgbGV0IGxiTW9uZXkgPSBzZWxmLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJsYl9udW1iZXJfd2luXCIpO1xyXG4gICAgICAgIGxiTW9uZXkuc2V0UG9zaXRpb24oY2MudjIoMCwgLTE2MCkpO1xyXG4gICAgICAgIGxiTW9uZXkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBIZWxwZXIubnVtYmVyVG8obGJNb25leS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLCAwLCB0aGlzLktDVi53aW5Nb25leSwgMTIwMCwgdHJ1ZSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBzZWxmLnNjaGVkdWxlT25jZShmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgbGV0IGQgPSBjYy5tb3ZlVG8oMC41LCBjYy52MigwLCA1MCkpO1xyXG4gICAgICAgICAgICAgICAgbGJNb25leS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoZCwgY2MuZGVsYXlUaW1lKDEpLCBjYy5jYWxsRnVuYyhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmdldENoaWxkQnlOYW1lKFwiYmdfYWxsXCIpLmFjdGl2ZSAgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLktpbUN1b25nTm9IdUNvaW4uYWN0aXZlICA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuS2ltQ3VvbmdUaGFuZ1RleHQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgbGJNb25leS5hY3RpdmUgICAgICAgICAgICAgICAgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNoZWNrUnVuQWdhaW5XaW4oKTtcclxuICAgICAgICAgICAgICAgIH0pKSk7XHJcbiAgICAgICAgICAgIH0sIDUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIHJ1bktpbUN1b25nVGhhbmdMb24oKXtcclxuICAgICAgICB0aGlzLktDVi5pc1RoYW5nTG9uID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5LaW1DdW9uZ1RoYW5nTG9uQ29pbi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuS2ltQ3VvbmdUaGFuZ1RleHQuYWN0aXZlICAgID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLktpbUN1b25nVGhhbmdUZXh0LmdldENvbXBvbmVudChzcC5Ta2VsZXRvbikuc2V0QW5pbWF0aW9uKDAsIFwiVGhhbmdMb25cIiwgdHJ1ZSk7XHJcbiAgICAgICAgbGV0IGxiTW9uZXkgPSBzZWxmLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJsYl9udW1iZXJfd2luXCIpO1xyXG4gICAgICAgIGxiTW9uZXkuc2V0UG9zaXRpb24oY2MudjIoMCwgLTEwMCkpO1xyXG4gICAgICAgIGxiTW9uZXkuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICBIZWxwZXIubnVtYmVyVG8obGJNb25leS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLCAwLCB0aGlzLktDVi53aW5Nb25leSwgMTIwMCwgdHJ1ZSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBzZWxmLnNjaGVkdWxlT25jZShmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgbGV0IGQgPSBjYy5tb3ZlVG8oMC41LCBjYy52MigwLCA1MCkpO1xyXG4gICAgICAgICAgICAgICAgbGJNb25leS5ydW5BY3Rpb24oY2Muc2VxdWVuY2UoZCwgY2MuZGVsYXlUaW1lKDAuNSksIGNjLmNhbGxGdW5jKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBsYk1vbmV5LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5nZXRDaGlsZEJ5TmFtZShcImJnX2FsbFwiKS5hY3RpdmUgID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5LaW1DdW9uZ1RoYW5nTG9uQ29pbi5hY3RpdmUgICAgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLktpbUN1b25nVGhhbmdUZXh0LmFjdGl2ZSAgICAgICA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY2hlY2tSdW5BZ2FpbldpbigpO1xyXG4gICAgICAgICAgICAgICAgfSkpKTtcclxuICAgICAgICAgICAgfSwgMyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG59KTtcclxuIl19