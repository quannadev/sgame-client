
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/ui/UIHome.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'b61e3usURxALbVo2C8WDS0x', 'UIHome');
// scripts/ui/UIHome.js

"use strict";

cc.Class({
  "extends": cc.VozBaseComponent,
  properties: {
    TopHome: cc.Node,
    TopLogin: cc.Node,
    lb_name: cc.Label,
    lb_chip: cc.Label,
    Avatar: cc.Sprite,
    ALL: {
      type: cc.Node,
      "default": []
    },
    SLOT: {
      type: cc.Node,
      "default": []
    },
    MINI: {
      type: cc.Node,
      "default": []
    },
    CASINO: {
      type: cc.Node,
      "default": []
    }
  },
  onLoad: function onLoad() {
    Utils.loadRes(this.Avatar, "images/avatar/" + Config.getDefaultAvatar());
    MiniGame.showIcon();
    cc.isFirstTx = true;
  },
  onEnable: function onEnable() {
    if (mm.isLogin) {
      this.TopHome.active = true;
      this.TopLogin.active = false;
    } else {
      this.TopHome.active = false;
      this.TopLogin.active = true;
      this.resetAllGameUI();
    }

    mm.audio.playMusic();

    if (mm.isLogin && cc.isFirstTx) {
      cc.isFirstTx = false;
      var ui = this.getUIFromName("UITaiXiu");

      if (ui == null) {
        this._selectGame = "taixiu";
        this.completeLoadUIGame(this._selectGame);
      }
    }
  },
  updateUserVariable: function updateUserVariable(subChip) {
    if (SmartFoxSDK.PortalController.ZoneInstance.mySelf) {
      this.lb_name.string = Utils.formatText(GameVariables.Poker.getDisplayName(SmartFoxSDK.PortalController.ZoneInstance.mySelf), 20);
      this.lb_chip.string = Utils.addDotToNumber(GameVariables.Poker.getChip(SmartFoxSDK.PortalController.ZoneInstance.mySelf) - subChip);
      var msg = SmartFoxSDK.PortalController.ZoneInstance.mySelf.getVariable("sysmsg");

      if (msg && msg.value) {
        var SystemMessage = this.node.getChildByName("content").getChildByName("SystemMessage");
        var js = SystemMessage.getComponent(SystemMessage.name);
        js.runMessage(msg.value);
      }
    }
  },
  onSelectGame: function onSelectGame(event, game) {
    this._selectGame = game;
    cc._selectGameNode = event.currentTarget;
    this.onLoadSubGame();
    mm.audio.playButton();
  },
  onSelectTXGame: function onSelectTXGame(event, game) {
    var user = GameVariables.Poker.getDisplayName(SmartFoxSDK.PortalController.ZoneInstance.mySelf);
    var ret = cc["native"].reflection.callStaticMethod("CocosBridge", "openTXGame", "token", user);
  },
  onSelectXDGame: function onSelectXDGame(event, game) {
    var user = GameVariables.Poker.getDisplayName(SmartFoxSDK.PortalController.ZoneInstance.mySelf);
    var ret = cc["native"].reflection.callStaticMethod("CocosBridge", "openXDGame", "token", user);
  },
  onToggleCategoryGame: function onToggleCategoryGame(event) {
    mm.audio.playButton();

    if (event.node.name == 'All') {
      this._activeIconGame(this.ALL);
    } else if (event.node.name == 'Slot') {
      this._hideAllIconGame();

      this._activeIconGame(this.SLOT);
    } else if (event.node.name == 'MiniGame') {
      this._hideAllIconGame();

      this._activeIconGame(this.MINI);
    } else if (event.node.name == 'Casino') {
      this._hideAllIconGame();

      this._activeIconGame(this.CASINO);
    }
  },
  _hideAllIconGame: function _hideAllIconGame() {
    for (var i = 0; i < this.ALL.length; i++) {
      this.ALL[i].active = false;
    }
  },
  _activeIconGame: function _activeIconGame(list) {
    for (var i = 0; i < list.length; i++) {
      list[i].active = true;
    }
  },
  onLoadSubGame: function onLoadSubGame() {
    var game = this._selectGame;

    if (mm.isLogin) {
      cc._selectGameNode.getChildByName("load").active = true;
      mm.Loading.show();
      this.completeLoadUIGame(game);
    } else {
      this.show("UILogin", {
        pop: true
      });
    }
  },
  completeLoadUIGame: function completeLoadUIGame(game) {
    var gameController = PortalManager.getGameController(game);
    if (gameController) gameController.loginZone(Config.getUsername(), Config.getPass());
  },
  onClickLogin: function onClickLogin() {
    mm.audio.playButton();
    this.show("UILogin", {
      pop: true
    });
  },
  onClickRegister: function onClickRegister() {
    mm.audio.playButton();
    this.show("UIRegister", {
      pop: true
    });
  },
  eventShowWarning: function eventShowWarning() {
    var self = this;
    mm.audio.playButton();
    UIManger.show('UIDialogTwo', {
      data: {
        content: "Bạn có muốn đăng xuất không?",
        "cbYes": function cbYes() {
          self.TopHome.active = false;
          self.TopLogin.active = true;
          mm.isLogin = false;

          SmartFoxSDK.PortalController._reset();

          PortalManager.disconnectAll();
          self.resetAllGameUI();
        }
      },
      pop: true
    });
  },
  resetAllGameUI: function resetAllGameUI() {
    var scene = cc.director.getScene();

    for (var index = 0; index < scene.childrenCount; index++) {
      var element = scene.children[index];

      if (element.name.startsWith('UI')) {
        if (element.name != "UIHome") {
          element.destroy();
        }
      }
    }
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9zY3JpcHRzL3VpL1VJSG9tZS5qcyJdLCJuYW1lcyI6WyJjYyIsIkNsYXNzIiwiVm96QmFzZUNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJUb3BIb21lIiwiTm9kZSIsIlRvcExvZ2luIiwibGJfbmFtZSIsIkxhYmVsIiwibGJfY2hpcCIsIkF2YXRhciIsIlNwcml0ZSIsIkFMTCIsInR5cGUiLCJTTE9UIiwiTUlOSSIsIkNBU0lOTyIsIm9uTG9hZCIsIlV0aWxzIiwibG9hZFJlcyIsIkNvbmZpZyIsImdldERlZmF1bHRBdmF0YXIiLCJNaW5pR2FtZSIsInNob3dJY29uIiwiaXNGaXJzdFR4Iiwib25FbmFibGUiLCJtbSIsImlzTG9naW4iLCJhY3RpdmUiLCJyZXNldEFsbEdhbWVVSSIsImF1ZGlvIiwicGxheU11c2ljIiwidWkiLCJnZXRVSUZyb21OYW1lIiwiX3NlbGVjdEdhbWUiLCJjb21wbGV0ZUxvYWRVSUdhbWUiLCJ1cGRhdGVVc2VyVmFyaWFibGUiLCJzdWJDaGlwIiwiU21hcnRGb3hTREsiLCJQb3J0YWxDb250cm9sbGVyIiwiWm9uZUluc3RhbmNlIiwibXlTZWxmIiwic3RyaW5nIiwiZm9ybWF0VGV4dCIsIkdhbWVWYXJpYWJsZXMiLCJQb2tlciIsImdldERpc3BsYXlOYW1lIiwiYWRkRG90VG9OdW1iZXIiLCJnZXRDaGlwIiwibXNnIiwiZ2V0VmFyaWFibGUiLCJ2YWx1ZSIsIlN5c3RlbU1lc3NhZ2UiLCJub2RlIiwiZ2V0Q2hpbGRCeU5hbWUiLCJqcyIsImdldENvbXBvbmVudCIsIm5hbWUiLCJydW5NZXNzYWdlIiwib25TZWxlY3RHYW1lIiwiZXZlbnQiLCJnYW1lIiwiX3NlbGVjdEdhbWVOb2RlIiwiY3VycmVudFRhcmdldCIsIm9uTG9hZFN1YkdhbWUiLCJwbGF5QnV0dG9uIiwib25TZWxlY3RUWEdhbWUiLCJ1c2VyIiwicmV0IiwicmVmbGVjdGlvbiIsImNhbGxTdGF0aWNNZXRob2QiLCJvblNlbGVjdFhER2FtZSIsIm9uVG9nZ2xlQ2F0ZWdvcnlHYW1lIiwiX2FjdGl2ZUljb25HYW1lIiwiX2hpZGVBbGxJY29uR2FtZSIsImkiLCJsZW5ndGgiLCJsaXN0IiwiTG9hZGluZyIsInNob3ciLCJwb3AiLCJnYW1lQ29udHJvbGxlciIsIlBvcnRhbE1hbmFnZXIiLCJnZXRHYW1lQ29udHJvbGxlciIsImxvZ2luWm9uZSIsImdldFVzZXJuYW1lIiwiZ2V0UGFzcyIsIm9uQ2xpY2tMb2dpbiIsIm9uQ2xpY2tSZWdpc3RlciIsImV2ZW50U2hvd1dhcm5pbmciLCJzZWxmIiwiVUlNYW5nZXIiLCJkYXRhIiwiY29udGVudCIsImNiWWVzIiwiX3Jlc2V0IiwiZGlzY29ubmVjdEFsbCIsInNjZW5lIiwiZGlyZWN0b3IiLCJnZXRTY2VuZSIsImluZGV4IiwiY2hpbGRyZW5Db3VudCIsImVsZW1lbnQiLCJjaGlsZHJlbiIsInN0YXJ0c1dpdGgiLCJkZXN0cm95Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBQSxFQUFFLENBQUNDLEtBQUgsQ0FBUztBQUNMLGFBQVNELEVBQUUsQ0FBQ0UsZ0JBRFA7QUFHTEMsRUFBQUEsVUFBVSxFQUFFO0FBQ1JDLElBQUFBLE9BQU8sRUFBRUosRUFBRSxDQUFDSyxJQURKO0FBRVJDLElBQUFBLFFBQVEsRUFBRU4sRUFBRSxDQUFDSyxJQUZMO0FBR1JFLElBQUFBLE9BQU8sRUFBRVAsRUFBRSxDQUFDUSxLQUhKO0FBSVJDLElBQUFBLE9BQU8sRUFBRVQsRUFBRSxDQUFDUSxLQUpKO0FBS1JFLElBQUFBLE1BQU0sRUFBRVYsRUFBRSxDQUFDVyxNQUxIO0FBTVJDLElBQUFBLEdBQUcsRUFBRztBQUNGQyxNQUFBQSxJQUFJLEVBQUViLEVBQUUsQ0FBQ0ssSUFEUDtBQUVGLGlCQUFTO0FBRlAsS0FORTtBQVVSUyxJQUFBQSxJQUFJLEVBQUU7QUFDRkQsTUFBQUEsSUFBSSxFQUFFYixFQUFFLENBQUNLLElBRFA7QUFFRixpQkFBUztBQUZQLEtBVkU7QUFjUlUsSUFBQUEsSUFBSSxFQUFFO0FBQ0ZGLE1B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QUEsSUFBSSxDQUFDdEYsT0FBTCxDQUFhd0IsTUFBYixHQUFzQixLQUF0QjtBQUNBOEQsVUFBQUEsSUFBSSxDQUFDcEYsUUFBTCxDQUFjc0IsTUFBZCxHQUF1QixJQUF2QjtBQUNBRixVQUFBQSxFQUFFLENBQUNDLE9BQUgsR0FBYSxLQUFiOztBQUNBVyxVQUFBQSxXQUFXLENBQUNDLGdCQUFaLENBQTZCd0QsTUFBN0I7O0FBQ0FiLFVBQUFBLGFBQWEsQ0FBQ2MsYUFBZDtBQUNBTixVQUFBQSxJQUFJLENBQUM3RCxjQUFMO0FBQ0g7QUFUQyxPQURtQjtBQVd0Qm1ELE1BQUFBLEdBQUcsRUFBRTtBQVhpQixLQUE3QjtBQWFILEdBcEpJO0FBcUpMbkQsRUFBQUEsY0FySkssNEJBcUpZO0FBQ2IsUUFBTW9FLEtBQUssR0FBR2pHLEVBQUUsQ0FBQ2tHLFFBQUgsQ0FBWUMsUUFBWixFQUFkOztBQUNBLFNBQUssSUFBSUMsS0FBSyxHQUFHLENBQWpCLEVBQW9CQSxLQUFLLEdBQUdILEtBQUssQ0FBQ0ksYUFBbEMsRUFBaURELEtBQUssRUFBdEQsRUFBMEQ7QUFDdEQsVUFBSUUsT0FBTyxHQUFHTCxLQUFLLENBQUNNLFFBQU4sQ0FBZUgsS0FBZixDQUFkOztBQUNBLFVBQUlFLE9BQU8sQ0FBQzdDLElBQVIsQ0FBYStDLFVBQWIsQ0FBd0IsSUFBeEIsQ0FBSixFQUFtQztBQUMvQixZQUFJRixPQUFPLENBQUM3QyxJQUFSLElBQWdCLFFBQXBCLEVBQTZCO0FBQ3pCNkMsVUFBQUEsT0FBTyxDQUFDRyxPQUFSO0FBQ0g7QUFDSjtBQUNKO0FBQ0o7QUEvSkksQ0FBVCIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLlZvekJhc2VDb21wb25lbnQsXG5cbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIFRvcEhvbWU6IGNjLk5vZGUsXG4gICAgICAgIFRvcExvZ2luOiBjYy5Ob2RlLFxuICAgICAgICBsYl9uYW1lOiBjYy5MYWJlbCxcbiAgICAgICAgbGJfY2hpcDogY2MuTGFiZWwsXG4gICAgICAgIEF2YXRhcjogY2MuU3ByaXRlLFxuICAgICAgICBBTEwgOiB7XG4gICAgICAgICAgICB0eXBlOiBjYy5Ob2RlLFxuICAgICAgICAgICAgZGVmYXVsdDogW11cbiAgICAgICAgfSxcbiAgICAgICAgU0xPVDoge1xuICAgICAgICAgICAgdHlwZTogY2MuTm9kZSxcbiAgICAgICAgICAgIGRlZmF1bHQ6IFtdXG4gICAgICAgIH0sXG4gICAgICAgIE1JTkk6IHtcbiAgICAgICAgICAgIHR5cGU6IGNjLk5vZGUsXG4gICAgICAgICAgICBkZWZhdWx0OiBbXVxuICAgICAgICB9LFxuICAgICAgICBDQVNJTk86IHtcbiAgICAgICAgICAgIHR5cGU6IGNjLk5vZGUsXG4gICAgICAgICAgICBkZWZhdWx0OiBbXVxuICAgICAgICB9XG4gICAgfSxcbiAgICBvbkxvYWQoKXtcbiAgICAgICAgVXRpbHMubG9hZFJlcyh0aGlzLkF2YXRhciwgXCJpbWFnZXMvYXZhdGFyL1wiK0NvbmZpZy5nZXREZWZhdWx0QXZhdGFyKCkpO1xuICAgICAgICBNaW5pR2FtZS5zaG93SWNvbigpO1xuICAgICAgICBjYy5pc0ZpcnN0VHggPSB0cnVlO1xuICAgIH0sXG4gICAgb25FbmFibGUoKXtcbiAgICAgICAgaWYobW0uaXNMb2dpbil7XG4gICAgICAgICAgICB0aGlzLlRvcEhvbWUuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuVG9wTG9naW4uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgdGhpcy5Ub3BIb21lLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5Ub3BMb2dpbi5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5yZXNldEFsbEdhbWVVSSgpO1xuICAgICAgICB9XG4gICAgICAgIG1tLmF1ZGlvLnBsYXlNdXNpYygpO1xuICAgICAgICBpZiAobW0uaXNMb2dpbiAmJiBjYy5pc0ZpcnN0VHgpe1xuICAgICAgICAgICAgY2MuaXNGaXJzdFR4ID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgdWkgPSB0aGlzLmdldFVJRnJvbU5hbWUoXCJVSVRhaVhpdVwiKTtcbiAgICAgICAgICAgIGlmICh1aSA9PSBudWxsKXtcbiAgICAgICAgICAgICAgICB0aGlzLl9zZWxlY3RHYW1lID0gXCJ0YWl4aXVcIjtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbXBsZXRlTG9hZFVJR2FtZSh0aGlzLl9zZWxlY3RHYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG4gICAgdXBkYXRlVXNlclZhcmlhYmxlKHN1YkNoaXApIHtcbiAgICAgICAgaWYoU21hcnRGb3hTREsuUG9ydGFsQ29udHJvbGxlci5ab25lSW5zdGFuY2UubXlTZWxmKXtcbiAgICAgICAgICAgIHRoaXMubGJfbmFtZS5zdHJpbmcgPSBVdGlscy5mb3JtYXRUZXh0KEdhbWVWYXJpYWJsZXMuUG9rZXIuZ2V0RGlzcGxheU5hbWUoU21hcnRGb3hTREsuUG9ydGFsQ29udHJvbGxlci5ab25lSW5zdGFuY2UubXlTZWxmKSwgMjApO1xuICAgICAgICAgICAgdGhpcy5sYl9jaGlwLnN0cmluZyA9IFV0aWxzLmFkZERvdFRvTnVtYmVyKEdhbWVWYXJpYWJsZXMuUG9rZXIuZ2V0Q2hpcChTbWFydEZveFNESy5Qb3J0YWxDb250cm9sbGVyLlpvbmVJbnN0YW5jZS5teVNlbGYpLXN1YkNoaXApO1xuICAgICAgICAgICAgbGV0IG1zZyA9IFNtYXJ0Rm94U0RLLlBvcnRhbENvbnRyb2xsZXIuWm9uZUluc3RhbmNlLm15U2VsZi5nZXRWYXJpYWJsZShcInN5c21zZ1wiKTtcbiAgICAgICAgICAgIGlmKG1zZyAmJiBtc2cudmFsdWUpe1xuICAgICAgICAgICAgICAgIGxldCBTeXN0ZW1NZXNzYWdlID0gdGhpcy5ub2RlLmdldENoaWxkQnlOYW1lKFwiY29udGVudFwiKS5nZXRDaGlsZEJ5TmFtZShcIlN5c3RlbU1lc3NhZ2VcIik7XG4gICAgICAgICAgICAgICAgbGV0IGpzID0gU3lzdGVtTWVzc2FnZS5nZXRDb21wb25lbnQoU3lzdGVtTWVzc2FnZS5uYW1lKTtcbiAgICAgICAgICAgICAgICBqcy5ydW5NZXNzYWdlKG1zZy52YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuICAgIG9uU2VsZWN0R2FtZShldmVudCwgZ2FtZSl7XG4gICAgICAgIHRoaXMuX3NlbGVjdEdhbWUgPSBnYW1lO1xuICAgICAgICBjYy5fc2VsZWN0R2FtZU5vZGUgPSBldmVudC5jdXJyZW50VGFyZ2V0O1xuICAgICAgICB0aGlzLm9uTG9hZFN1YkdhbWUoKTtcbiAgICAgICAgbW0uYXVkaW8ucGxheUJ1dHRvbigpO1xuICAgIH0sXG4gICAgb25TZWxlY3RUWEdhbWUoZXZlbnQsIGdhbWUpIHtcbiAgICAgICAgbGV0IHVzZXIgPSBHYW1lVmFyaWFibGVzLlBva2VyLmdldERpc3BsYXlOYW1lKFNtYXJ0Rm94U0RLLlBvcnRhbENvbnRyb2xsZXIuWm9uZUluc3RhbmNlLm15U2VsZik7XG4gICAgICAgIHZhciByZXQgPSBjYy5uYXRpdmUucmVmbGVjdGlvbi5jYWxsU3RhdGljTWV0aG9kKFwiQ29jb3NCcmlkZ2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJvcGVuVFhHYW1lXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidG9rZW5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlcik7XG5cbiAgICB9LFxuICAgIG9uU2VsZWN0WERHYW1lKGV2ZW50LCBnYW1lKSB7XG4gICAgICAgIGxldCB1c2VyID0gR2FtZVZhcmlhYmxlcy5Qb2tlci5nZXREaXNwbGF5TmFtZShTbWFydEZveFNESy5Qb3J0YWxDb250cm9sbGVyLlpvbmVJbnN0YW5jZS5teVNlbGYpO1xuICAgICAgICB2YXIgcmV0ID0gY2MubmF0aXZlLnJlZmxlY3Rpb24uY2FsbFN0YXRpY01ldGhvZChcIkNvY29zQnJpZGdlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwib3BlblhER2FtZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRva2VuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIpO1xuXG4gICAgfSxcbiAgICBvblRvZ2dsZUNhdGVnb3J5R2FtZShldmVudCl7XG4gICAgICAgIG1tLmF1ZGlvLnBsYXlCdXR0b24oKTtcbiAgICAgICAgaWYoZXZlbnQubm9kZS5uYW1lID09ICdBbGwnKXtcbiAgICAgICAgICAgIHRoaXMuX2FjdGl2ZUljb25HYW1lKHRoaXMuQUxMKTtcbiAgICAgICAgfWVsc2UgaWYoZXZlbnQubm9kZS5uYW1lID09ICdTbG90Jyl7XG4gICAgICAgICAgICB0aGlzLl9oaWRlQWxsSWNvbkdhbWUoKTtcbiAgICAgICAgICAgIHRoaXMuX2FjdGl2ZUljb25HYW1lKHRoaXMuU0xPVCk7XG4gICAgICAgIH1lbHNlIGlmKGV2ZW50Lm5vZGUubmFtZSA9PSAnTWluaUdhbWUnKXtcbiAgICAgICAgICAgIHRoaXMuX2hpZGVBbGxJY29uR2FtZSgpO1xuICAgICAgICAgICAgdGhpcy5fYWN0aXZlSWNvbkdhbWUodGhpcy5NSU5JKTtcbiAgICAgICAgfWVsc2UgaWYoZXZlbnQubm9kZS5uYW1lID09ICdDYXNpbm8nKXtcbiAgICAgICAgICAgIHRoaXMuX2hpZGVBbGxJY29uR2FtZSgpO1xuICAgICAgICAgICAgdGhpcy5fYWN0aXZlSWNvbkdhbWUodGhpcy5DQVNJTk8pO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBfaGlkZUFsbEljb25HYW1lKCl7XG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLkFMTC5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgIHRoaXMuQUxMW2ldLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBfYWN0aXZlSWNvbkdhbWUobGlzdCl7XG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDtpKyspe1xuICAgICAgICAgICAgbGlzdFtpXS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBvbkxvYWRTdWJHYW1lKCl7XG4gICAgICAgIGxldCBnYW1lID0gdGhpcy5fc2VsZWN0R2FtZTtcbiAgICAgICAgaWYobW0uaXNMb2dpbil7XG4gICAgICAgICAgICBjYy5fc2VsZWN0R2FtZU5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJsb2FkXCIpLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICBtbS5Mb2FkaW5nLnNob3coKTtcbiAgICAgICAgICAgIHRoaXMuY29tcGxldGVMb2FkVUlHYW1lKGdhbWUpO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIHRoaXMuc2hvdyhcIlVJTG9naW5cIiwge3BvcDogdHJ1ZX0pO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBjb21wbGV0ZUxvYWRVSUdhbWUoZ2FtZSl7XG4gICAgICAgIGxldCBnYW1lQ29udHJvbGxlciA9IFBvcnRhbE1hbmFnZXIuZ2V0R2FtZUNvbnRyb2xsZXIoZ2FtZSk7XG4gICAgICAgIGlmKGdhbWVDb250cm9sbGVyKVxuICAgICAgICAgICAgZ2FtZUNvbnRyb2xsZXIubG9naW5ab25lKENvbmZpZy5nZXRVc2VybmFtZSgpLCBDb25maWcuZ2V0UGFzcygpKTtcbiAgICB9LFxuICAgIG9uQ2xpY2tMb2dpbigpe1xuICAgICAgICBtbS5hdWRpby5wbGF5QnV0dG9uKCk7XG4gICAgICAgIHRoaXMuc2hvdyhcIlVJTG9naW5cIiwge3BvcDogdHJ1ZX0pO1xuICAgIH0sXG4gICAgb25DbGlja1JlZ2lzdGVyKCl7XG4gICAgICAgIG1tLmF1ZGlvLnBsYXlCdXR0b24oKTtcbiAgICAgICAgdGhpcy5zaG93KFwiVUlSZWdpc3RlclwiLCB7cG9wOiB0cnVlfSk7XG4gICAgfSxcbiAgICBldmVudFNob3dXYXJuaW5nKCl7XG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcbiAgICAgICAgbW0uYXVkaW8ucGxheUJ1dHRvbigpO1xuICAgICAgICBVSU1hbmdlci5zaG93KCdVSURpYWxvZ1R3bycsIHtcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICBjb250ZW50OiBcIkLhuqFuIGPDsyBtdeG7kW4gxJHEg25nIHh14bqldCBraMO0bmc/XCIsXG4gICAgICAgICAgICAgICAgXCJjYlllc1wiOiBmdW5jdGlvbiBjYlllcygpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5Ub3BIb21lLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLlRvcExvZ2luLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG1tLmlzTG9naW4gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgU21hcnRGb3hTREsuUG9ydGFsQ29udHJvbGxlci5fcmVzZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgUG9ydGFsTWFuYWdlci5kaXNjb25uZWN0QWxsKCk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYucmVzZXRBbGxHYW1lVUkoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBwb3A6IHRydWVcbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICByZXNldEFsbEdhbWVVSSgpIHtcbiAgICAgICAgY29uc3Qgc2NlbmUgPSBjYy5kaXJlY3Rvci5nZXRTY2VuZSgpO1xuICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgc2NlbmUuY2hpbGRyZW5Db3VudDsgaW5kZXgrKykge1xuICAgICAgICAgICAgbGV0IGVsZW1lbnQgPSBzY2VuZS5jaGlsZHJlbltpbmRleF07XG4gICAgICAgICAgICBpZiAoZWxlbWVudC5uYW1lLnN0YXJ0c1dpdGgoJ1VJJykpIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5uYW1lICE9IFwiVUlIb21lXCIpe1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KTtcbiJdfQ==