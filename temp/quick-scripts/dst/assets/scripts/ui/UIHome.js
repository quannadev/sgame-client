
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/ui/UIHome.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'b61e3usURxALbVo2C8WDS0x', 'UIHome');
// scripts/ui/UIHome.js

"use strict";

cc.Class({
  "extends": cc.VozBaseComponent,
  properties: {
    TopHome: cc.Node,
    TopLogin: cc.Node,
    lb_name: cc.Label,
    lb_chip: cc.Label,
    Avatar: cc.Sprite,
    ALL: {
      type: cc.Node,
      "default": []
    },
    SLOT: {
      type: cc.Node,
      "default": []
    },
    MINI: {
      type: cc.Node,
      "default": []
    },
    CASINO: {
      type: cc.Node,
      "default": []
    }
  },
  onLoad: function onLoad() {
    Utils.loadRes(this.Avatar, "images/avatar/" + Config.getDefaultAvatar());
    MiniGame.showIcon();
    cc.isFirstTx = true;
  },
  onEnable: function onEnable() {
    if (mm.isLogin) {
      this.TopHome.active = true;
      this.TopLogin.active = false;
    } else {
      this.TopHome.active = false;
      this.TopLogin.active = true;
      this.resetAllGameUI();
    }

    mm.audio.playMusic();

    if (mm.isLogin && cc.isFirstTx) {
      cc.isFirstTx = false;
      var ui = this.getUIFromName("UITaiXiu");

      if (ui == null) {
        this._selectGame = "taixiu";
        this.completeLoadUIGame(this._selectGame);
      }
    }
  },
  updateUserVariable: function updateUserVariable(subChip) {
    if (SmartFoxSDK.PortalController.ZoneInstance.mySelf) {
      this.lb_name.string = Utils.formatText(GameVariables.Poker.getDisplayName(SmartFoxSDK.PortalController.ZoneInstance.mySelf), 20);
      this.lb_chip.string = Utils.addDotToNumber(GameVariables.Poker.getChip(SmartFoxSDK.PortalController.ZoneInstance.mySelf) - subChip);
      var msg = SmartFoxSDK.PortalController.ZoneInstance.mySelf.getVariable("sysmsg");

      if (msg && msg.value) {
        var SystemMessage = this.node.getChildByName("content").getChildByName("SystemMessage");
        var js = SystemMessage.getComponent(SystemMessage.name);
        js.runMessage(msg.value);
      }
    }
  },
  onSelectGame: function onSelectGame(event, game) {
    this._selectGame = game;
    cc._selectGameNode = event.currentTarget;
    this.onLoadSubGame();
    mm.audio.playButton();
  },
  onToggleCategoryGame: function onToggleCategoryGame(event) {
    mm.audio.playButton();

    if (event.node.name == 'All') {
      this._activeIconGame(this.ALL);
    } else if (event.node.name == 'Slot') {
      this._hideAllIconGame();

      this._activeIconGame(this.SLOT);
    } else if (event.node.name == 'MiniGame') {
      this._hideAllIconGame();

      this._activeIconGame(this.MINI);
    } else if (event.node.name == 'Casino') {
      this._hideAllIconGame();

      this._activeIconGame(this.CASINO);
    }
  },
  _hideAllIconGame: function _hideAllIconGame() {
    for (var i = 0; i < this.ALL.length; i++) {
      this.ALL[i].active = false;
    }
  },
  _activeIconGame: function _activeIconGame(list) {
    for (var i = 0; i < list.length; i++) {
      list[i].active = true;
    }
  },
  onLoadSubGame: function onLoadSubGame() {
    var game = this._selectGame;

    if (mm.isLogin) {
      cc._selectGameNode.getChildByName("load").active = true;
      mm.Loading.show();
      this.completeLoadUIGame(game);
    } else {
      this.show("UILogin", {
        pop: true
      });
    }
  },
  completeLoadUIGame: function completeLoadUIGame(game) {
    var gameController = PortalManager.getGameController(game);
    if (gameController) gameController.loginZone(Config.getUsername(), Config.getPass());
  },
  onClickLogin: function onClickLogin() {
    mm.audio.playButton();
    this.show("UILogin", {
      pop: true
    });
  },
  onClickRegister: function onClickRegister() {
    mm.audio.playButton();
    this.show("UIRegister", {
      pop: true
    });
  },
  eventShowWarning: function eventShowWarning() {
    var self = this;
    mm.audio.playButton();
    UIManger.show('UIDialogTwo', {
      data: {
        content: "Bạn có muốn đăng xuất không?",
        "cbYes": function cbYes() {
          self.TopHome.active = false;
          self.TopLogin.active = true;
          mm.isLogin = false;

          SmartFoxSDK.PortalController._reset();

          PortalManager.disconnectAll();
          self.resetAllGameUI();
        }
      },
      pop: true
    });
  },
  resetAllGameUI: function resetAllGameUI() {
    var scene = cc.director.getScene();

    for (var index = 0; index < scene.childrenCount; index++) {
      var element = scene.children[index];

      if (element.name.startsWith('UI')) {
        if (element.name != "UIHome") {
          element.destroy();
        }
      }
    }
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcdWlcXFVJSG9tZS5qcyJdLCJuYW1lcyI6WyJjYyIsIkNsYXNzIiwiVm96QmFzZUNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJUb3BIb21lIiwiTm9kZSIsIlRvcExvZ2luIiwibGJfbmFtZSIsIkxhYmVsIiwibGJfY2hpcCIsIkF2YXRhciIsIlNwcml0ZSIsIkFMTCIsInR5cGUiLCJTTE9UIiwiTUlOSSIsIkNBU0lOTyIsIm9uTG9hZCIsIlV0aWxzIiwibG9hZFJlcyIsIkNvbmZpZyIsImdldERlZmF1bHRBdmF0YXIiLCJNaW5pR2FtZSIsInNob3dJY29uIiwiaXNGaXJzdFR4Iiwib25FbmFibGUiLCJtbSIsImlzTG9naW4iLCJhY3RpdmUiLCJyZXNldEFsbEdhbWVVSSIsImF1ZGlvIiwicGxheU11c2ljIiwidWkiLCJnZXRVSUZyb21OYW1lIiwiX3NlbGVjdEdhbWUiLCJjb21wbGV0ZUxvYWRVSUdhbWUiLCJ1cGRhdGVVc2VyVmFyaWFibGUiLCJzdWJDaGlwIiwiU21hcnRGb3hTREsiLCJQb3J0YWxDb250cm9sbGVyIiwiWm9uZUluc3RhbmNlIiwibXlTZWxmIiwic3RyaW5nIiwiZm9ybWF0VGV4dCIsIkdhbWVWYXJpYWJsZXMiLCJQb2tlciIsImdldERpc3BsYXlOYW1lIiwiYWRkRG90VG9OdW1iZXIiLCJnZXRDaGlwIiwibXNnIiwiZ2V0VmFyaWFibGUiLCJ2YWx1ZSIsIlN5c3RlbU1lc3NhZ2UiLCJub2RlIiwiZ2V0Q2hpbGRCeU5hbWUiLCJqcyIsImdldENvbXBvbmVudCIsIm5hbWUiLCJydW5NZXNzYWdlIiwib25TZWxlY3RHYW1lIiwiZXZlbnQiLCJnYW1lIiwiX3NlbGVjdEdhbWVOb2RlIiwiY3VycmVudFRhcmdldCIsIm9uTG9hZFN1YkdhbWUiLCJwbGF5QnV0dG9uIiwib25Ub2dnbGVDYXRlZ29yeUdhbWUiLCJfYWN0aXZlSWNvbkdhbWUiLCJfaGlkZUFsbEljb25HYW1lIiwiaSIsImxlbmd0aCIsImxpc3QiLCJMb2FkaW5nIiwic2hvdyIsInBvcCIsImdhbWVDb250cm9sbGVyIiwiUG9ydGFsTWFuYWdlciIsImdldEdhbWVDb250cm9sbGVyIiwibG9naW5ab25lIiwiZ2V0VXNlcm5hbWUiLCJnZXRQYXNzIiwib25DbGlja0xvZ2luIiwib25DbGlja1JlZ2lzdGVyIiwiZXZlbnRTaG93V2FybmluZyIsInNlbGYiLCJVSU1hbmdlciIsImRhdGEiLCJjb250ZW50IiwiY2JZZXMiLCJfcmVzZXQiLCJkaXNjb25uZWN0QWxsIiwic2NlbmUiLCJkaXJlY3RvciIsImdldFNjZW5lIiwiaW5kZXgiLCJjaGlsZHJlbkNvdW50IiwiZWxlbWVudCIsImNoaWxkcmVuIiwic3RhcnRzV2l0aCIsImRlc3Ryb3kiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUFBLEVBQUUsQ0FBQ0MsS0FBSCxDQUFTO0FBQ0wsYUFBU0QsRUFBRSxDQUFDRSxnQkFEUDtBQUdMQyxFQUFBQSxVQUFVLEVBQUU7QUFDUkMsSUFBQUEsT0FBTyxFQUFFSixFQUFFLENBQUNLLElBREo7QUFFUkMsSUFBQUEsUUFBUSxFQUFFTixFQUFFLENBQUNLLElBRkw7QUFHUkUsSUFBQUEsT0FBTyxFQUFFUCxFQUFFLENBQUNRLEtBSEo7QUFJUkMsSUFBQUEsT0FBTyxFQUFFVCxFQUFFLENBQUNRLEtBSko7QUFLUkUsSUFBQUEsTUFBTSxFQUFFVixFQUFFLENBQUNXLE1BTEg7QUFNUkMsSUFBQUEsR0FBRyxFQUFHO0FBQ0ZDLE1BQUFBLElBQUksRUFBRWIsRUFBRSxDQUFDSyxJQURQO0FBRUYsaUJBQVM7QUFGUCxLQU5FO0FBVVJTLElBQUFBLElBQUksRUFBRTtBQUNGRCxNQUFBQSxJQUFJLEVBQUViLEVBQUUsQ0FBQ0ssSUFEUDtBQUVGLGlCQUFTO0FBRlAsS0FWRTtBQWNSVSxJQUFBQSxJQUFJLEVBQUU7QUFDRkYsTUFBQUEsSUFBSSxFQUFFYixFQUFFLENBQUNLLElBRFA7QUFFRixpQkFBUztBQUZQLEtBZEU7QUFrQlJXLElBQUFBLE1BQU0sRUFBRTtB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QU8sQ0FBQ0csT0FBUjtBQUNIO0FBQ0o7QUFDSjtBQUNKO0FBL0lJLENBQVQiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbImNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLlZvekJhc2VDb21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIFRvcEhvbWU6IGNjLk5vZGUsXHJcbiAgICAgICAgVG9wTG9naW46IGNjLk5vZGUsXHJcbiAgICAgICAgbGJfbmFtZTogY2MuTGFiZWwsXHJcbiAgICAgICAgbGJfY2hpcDogY2MuTGFiZWwsXHJcbiAgICAgICAgQXZhdGFyOiBjYy5TcHJpdGUsXHJcbiAgICAgICAgQUxMIDoge1xyXG4gICAgICAgICAgICB0eXBlOiBjYy5Ob2RlLFxyXG4gICAgICAgICAgICBkZWZhdWx0OiBbXVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgU0xPVDoge1xyXG4gICAgICAgICAgICB0eXBlOiBjYy5Ob2RlLFxyXG4gICAgICAgICAgICBkZWZhdWx0OiBbXVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgTUlOSToge1xyXG4gICAgICAgICAgICB0eXBlOiBjYy5Ob2RlLFxyXG4gICAgICAgICAgICBkZWZhdWx0OiBbXVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgQ0FTSU5POiB7XHJcbiAgICAgICAgICAgIHR5cGU6IGNjLk5vZGUsXHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IFtdXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIG9uTG9hZCgpe1xyXG4gICAgICAgIFV0aWxzLmxvYWRSZXModGhpcy5BdmF0YXIsIFwiaW1hZ2VzL2F2YXRhci9cIitDb25maWcuZ2V0RGVmYXVsdEF2YXRhcigpKTtcclxuICAgICAgICBNaW5pR2FtZS5zaG93SWNvbigpO1xyXG4gICAgICAgIGNjLmlzRmlyc3RUeCA9IHRydWU7XHJcbiAgICB9LFxyXG4gICAgb25FbmFibGUoKXtcclxuICAgICAgICBpZihtbS5pc0xvZ2luKXtcclxuICAgICAgICAgICAgdGhpcy5Ub3BIb21lLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuVG9wTG9naW4uYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuVG9wSG9tZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5Ub3BMb2dpbi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLnJlc2V0QWxsR2FtZVVJKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG1tLmF1ZGlvLnBsYXlNdXNpYygpO1xyXG4gICAgICAgIGlmIChtbS5pc0xvZ2luICYmIGNjLmlzRmlyc3RUeCl7XHJcbiAgICAgICAgICAgIGNjLmlzRmlyc3RUeCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB2YXIgdWkgPSB0aGlzLmdldFVJRnJvbU5hbWUoXCJVSVRhaVhpdVwiKTtcclxuICAgICAgICAgICAgaWYgKHVpID09IG51bGwpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0R2FtZSA9IFwidGFpeGl1XCI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbXBsZXRlTG9hZFVJR2FtZSh0aGlzLl9zZWxlY3RHYW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICB1cGRhdGVVc2VyVmFyaWFibGUoc3ViQ2hpcCkge1xyXG4gICAgICAgIGlmKFNtYXJ0Rm94U0RLLlBvcnRhbENvbnRyb2xsZXIuWm9uZUluc3RhbmNlLm15U2VsZil7XHJcbiAgICAgICAgICAgIHRoaXMubGJfbmFtZS5zdHJpbmcgPSBVdGlscy5mb3JtYXRUZXh0KEdhbWVWYXJpYWJsZXMuUG9rZXIuZ2V0RGlzcGxheU5hbWUoU21hcnRGb3hTREsuUG9ydGFsQ29udHJvbGxlci5ab25lSW5zdGFuY2UubXlTZWxmKSwgMjApO1xyXG4gICAgICAgICAgICB0aGlzLmxiX2NoaXAuc3RyaW5nID0gVXRpbHMuYWRkRG90VG9OdW1iZXIoR2FtZVZhcmlhYmxlcy5Qb2tlci5nZXRDaGlwKFNtYXJ0Rm94U0RLLlBvcnRhbENvbnRyb2xsZXIuWm9uZUluc3RhbmNlLm15U2VsZiktc3ViQ2hpcCk7XHJcbiAgICAgICAgICAgIGxldCBtc2cgPSBTbWFydEZveFNESy5Qb3J0YWxDb250cm9sbGVyLlpvbmVJbnN0YW5jZS5teVNlbGYuZ2V0VmFyaWFibGUoXCJzeXNtc2dcIik7XHJcbiAgICAgICAgICAgIGlmKG1zZyAmJiBtc2cudmFsdWUpe1xyXG4gICAgICAgICAgICAgICAgbGV0IFN5c3RlbU1lc3NhZ2UgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJjb250ZW50XCIpLmdldENoaWxkQnlOYW1lKFwiU3lzdGVtTWVzc2FnZVwiKTtcclxuICAgICAgICAgICAgICAgIGxldCBqcyA9IFN5c3RlbU1lc3NhZ2UuZ2V0Q29tcG9uZW50KFN5c3RlbU1lc3NhZ2UubmFtZSk7XHJcbiAgICAgICAgICAgICAgICBqcy5ydW5NZXNzYWdlKG1zZy52YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgb25TZWxlY3RHYW1lKGV2ZW50LCBnYW1lKXtcclxuICAgICAgICB0aGlzLl9zZWxlY3RHYW1lID0gZ2FtZTtcclxuICAgICAgICBjYy5fc2VsZWN0R2FtZU5vZGUgPSBldmVudC5jdXJyZW50VGFyZ2V0O1xyXG4gICAgICAgIHRoaXMub25Mb2FkU3ViR2FtZSgpO1xyXG4gICAgICAgIG1tLmF1ZGlvLnBsYXlCdXR0b24oKTtcclxuICAgIH0sXHJcbiAgICBvblRvZ2dsZUNhdGVnb3J5R2FtZShldmVudCl7XHJcbiAgICAgICAgbW0uYXVkaW8ucGxheUJ1dHRvbigpO1xyXG4gICAgICAgIGlmKGV2ZW50Lm5vZGUubmFtZSA9PSAnQWxsJyl7XHJcbiAgICAgICAgICAgIHRoaXMuX2FjdGl2ZUljb25HYW1lKHRoaXMuQUxMKTtcclxuICAgICAgICB9ZWxzZSBpZihldmVudC5ub2RlLm5hbWUgPT0gJ1Nsb3QnKXtcclxuICAgICAgICAgICAgdGhpcy5faGlkZUFsbEljb25HYW1lKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2FjdGl2ZUljb25HYW1lKHRoaXMuU0xPVCk7XHJcbiAgICAgICAgfWVsc2UgaWYoZXZlbnQubm9kZS5uYW1lID09ICdNaW5pR2FtZScpe1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlQWxsSWNvbkdhbWUoKTtcclxuICAgICAgICAgICAgdGhpcy5fYWN0aXZlSWNvbkdhbWUodGhpcy5NSU5JKTtcclxuICAgICAgICB9ZWxzZSBpZihldmVudC5ub2RlLm5hbWUgPT0gJ0Nhc2lubycpe1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlQWxsSWNvbkdhbWUoKTtcclxuICAgICAgICAgICAgdGhpcy5fYWN0aXZlSWNvbkdhbWUodGhpcy5DQVNJTk8pO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBfaGlkZUFsbEljb25HYW1lKCl7XHJcbiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHRoaXMuQUxMLmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICB0aGlzLkFMTFtpXS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgX2FjdGl2ZUljb25HYW1lKGxpc3Qpe1xyXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICBsaXN0W2ldLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIG9uTG9hZFN1YkdhbWUoKXtcclxuICAgICAgICBsZXQgZ2FtZSA9IHRoaXMuX3NlbGVjdEdhbWU7XHJcbiAgICAgICAgaWYobW0uaXNMb2dpbil7XHJcbiAgICAgICAgICAgIGNjLl9zZWxlY3RHYW1lTm9kZS5nZXRDaGlsZEJ5TmFtZShcImxvYWRcIikuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgbW0uTG9hZGluZy5zaG93KCk7XHJcbiAgICAgICAgICAgIHRoaXMuY29tcGxldGVMb2FkVUlHYW1lKGdhbWUpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB0aGlzLnNob3coXCJVSUxvZ2luXCIsIHtwb3A6IHRydWV9KTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgY29tcGxldGVMb2FkVUlHYW1lKGdhbWUpe1xyXG4gICAgICAgIGxldCBnYW1lQ29udHJvbGxlciA9IFBvcnRhbE1hbmFnZXIuZ2V0R2FtZUNvbnRyb2xsZXIoZ2FtZSk7XHJcbiAgICAgICAgaWYoZ2FtZUNvbnRyb2xsZXIpXHJcbiAgICAgICAgICAgIGdhbWVDb250cm9sbGVyLmxvZ2luWm9uZShDb25maWcuZ2V0VXNlcm5hbWUoKSwgQ29uZmlnLmdldFBhc3MoKSk7XHJcbiAgICB9LFxyXG4gICAgb25DbGlja0xvZ2luKCl7XHJcbiAgICAgICAgbW0uYXVkaW8ucGxheUJ1dHRvbigpO1xyXG4gICAgICAgIHRoaXMuc2hvdyhcIlVJTG9naW5cIiwge3BvcDogdHJ1ZX0pO1xyXG4gICAgfSxcclxuICAgIG9uQ2xpY2tSZWdpc3Rlcigpe1xyXG4gICAgICAgIG1tLmF1ZGlvLnBsYXlCdXR0b24oKTtcclxuICAgICAgICB0aGlzLnNob3coXCJVSVJlZ2lzdGVyXCIsIHtwb3A6IHRydWV9KTtcclxuICAgIH0sXHJcbiAgICBldmVudFNob3dXYXJuaW5nKCl7XHJcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIG1tLmF1ZGlvLnBsYXlCdXR0b24oKTtcclxuICAgICAgICBVSU1hbmdlci5zaG93KCdVSURpYWxvZ1R3bycsIHtcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgY29udGVudDogXCJC4bqhbiBjw7MgbXXhu5FuIMSRxINuZyB4deG6pXQga2jDtG5nP1wiLFxyXG4gICAgICAgICAgICAgICAgXCJjYlllc1wiOiBmdW5jdGlvbiBjYlllcygpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLlRvcEhvbWUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5Ub3BMb2dpbi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIG1tLmlzTG9naW4gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBTbWFydEZveFNESy5Qb3J0YWxDb250cm9sbGVyLl9yZXNldCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIFBvcnRhbE1hbmFnZXIuZGlzY29ubmVjdEFsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYucmVzZXRBbGxHYW1lVUkoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgcG9wOiB0cnVlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgcmVzZXRBbGxHYW1lVUkoKSB7XHJcbiAgICAgICAgY29uc3Qgc2NlbmUgPSBjYy5kaXJlY3Rvci5nZXRTY2VuZSgpO1xyXG4gICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBzY2VuZS5jaGlsZHJlbkNvdW50OyBpbmRleCsrKSB7XHJcbiAgICAgICAgICAgIGxldCBlbGVtZW50ID0gc2NlbmUuY2hpbGRyZW5baW5kZXhdO1xyXG4gICAgICAgICAgICBpZiAoZWxlbWVudC5uYW1lLnN0YXJ0c1dpdGgoJ1VJJykpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50Lm5hbWUgIT0gXCJVSUhvbWVcIil7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pO1xyXG4iXX0=