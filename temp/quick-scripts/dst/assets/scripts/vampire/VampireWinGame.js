
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/vampire/VampireWinGame.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '95032aiuwpMcZuPQHYGOf97', 'VampireWinGame');
// scripts/vampire/VampireWinGame.js

"use strict";

var self;

var Helper = require("Helper");

cc.Class({
  "extends": cc.VozBaseComponent,
  properties: {
    lbMoneyWin: cc.Label,
    BonusFreeSpine: cc.Node,
    NoHuCoin: cc.Node,
    ThangText: cc.Node,
    ThangLonCoin: cc.Node,
    FreeCount: cc.Node,
    NumberFreeSpine: cc.Node
  },
  onLoad: function onLoad() {
    self = this;
  },
  init: function init(obj) {
    this.SLV = obj;
  },
  runWinGame: function runWinGame() {
    var bgAll = this.node.getChildByName("bg_all");
    bgAll.active = true;

    if (this.SLV.isThangLon && !this.SLV.isNoHu) {
      this.SLV.playBigWin();
      this.runVampireThangLon();
    } else if (this.SLV.isNoHu) {
      this.SLV.playJackpot();
      this.runVampireNoHu();
    } else if (this.SLV.isFree) {
      this.runFreeSpine();
    } else if (this.SLV.isBonus) {
      this.SLV.playBonus();
      this.runBonusSpine();
    } else {
      self.SLV.setMoneyWin(self.SLV.winMoney);
      self.updateFreeSpin();

      if (this.SLV.winMoney > 0) {
        this.SLV.playSpinWin();
        this.lbMoneyWin.node.active = true;
        Helper.numberTo(this.lbMoneyWin, 0, this.SLV.winMoney, 1200, true, function () {
          self.scheduleOnce(function () {
            self.lbMoneyWin.node.active = false;
            bgAll.active = false;
            self.SLV.autoQuay();
          }, 1);
        });
        this.SLV.winMoney = 0;
      } else {
        bgAll.active = false;
        self.SLV.autoQuay();
      }
    }

    if (this.SLV.type == 0) this.SLV.playSpinMis();
  },
  updateFreeSpin: function updateFreeSpin() {
    if (this.SLV.freeSpin < 1) this.FreeCount.active = false;else {
      this.FreeCount.active = true;
      self.FreeCount.getChildByName("lb_free_spine_count").getComponent(cc.Label).string = self.SLV.freeSpin;
    }
  },
  checkRunAgainWin: function checkRunAgainWin() {
    if (this.SLV.isBonus || this.SLV.winMoney > 0 || this.SLV.isFree || this.SLV.isNoHu || this.SLV.isThangLon || this.SLV.isAuto) this.runWinGame();
  },
  runFreeSpine: function runFreeSpine() {
    this.SLV.isFree = false;
    this.BonusFreeSpine.active = true;
    this.NumberFreeSpine.active = true;
    this.BonusFreeSpine.getComponent(sp.Skeleton).setAnimation(0, 'FreeSpine', true);
    this.NumberFreeSpine.getChildByName("lb_number_free_spine").getComponent(cc.Label).string = this.SLV.freeSpin;
    this.scheduleOnce(function () {
      self.node.getChildByName("bg_all").active = false;
      self.BonusFreeSpine.active = false;
      self.NumberFreeSpine.active = false;
      self.FreeCount.active = true;
      self.FreeCount.getChildByName("lb_free_spine_count").getComponent(cc.Label).string = self.SLV.freeSpin;
      this.checkRunAgainWin();
    }, 3);
  },
  runBonusSpine: function runBonusSpine() {
    this.SLV.isBonus = false;
    this.BonusFreeSpine.active = true;
    this.NumberFreeSpine.active = false;
    this.BonusFreeSpine.getComponent(sp.Skeleton).setAnimation(0, 'Bonusgame', true);
    this.scheduleOnce(function () {
      self.BonusFreeSpine.active = false;
      self.show("UIVampireBonus", {
        src: 'vampire',
        pop: true,
        data: self.SLV.freeGift
      });
    }, 2);
  },
  runVampireNoHu: function runVampireNoHu() {
    this.SLV.isNoHu = false;
    this.NoHuCoin.active = true;
    this.Text.active = true;
    this.ThangText.getComponent(sp.Skeleton).setAnimation(0, "NoHu", true);
    var lbMoney = self.node.getChildByName("lb_number_win");
    lbMoney.setPosition(cc.v2(0, -160));
    lbMoney.active = true;
    Helper.numberTo(lbMoney.getComponent(cc.Label), 0, this.SLV.winMoney, 1200, true, function () {
      self.scheduleOnce(function () {
        var d = cc.moveTo(0.5, cc.v2(0, 50));
        lbMoney.runAction(cc.sequence(d, cc.delayTime(1), cc.callFunc(function () {
          self.node.getChildByName("bg_all").active = false;
          self.NoHuCoin.active = false;
          self.ThangText.active = false;
          lbMoney.active = false;
          self.checkRunAgainWin();
        })));
      }, 5);
    });
  },
  runVampireThangLon: function runVampireThangLon() {
    this.SLV.isThangLon = false;
    this.ThangLonCoin.active = true;
    this.ThangText.active = true;
    this.ThangText.getComponent(sp.Skeleton).setAnimation(0, "ThangLon", true);
    var lbMoney = self.node.getChildByName("lb_number_win");
    lbMoney.setPosition(cc.v2(0, -100));
    lbMoney.active = true;
    Helper.numberTo(lbMoney.getComponent(cc.Label), 0, this.SLV.winMoney, 1200, true, function () {
      self.scheduleOnce(function () {
        var d = cc.moveTo(0.5, cc.v2(0, 50));
        lbMoney.runAction(cc.sequence(d, cc.delayTime(0.5), cc.callFunc(function () {
          lbMoney.active = false;
          self.node.getChildByName("bg_all").active = false;
          self.ThangLonCoin.active = false;
          self.ThangText.active = false;
          self.checkRunAgainWin();
        })));
      }, 3);
    });
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcdmFtcGlyZVxcVmFtcGlyZVdpbkdhbWUuanMiXSwibmFtZXMiOlsic2VsZiIsIkhlbHBlciIsInJlcXVpcmUiLCJjYyIsIkNsYXNzIiwiVm96QmFzZUNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJsYk1vbmV5V2luIiwiTGFiZWwiLCJCb251c0ZyZWVTcGluZSIsIk5vZGUiLCJOb0h1Q29pbiIsIlRoYW5nVGV4dCIsIlRoYW5nTG9uQ29pbiIsIkZyZWVDb3VudCIsIk51bWJlckZyZWVTcGluZSIsIm9uTG9hZCIsImluaXQiLCJvYmoiLCJTTFYiLCJydW5XaW5HYW1lIiwiYmdBbGwiLCJub2RlIiwiZ2V0Q2hpbGRCeU5hbWUiLCJhY3RpdmUiLCJpc1RoYW5nTG9uIiwiaXNOb0h1IiwicGxheUJpZ1dpbiIsInJ1blZhbXBpcmVUaGFuZ0xvbiIsInBsYXlKYWNrcG90IiwicnVuVmFtcGlyZU5vSHUiLCJpc0ZyZWUiLCJydW5GcmVlU3BpbmUiLCJpc0JvbnVzIiwicGxheUJvbnVzIiwicnVuQm9udXNTcGluZSIsInNldE1vbmV5V2luIiwid2luTW9uZXkiLCJ1cGRhdGVGcmVlU3BpbiIsInBsYXlTcGluV2luIiwibnVtYmVyVG8iLCJzY2hlZHVsZU9uY2UiLCJhdXRvUXVheSIsInR5cGUiLCJwbGF5U3Bpbk1pcyIsImZyZWVTcGluIiwiZ2V0Q29tcG9uZW50Iiwic3RyaW5nIiwiY2hlY2tSdW5BZ2FpbldpbiIsImlzQXV0byIsInNwIiwiU2tlbGV0b24iLCJzZXRBbmltYXRpb24iLCJzaG93Iiwic3JjIiwicG9wIiwiZGF0YSIsImZyZWVHaWZ0IiwiVGV4dCIsImxiTW9uZXkiLCJzZXRQb3NpdGlvbiIsInYyIiwiZCIsIm1vdmVUbyIsInJ1bkFjdGlvbiIsInNlcXVlbmNlIiwiZGVsYXlUaW1lIiwiY2FsbEZ1bmMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsSUFBSjs7QUFDQSxJQUFJQyxNQUFNLEdB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QVYsQ0FBcEI7QUFDQUYsSUFBQUEsT0FBTyxDQUFDbkMsTUFBUixHQUFpQixJQUFqQjtBQUNBdkIsSUFBQUEsTUFBTSxDQUFDdUMsUUFBUCxDQUFnQm1CLE9BQU8sQ0FBQ2IsWUFBUixDQUFxQjNDLEVBQUUsQ0FBQ0ssS0FBeEIsQ0FBaEIsRUFBZ0QsQ0FBaEQsRUFBbUQsS0FBS1csR0FBTCxDQUFTa0IsUUFBNUQsRUFBc0UsSUFBdEUsRUFBNEUsSUFBNUUsRUFBa0YsWUFBWTtBQUMxRnJDLE1BQUFBLElBQUksQ0FBQ3lDLFlBQUwsQ0FBa0IsWUFBVTtBQUN4QixZQUFJcUIsQ0FBQyxHQUFHM0QsRUFBRSxDQUFDNEQsTUFBSCxDQUFVLEdBQVYsRUFBZTVELEVBQUUsQ0FBQzBELEVBQUgsQ0FBTSxDQUFOLEVBQVMsRUFBVCxDQUFmLENBQVI7QUFDQUYsUUFBQUEsT0FBTyxDQUFDSyxTQUFSLENBQWtCN0QsRUFBRSxDQUFDOEQsUUFBSCxDQUFZSCxDQUFaLEVBQWUzRCxFQUFFLENBQUMrRCxTQUFILENBQWEsR0FBYixDQUFmLEVBQWtDL0QsRUFBRSxDQUFDZ0UsUUFBSCxDQUFZLFlBQVk7QUFDeEVSLFVBQUFBLE9BQU8sQ0FBQ25DLE1BQVIsR0FBaUIsS0FBakI7QUFDQXhCLFVBQUFBLElBQUksQ0FBQ3NCLElBQUwsQ0FBVUMsY0FBVixDQUF5QixRQUF6QixFQUFtQ0MsTUFBbkMsR0FBNkMsS0FBN0M7QUFDQXhCLFVBQUFBLElBQUksQ0FBQ2EsWUFBTCxDQUFrQlcsTUFBbEIsR0FBOEIsS0FBOUI7QUFDQXhCLFVBQUFBLElBQUksQ0FBQ1ksU0FBTCxDQUFlWSxNQUFmLEdBQThCLEtBQTlCO0FBQ0F4QixVQUFBQSxJQUFJLENBQUNnRCxnQkFBTDtBQUNILFNBTm1ELENBQWxDLENBQWxCO0FBT0gsT0FURCxFQVNHLENBVEg7QUFVSCxLQVhEO0FBWUg7QUFySUksQ0FBVCIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsibGV0IHNlbGY7XHJcbmxldCBIZWxwZXIgPSByZXF1aXJlKFwiSGVscGVyXCIpO1xyXG5jYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Wb3pCYXNlQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBsYk1vbmV5V2luICAgICAgICAgIDogY2MuTGFiZWwsXHJcbiAgICAgICAgQm9udXNGcmVlU3BpbmUgICAgICA6IGNjLk5vZGUsXHJcbiAgICAgICAgTm9IdUNvaW4gICAgXHRcdDogY2MuTm9kZSxcclxuICAgICAgICBUaGFuZ1RleHQgICBcdFx0OiBjYy5Ob2RlLFxyXG4gICAgICAgIFRoYW5nTG9uQ29pblx0XHQ6IGNjLk5vZGUsXHJcbiAgICAgICAgRnJlZUNvdW50ICAgICAgICAgICA6IGNjLk5vZGUsXHJcbiAgICAgICAgTnVtYmVyRnJlZVNwaW5lICAgICA6IGNjLk5vZGUsXHJcbiAgICB9LFxyXG5cclxuICAgIG9uTG9hZCAoKSB7XHJcbiAgICAgICAgc2VsZiA9IHRoaXM7XHJcbiAgICB9LFxyXG4gICAgaW5pdChvYmopIHtcclxuICAgICAgICB0aGlzLlNMViA9IG9iajtcclxuICAgIH0sXHJcbiAgICBydW5XaW5HYW1lKCkge1xyXG4gICAgICAgIGxldCBiZ0FsbCAgICAgPSB0aGlzLm5vZGUuZ2V0Q2hpbGRCeU5hbWUoXCJiZ19hbGxcIik7XHJcbiAgICAgICAgYmdBbGwuYWN0aXZlICA9IHRydWU7XHJcbiAgICAgICAgaWYgKHRoaXMuU0xWLmlzVGhhbmdMb24gJiYgIXRoaXMuU0xWLmlzTm9IdSkge1xyXG4gICAgICAgICAgICB0aGlzLlNMVi5wbGF5QmlnV2luKCk7XHJcbiAgICAgICAgICAgIHRoaXMucnVuVmFtcGlyZVRoYW5nTG9uKCk7XHJcbiAgICAgICAgfWVsc2UgaWYgKHRoaXMuU0xWLmlzTm9IdSl7XHJcbiAgICAgICAgICAgIHRoaXMuU0xWLnBsYXlKYWNrcG90KCk7XHJcbiAgICAgICAgICAgIHRoaXMucnVuVmFtcGlyZU5vSHUoKTtcclxuICAgICAgICB9ZWxzZSBpZiAodGhpcy5TTFYuaXNGcmVlKXtcclxuICAgICAgICAgICAgdGhpcy5ydW5GcmVlU3BpbmUoKTtcclxuICAgICAgICB9ZWxzZSBpZiAodGhpcy5TTFYuaXNCb251cyl7XHJcbiAgICAgICAgICAgIHRoaXMuU0xWLnBsYXlCb251cygpO1xyXG4gICAgICAgICAgICB0aGlzLnJ1bkJvbnVzU3BpbmUoKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgc2VsZi5TTFYuc2V0TW9uZXlXaW4oc2VsZi5TTFYud2luTW9uZXkpO1xyXG4gICAgICAgICAgICBzZWxmLnVwZGF0ZUZyZWVTcGluKCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLlNMVi53aW5Nb25leSA+IDApe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5TTFYucGxheVNwaW5XaW4oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGJNb25leVdpbi5ub2RlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBIZWxwZXIubnVtYmVyVG8odGhpcy5sYk1vbmV5V2luLCAwLCB0aGlzLlNMVi53aW5Nb25leSwgMTIwMCwgdHJ1ZSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubGJNb25leVdpbi5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiZ0FsbC5hY3RpdmUgID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuU0xWLmF1dG9RdWF5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgMSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuU0xWLndpbk1vbmV5ICAgPSAwO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIGJnQWxsLmFjdGl2ZSAgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHNlbGYuU0xWLmF1dG9RdWF5KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuU0xWLnR5cGUgPT0gMClcclxuICAgICAgICAgICAgdGhpcy5TTFYucGxheVNwaW5NaXMoKTtcclxuICAgIH0sXHJcbiAgICB1cGRhdGVGcmVlU3BpbigpIHtcclxuICAgICAgICBpZiAodGhpcy5TTFYuZnJlZVNwaW4gPCAxKVxyXG4gICAgICAgICAgICB0aGlzLkZyZWVDb3VudC5hY3RpdmUgICAgICAgPSBmYWxzZTtcclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICB0aGlzLkZyZWVDb3VudC5hY3RpdmUgICAgICAgPSB0cnVlO1xyXG4gICAgICAgICAgICBzZWxmLkZyZWVDb3VudC5nZXRDaGlsZEJ5TmFtZShcImxiX2ZyZWVfc3BpbmVfY291bnRcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBzZWxmLlNMVi5mcmVlU3BpbjtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgY2hlY2tSdW5BZ2FpbldpbigpIHtcclxuICAgICAgICBpZiAodGhpcy5TTFYuaXNCb251cyB8fCB0aGlzLlNMVi53aW5Nb25leSA+IDAgfHwgdGhpcy5TTFYuaXNGcmVlIHx8IHRoaXMuU0xWLmlzTm9IdSB8fCB0aGlzLlNMVi5pc1RoYW5nTG9uIHx8IHRoaXMuU0xWLmlzQXV0bylcclxuICAgICAgICAgICAgdGhpcy5ydW5XaW5HYW1lKCk7XHJcbiAgICB9LFxyXG4gICAgcnVuRnJlZVNwaW5lKCkge1xyXG4gICAgICAgIHRoaXMuU0xWLmlzRnJlZSAgICAgICAgICAgICA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuQm9udXNGcmVlU3BpbmUuYWN0aXZlICA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5OdW1iZXJGcmVlU3BpbmUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLkJvbnVzRnJlZVNwaW5lLmdldENvbXBvbmVudChzcC5Ta2VsZXRvbikuc2V0QW5pbWF0aW9uKDAsICdGcmVlU3BpbmUnLCB0cnVlKTtcclxuICAgICAgICB0aGlzLk51bWJlckZyZWVTcGluZS5nZXRDaGlsZEJ5TmFtZShcImxiX251bWJlcl9mcmVlX3NwaW5lXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gdGhpcy5TTFYuZnJlZVNwaW47XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgc2VsZi5ub2RlLmdldENoaWxkQnlOYW1lKFwiYmdfYWxsXCIpLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBzZWxmLkJvbnVzRnJlZVNwaW5lLmFjdGl2ZSAgPSBmYWxzZTtcclxuICAgICAgICAgICAgc2VsZi5OdW1iZXJGcmVlU3BpbmUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHNlbGYuRnJlZUNvdW50LmFjdGl2ZSAgICAgICA9IHRydWU7XHJcbiAgICAgICAgICAgIHNlbGYuRnJlZUNvdW50LmdldENoaWxkQnlOYW1lKFwibGJfZnJlZV9zcGluZV9jb3VudFwiKS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IHNlbGYuU0xWLmZyZWVTcGluO1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrUnVuQWdhaW5XaW4oKTtcclxuICAgICAgICB9LCAzKTtcclxuICAgIH0sXHJcbiAgICBydW5Cb251c1NwaW5lKCkge1xyXG4gICAgICAgIHRoaXMuU0xWLmlzQm9udXMgICAgICAgICAgICA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuQm9udXNGcmVlU3BpbmUuYWN0aXZlICA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5OdW1iZXJGcmVlU3BpbmUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5Cb251c0ZyZWVTcGluZS5nZXRDb21wb25lbnQoc3AuU2tlbGV0b24pLnNldEFuaW1hdGlvbigwLCAnQm9udXNnYW1lJywgdHJ1ZSk7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgc2VsZi5Cb251c0ZyZWVTcGluZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgc2VsZi5zaG93KFwiVUlWYW1waXJlQm9udXNcIiwge3NyYzogJ3ZhbXBpcmUnLCBwb3A6IHRydWUsIGRhdGE6IHNlbGYuU0xWLmZyZWVHaWZ0fSk7XHJcbiAgICAgICAgfSwgMik7XHJcbiAgICB9LFxyXG4gICAgcnVuVmFtcGlyZU5vSHUoKXtcclxuICAgICAgICB0aGlzLlNMVi5pc05vSHUgICAgICAgICAgICAgICA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuTm9IdUNvaW4uYWN0aXZlICA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5UZXh0LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5UaGFuZ1RleHQuZ2V0Q29tcG9uZW50KHNwLlNrZWxldG9uKS5zZXRBbmltYXRpb24oMCwgXCJOb0h1XCIsIHRydWUpO1xyXG4gICAgICAgIGxldCBsYk1vbmV5ID0gc2VsZi5ub2RlLmdldENoaWxkQnlOYW1lKFwibGJfbnVtYmVyX3dpblwiKTtcclxuICAgICAgICBsYk1vbmV5LnNldFBvc2l0aW9uKGNjLnYyKDAsIC0xNjApKTtcclxuICAgICAgICBsYk1vbmV5LmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgSGVscGVyLm51bWJlclRvKGxiTW9uZXkuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKSwgMCwgdGhpcy5TTFYud2luTW9uZXksIDEyMDAsIHRydWUsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgc2VsZi5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIGxldCBkID0gY2MubW92ZVRvKDAuNSwgY2MudjIoMCwgNTApKTtcclxuICAgICAgICAgICAgICAgIGxiTW9uZXkucnVuQWN0aW9uKGNjLnNlcXVlbmNlKGQsIGNjLmRlbGF5VGltZSgxKSwgY2MuY2FsbEZ1bmMoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYubm9kZS5nZXRDaGlsZEJ5TmFtZShcImJnX2FsbFwiKS5hY3RpdmUgID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5Ob0h1Q29pbi5hY3RpdmUgID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5UaGFuZ1RleHQuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgbGJNb25leS5hY3RpdmUgICAgICAgICAgICAgICAgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNoZWNrUnVuQWdhaW5XaW4oKTtcclxuICAgICAgICAgICAgICAgIH0pKSk7XHJcbiAgICAgICAgICAgIH0sIDUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIHJ1blZhbXBpcmVUaGFuZ0xvbigpe1xyXG4gICAgICAgIHRoaXMuU0xWLmlzVGhhbmdMb24gPSBmYWxzZTtcclxuICAgICAgICB0aGlzLlRoYW5nTG9uQ29pbi5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuVGhhbmdUZXh0LmFjdGl2ZSAgICA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5UaGFuZ1RleHQuZ2V0Q29tcG9uZW50KHNwLlNrZWxldG9uKS5zZXRBbmltYXRpb24oMCwgXCJUaGFuZ0xvblwiLCB0cnVlKTtcclxuICAgICAgICBsZXQgbGJNb25leSA9IHNlbGYubm9kZS5nZXRDaGlsZEJ5TmFtZShcImxiX251bWJlcl93aW5cIik7XHJcbiAgICAgICAgbGJNb25leS5zZXRQb3NpdGlvbihjYy52MigwLCAtMTAwKSk7XHJcbiAgICAgICAgbGJNb25leS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIEhlbHBlci5udW1iZXJUbyhsYk1vbmV5LmdldENvbXBvbmVudChjYy5MYWJlbCksIDAsIHRoaXMuU0xWLndpbk1vbmV5LCAxMjAwLCB0cnVlLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHNlbGYuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICBsZXQgZCA9IGNjLm1vdmVUbygwLjUsIGNjLnYyKDAsIDUwKSk7XHJcbiAgICAgICAgICAgICAgICBsYk1vbmV5LnJ1bkFjdGlvbihjYy5zZXF1ZW5jZShkLCBjYy5kZWxheVRpbWUoMC41KSwgY2MuY2FsbEZ1bmMoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxiTW9uZXkuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub2RlLmdldENoaWxkQnlOYW1lKFwiYmdfYWxsXCIpLmFjdGl2ZSAgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLlRoYW5nTG9uQ29pbi5hY3RpdmUgICAgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLlRoYW5nVGV4dC5hY3RpdmUgICAgICAgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNoZWNrUnVuQWdhaW5XaW4oKTtcclxuICAgICAgICAgICAgICAgIH0pKSk7XHJcbiAgICAgICAgICAgIH0sIDMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxufSk7XHJcbiJdfQ==