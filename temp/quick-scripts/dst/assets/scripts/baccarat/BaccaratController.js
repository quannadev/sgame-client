
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/baccarat/BaccaratController.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'e9744KaYgtCGKi7vCAoyyMZ', 'BaccaratController');
// scripts/baccarat/BaccaratController.js

"use strict";

var BaccaratEvent = require('BaccaratEvent');

var BaccaratController = SmartFoxSDK.BaseController.extend({
  m_tableInfo: {},
  registerEvents: function registerEvents() {
    this._super();

    this.ZoneInstance.addEventListenerExtension(BaccaratEvent.RESPONSE_NAME.LOAD_GAME_RES, this.onLoadGameEvent, this);
    this.ZoneInstance.addEventListenerExtension(BaccaratEvent.RESPONSE_NAME.BET_RES, this.onUserBetEvent, this);
    this.ZoneInstance.addEventListenerExtension(BaccaratEvent.RESPONSE_NAME.END_BETTING, this.onEndBettingEvent, this);
    this.ZoneInstance.addEventListenerExtension(BaccaratEvent.RESPONSE_NAME.HISTORY_RESULT, this.onHistoryResultEvent, this);
    this.ZoneInstance.addEventListenerExtension(BaccaratEvent.RESPONSE_NAME.HISTORY_DETAIL, this.HistoryDetailEvent, this);
  },
  removeEvents: function removeEvents() {
    this._super();

    this.ZoneInstance.removeEventListenerExtension(BaccaratEvent.RESPONSE_NAME.LOAD_GAME_RES, this.onLoadGameEvent, this);
    this.ZoneInstance.removeEventListenerExtension(BaccaratEvent.RESPONSE_NAME.BET_RES, this.onUserBetEvent, this);
    this.ZoneInstance.removeEventListenerExtension(BaccaratEvent.RESPONSE_NAME.END_BETTING, this.onEndBettingEvent, this);
    this.ZoneInstance.removeEventListenerExtension(BaccaratEvent.RESPONSE_NAME.HISTORY_RESULT, this.onHistoryResultEvent, this);
    this.ZoneInstance.removeEventListenerExtension(BaccaratEvent.RESPONSE_NAME.HISTORY_DETAIL, this.HistoryDetailEvent, this);
  },
  onEventLogin: function onEventLogin(event) {
    this._super(event);

    this._requestJoinRoom(this.zoneName);
  },
  onEventUserExitRoom: function onEventUserExitRoom(event) {
    var user = event.user;

    if (user.isItMe) {
      if (this.getUI() != null) this.getUI().node.active = false;
      UIManger.show("UIHome");
    }
  },
  onLoadGameEvent: function onLoadGameEvent(event) {
    this.preLoadUI({
      pop: true
    }, function () {
      this.m_tableInfo = new BaccaratEvent.LoadGameEvent().fromEvent(event);
      this.getUI().hideAll();
      this.getUI().showListMyChipBet(this.m_tableInfo.listMyChipPot);
      this.getUI().showListChipBet(this.m_tableInfo.listChipPot);
      var users = [];
      users.push(this.ZoneInstance.mySelf);

      for (var i = 0; i < this.getRoom().getUserList().length; i++) {
        var u = this.getRoom().getUserList()[i];

        if (u.name != this.ZoneInstance.mySelf.name && users.length < 6) {
          users.push(u);
        }
      }

      this.getUI().showListUsers(users);
      this.getUI().updateCau(this.m_tableInfo.allCau);

      if (this.m_tableInfo.isBetting) {
        this.getUI()._turnOnTime(this.m_tableInfo.time, this.m_tableInfo.time, this.m_tableInfo.isBetting);

        if (this.m_tableInfo.time >= 29) {
          this.getUI().showNoti("Bắt đầu cược");
        }

        this.getUI().runEffectGirl("1");
      } else {
        this.getUI()._turnOffTime();

        this.getUI()._turnOnTime(this.m_tableInfo.time, this.m_tableInfo.time, this.m_tableInfo.isBetting);

        this.getUI().resumeGame(this.m_tableInfo.cardPlayer, this.m_tableInfo.cardBanker, this.m_tableInfo.winpot, this.m_tableInfo.time, this.m_tableInfo.usersOnboard, this.m_tableInfo.chipUserOnBoard);
      }
    }.bind(this));
  },
  onUserBetEvent: function onUserBetEvent(event) {
    var userBet = new BaccaratEvent.BetEvent().fromEvent(event);
    var userName = userBet.userName;
    var betChip = userBet.betChip;
    var typePot = userBet.typePot;
    this.m_tableInfo.listChipPot[typePot] += betChip;
    this.getUI().showListChipBet(this.m_tableInfo.listChipPot);

    if (this.ZoneInstance.mySelf.name == userName) {
      this.m_tableInfo.listMyChipPot[typePot] += betChip;
      this.getUI().showListMyChipBet(this.m_tableInfo.listMyChipPot);
    }

    this.getUI().runActionChangeMoney(userName, -betChip, 1);
    this.getUI().actionFlyChipToPot(userName, typePot, betChip);
    var user = this.getRoom().getUserByName(userName);
    if (user) this.getUI().updateChip(user);
  },
  onEndBettingEvent: function onEndBettingEvent(event) {
    var endBetting = new BaccaratEvent.EndBetting().fromEvent(event);
    this.m_tableInfo.isBetting = false;
    this.m_tableInfo.chipUserOnBoard = endBetting.chipUserOnBoard;
    this.m_tableInfo.usersOnboard = endBetting.usersOnboard;
    this.m_tableInfo.cardPlayer = endBetting.cardPlayer;
    this.m_tableInfo.cardBanker = endBetting.cardBanker;
    this.m_tableInfo.winpot = endBetting.winpot;

    this.getUI()._turnOffTime();

    this.getUI()._turnOnTime(20, 20, this.m_tableInfo.isBetting);

    this.getUI().showNoti("Dừng đặt cược");
    this.getUI().showResult(this.m_tableInfo.cardPlayer, this.m_tableInfo.cardBanker, this.m_tableInfo.winpot, this.m_tableInfo.chipUserOnBoard, this.m_tableInfo.usersOnboard, 1);
  },
  onHistoryResultEvent: function onHistoryResultEvent(event) {},
  HistoryDetailEvent: function HistoryDetailEvent(event) {
    var allCau = new BaccaratEvent.HistoryDetailEvent().fromEvent(event);
    this.getUI().showSoiCau(allCau);
  },
  onHistoryEvent: function onHistoryEvent(event) {
    var items = new BaccaratEvent.HistoryEvent().fromEvent(event);
    this.getUI().show("UIBaccaratTransaction", {
      pop: true,
      src: 'baccarat',
      data: {
        items: items
      }
    });
  },
  onLeaderBoardEvent: function onLeaderBoardEvent(event) {
    var items = new BaccaratEvent.LeaderBoardEvent().fromEvent(event);
    this.getUI().show("UIBaccaratRank", {
      pop: true,
      src: 'baccarat',
      data: {
        items: items
      }
    });
  },
  onPublicMessage: function onPublicMessage(event) {
    var sender = event.sender;
    var msg = event.message;
    var data = event.data;
    var dataSender = data != null ? {
      dn: data.get("dn"),
      fb: data.get("fb")
    } : {
      dn: "...",
      fb: ""
    };
    var msgItem = {};
    msgItem.sender = sender;
    msgItem.msg = msg;
    msgItem.dataSender = dataSender;
    this.getUI().onPublicMessage(msgItem);
  }
});
var instance = null;

var getInstance = function getInstance() {
  if (instance == null) instance = new BaccaratController('UIBaccarat', 'baccarat');
  return instance;
};

SmartFoxSDK.BaccaratController = module.exports = getInstance();

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcYmFjY2FyYXRcXEJhY2NhcmF0Q29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJCYWNjYXJhdEV2ZW50IiwicmVxdWlyZSIsIkJhY2NhcmF0Q29udHJvbGxlciIsIlNtYXJ0Rm94U0RLIiwiQmFzZUNvbnRyb2xsZXIiLCJleHRlbmQiLCJtX3RhYmxlSW5mbyIsInJlZ2lzdGVyRXZlbnRzIiwiX3N1cGVyIiwiWm9uZUluc3RhbmNlIiwiYWRkRXZlbnRMaXN0ZW5lckV4dGVuc2lvbiIsIlJFU1BPTlNFX05BTUUiLCJMT0FEX0dBTUVfUkVTIiwib25Mb2FkR2FtZUV2ZW50IiwiQkVUX1JFUyIsIm9uVXNlckJldEV2ZW50IiwiRU5EX0JFVFRJTkciLCJvbkVuZEJldHRpbmdFdmVudCIsIkhJU1RPUllfUkVTVUxUIiwib25IaXN0b3J5UmVzdWx0RXZlbnQiLCJISVNUT1JZX0RFVEFJTCIsIkhpc3RvcnlEZXRhaWxFdmVudCIsInJlbW92ZUV2ZW50cyIsInJlbW92ZUV2ZW50TGlzdGVuZXJFeHRlbnNpb24iLCJvbkV2ZW50TG9naW4iLCJldmVudCIsIl9yZXF1ZXN0Sm9pblJvb20iLCJ6b25lTmFtZSIsIm9uRXZlbnRVc2VyRXhpdFJvb20iLCJ1c2VyIiwiaXNJdE1lIiwiZ2V0VUkiLCJub2RlIiwiYWN0aXZlIiwiVUlNYW5nZXIiLCJzaG93IiwicHJlTG9hZFVJIiwicG9wIiwiTG9hZEdhbWVFdmVudCIsImZyb21FdmVudCIsImhpZGVBbGwiLCJzaG93TGlzdE15Q2hpcEJldCIsImxpc3RNeUNoaXBQb3QiLCJzaG93TGlzdENoaXBCZXQiLCJsaXN0Q2hpcFBvdCIsInVzZXJzIiwicHVzaCIsIm15U2VsZiIsImkiLCJnZXRSb29tIiwiZ2V0VXNlckxpc3QiLCJsZW5ndGgiLCJ1IiwibmFtZSIsInNob3dMaXN0VXNlcnMiLCJ1cGRhdGVDYXUiLCJhbGxDYXUiLCJpc0JldHRpbmciLCJfdHVybk9uVGltZSIsInRpbWUiLCJzaG93Tm90aSIsInJ1bkVmZmVjdEdpcmwiLCJfdHVybk9mZlRpbWUiLCJyZXN1bWVHYW1lIiwiY2FyZFBsYXllciIsImNhcmRCYW5rZXIiLCJ3aW5wb3QiLCJ1c2Vyc09uYm9hcmQiLCJjaGlwVXNlck9uQm9hcmQiLCJiaW5kIiwidXNlckJldCIsIkJldEV2ZW50IiwidXNlck5hbWUiLCJiZXRDaGlwIiwidHlwZVBvdCIsInJ1bkFjdGlvbkNoYW5nZU1vbmV5IiwiYWN0aW9uRmx5Q2hpcFRvUG90IiwiZ2V0VXNlckJ5TmFtZSIsInVwZGF0ZUNoaXAiLCJlbmRCZXR0aW5nIiwiRW5kQmV0dGluZyIsInNob3dSZXN1bHQiLCJzaG93U29pQ2F1Iiwib25IaXN0b3J5RXZlbnQiLCJpdGVtcyIsIkhpc3RvcnlFdmVudCIsInNyYyIsImRhdGEiLCJvbkxlYWRlckJvYXJkRXZlbnQiLCJMZWFkZXJCb2FyZEV2ZW50Iiwib25QdWJsaWNNZXNzYWdlIiwic2VuZGVyIiwibXNnIiwibWVzc2FnZSIsImRhdGFTZW5kZXIiLCJkbiIsImdldCIsImZiIiwibXNnSXRlbSIsImluc3RhbmNlIiwiZ2V0SW5zdGFuY2UiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLGFBQWEsR0FBR0MsT0FBTyxDQUFDLGVBQUQsQ0FBM0I7O0FBQ0EsSUFBSUMsa0JBQWtCLEdBQUdDLFdBQVcsQ0FBQ0MsY0FBWixDQUEyQkMsTUFBM0IsQ0FBa0M7QUFDdkRDLEVBQUFBLFdBQVcsRUFBRyxFQUR5QztBQUV2REMsRUFBQUEsY0FGdUQsNEJBRXZDO0FBQ1osU0FBS0MsTUFBTDs7QUFDQSxTQUFLQyxZQUFMLENBQWtCQyx5QkFBbEIsQ0FBNENWLGFBQWEsQ0FBQ1csYUFBZCxDQUE0QkMsYUFBeEUsRUFBdUYsS0FBS0MsZUFBNUYsRUFBNkcsSUFBN0c7QUFDQSxTQUFLSixZQUFMLENBQWtCQyx5QkFBbEIsQ0FBNENWLGFBQWEsQ0FBQ1csYUFBZCxDQUE0QkcsT0FBeEUsRUFBaUYsS0FBS0MsY0FBdEYs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QUFDbEIsUUFBSWtFLE1BQU0sR0FBR2xFLEtBQUssQ0FBQ2tFLE1BQW5CO0FBQ0EsUUFBSUMsR0FBRyxHQUFHbkUsS0FBSyxDQUFDb0UsT0FBaEI7QUFDQSxRQUFJTixJQUFJLEdBQUc5RCxLQUFLLENBQUM4RCxJQUFqQjtBQUNBLFFBQUlPLFVBQVUsR0FBR1AsSUFBSSxJQUFJLElBQVIsR0FBZTtBQUFDUSxNQUFBQSxFQUFFLEVBQUVSLElBQUksQ0FBQ1MsR0FBTCxDQUFTLElBQVQsQ0FBTDtBQUFxQkMsTUFBQUEsRUFBRSxFQUFHVixJQUFJLENBQUNTLEdBQUwsQ0FBUyxJQUFUO0FBQTFCLEtBQWYsR0FBMkQ7QUFBQ0QsTUFBQUEsRUFBRSxFQUFFLEtBQUw7QUFBWUUsTUFBQUEsRUFBRSxFQUFHO0FBQWpCLEtBQTVFO0FBQ0EsUUFBSUMsT0FBTyxHQUFHLEVBQWQ7QUFDQUEsSUFBQUEsT0FBTyxDQUFDUCxNQUFSLEdBQWlCQSxNQUFqQjtBQUNBTyxJQUFBQSxPQUFPLENBQUNOLEdBQVIsR0FBY0EsR0FBZDtBQUNBTSxJQUFBQSxPQUFPLENBQUNKLFVBQVIsR0FBcUJBLFVBQXJCO0FBQ0EsU0FBSy9ELEtBQUwsR0FBYTJELGVBQWIsQ0FBNkJRLE9BQTdCO0FBQ0g7QUFuSHNELENBQWxDLENBQXpCO0FBcUhBLElBQUlDLFFBQVEsR0FBRyxJQUFmOztBQUNBLElBQUlDLFdBQVcsR0FBRyxTQUFkQSxXQUFjLEdBQVk7QUFDMUIsTUFBR0QsUUFBUSxJQUFJLElBQWYsRUFDSUEsUUFBUSxHQUFHLElBQUlqRyxrQkFBSixDQUF1QixZQUF2QixFQUFxQyxVQUFyQyxDQUFYO0FBQ0osU0FBT2lHLFFBQVA7QUFDSCxDQUpEOztBQUtBaEcsV0FBVyxDQUFDRCxrQkFBWixHQUFpQ21HLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQkYsV0FBVyxFQUE3RCIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsibGV0IEJhY2NhcmF0RXZlbnQgPSByZXF1aXJlKCdCYWNjYXJhdEV2ZW50JylcclxubGV0IEJhY2NhcmF0Q29udHJvbGxlciA9IFNtYXJ0Rm94U0RLLkJhc2VDb250cm9sbGVyLmV4dGVuZCh7XHJcbiAgICBtX3RhYmxlSW5mbyA6IHt9LFxyXG4gICAgcmVnaXN0ZXJFdmVudHMoKXtcclxuICAgICAgICB0aGlzLl9zdXBlcigpO1xyXG4gICAgICAgIHRoaXMuWm9uZUluc3RhbmNlLmFkZEV2ZW50TGlzdGVuZXJFeHRlbnNpb24oQmFjY2FyYXRFdmVudC5SRVNQT05TRV9OQU1FLkxPQURfR0FNRV9SRVMsIHRoaXMub25Mb2FkR2FtZUV2ZW50LCB0aGlzKTtcclxuICAgICAgICB0aGlzLlpvbmVJbnN0YW5jZS5hZGRFdmVudExpc3RlbmVyRXh0ZW5zaW9uKEJhY2NhcmF0RXZlbnQuUkVTUE9OU0VfTkFNRS5CRVRfUkVTLCB0aGlzLm9uVXNlckJldEV2ZW50LCB0aGlzKTtcclxuICAgICAgICB0aGlzLlpvbmVJbnN0YW5jZS5hZGRFdmVudExpc3RlbmVyRXh0ZW5zaW9uKEJhY2NhcmF0RXZlbnQuUkVTUE9OU0VfTkFNRS5FTkRfQkVUVElORywgdGhpcy5vbkVuZEJldHRpbmdFdmVudCwgdGhpcyk7XHJcbiAgICAgICAgdGhpcy5ab25lSW5zdGFuY2UuYWRkRXZlbnRMaXN0ZW5lckV4dGVuc2lvbihCYWNjYXJhdEV2ZW50LlJFU1BPTlNFX05BTUUuSElTVE9SWV9SRVNVTFQsIHRoaXMub25IaXN0b3J5UmVzdWx0RXZlbnQsIHRoaXMpO1xyXG4gICAgICAgIHRoaXMuWm9uZUluc3RhbmNlLmFkZEV2ZW50TGlzdGVuZXJFeHRlbnNpb24oQmFjY2FyYXRFdmVudC5SRVNQT05TRV9OQU1FLkhJU1RPUllfREVUQUlMLCB0aGlzLkhpc3RvcnlEZXRhaWxFdmVudCwgdGhpcyk7XHJcbiAgICB9LFxyXG4gICAgcmVtb3ZlRXZlbnRzKCl7XHJcbiAgICAgICAgdGhpcy5fc3VwZXIoKTtcclxuICAgICAgICB0aGlzLlpvbmVJbnN0YW5jZS5yZW1vdmVFdmVudExpc3RlbmVyRXh0ZW5zaW9uKEJhY2NhcmF0RXZlbnQuUkVTUE9OU0VfTkFNRS5MT0FEX0dBTUVfUkVTLCB0aGlzLm9uTG9hZEdhbWVFdmVudCwgdGhpcyk7XHJcbiAgICAgICAgdGhpcy5ab25lSW5zdGFuY2UucmVtb3ZlRXZlbnRMaXN0ZW5lckV4dGVuc2lvbihCYWNjYXJhdEV2ZW50LlJFU1BPTlNFX05BTUUuQkVUX1JFUywgdGhpcy5vblVzZXJCZXRFdmVudCwgdGhpcyk7XHJcbiAgICAgICAgdGhpcy5ab25lSW5zdGFuY2UucmVtb3ZlRXZlbnRMaXN0ZW5lckV4dGVuc2lvbihCYWNjYXJhdEV2ZW50LlJFU1BPTlNFX05BTUUuRU5EX0JFVFRJTkcsIHRoaXMub25FbmRCZXR0aW5nRXZlbnQsIHRoaXMpO1xyXG4gICAgICAgIHRoaXMuWm9uZUluc3RhbmNlLnJlbW92ZUV2ZW50TGlzdGVuZXJFeHRlbnNpb24oQmFjY2FyYXRFdmVudC5SRVNQT05TRV9OQU1FLkhJU1RPUllfUkVTVUxULCB0aGlzLm9uSGlzdG9yeVJlc3VsdEV2ZW50LCB0aGlzKTtcclxuICAgICAgICB0aGlzLlpvbmVJbnN0YW5jZS5yZW1vdmVFdmVudExpc3RlbmVyRXh0ZW5zaW9uKEJhY2NhcmF0RXZlbnQuUkVTUE9OU0VfTkFNRS5ISVNUT1JZX0RFVEFJTCwgdGhpcy5IaXN0b3J5RGV0YWlsRXZlbnQsIHRoaXMpO1xyXG4gICAgfSxcclxuICAgIG9uRXZlbnRMb2dpbihldmVudCl7XHJcbiAgICAgICAgdGhpcy5fc3VwZXIoZXZlbnQpO1xyXG4gICAgICAgIHRoaXMuX3JlcXVlc3RKb2luUm9vbSh0aGlzLnpvbmVOYW1lKTtcclxuICAgIH0sXHJcbiAgICBvbkV2ZW50VXNlckV4aXRSb29tKGV2ZW50KXtcclxuICAgICAgICBsZXQgdXNlciA9IGV2ZW50LnVzZXI7XHJcbiAgICAgICAgaWYodXNlci5pc0l0TWUpe1xyXG4gICAgICAgICAgICBpZiAodGhpcy5nZXRVSSgpICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldFVJKCkubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgVUlNYW5nZXIuc2hvdyhcIlVJSG9tZVwiKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgb25Mb2FkR2FtZUV2ZW50KGV2ZW50KXtcclxuICAgICAgICB0aGlzLnByZUxvYWRVSSh7cG9wOiB0cnVlfSxmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMubV90YWJsZUluZm8gPSBuZXcgQmFjY2FyYXRFdmVudC5Mb2FkR2FtZUV2ZW50KCkuZnJvbUV2ZW50KGV2ZW50KTtcclxuICAgICAgICAgICAgdGhpcy5nZXRVSSgpLmhpZGVBbGwoKTtcclxuICAgICAgICAgICAgdGhpcy5nZXRVSSgpLnNob3dMaXN0TXlDaGlwQmV0KHRoaXMubV90YWJsZUluZm8ubGlzdE15Q2hpcFBvdCk7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0VUkoKS5zaG93TGlzdENoaXBCZXQodGhpcy5tX3RhYmxlSW5mby5saXN0Q2hpcFBvdCk7XHJcblxyXG4gICAgICAgICAgICBsZXQgdXNlcnMgPSBbXTtcclxuICAgICAgICAgICAgdXNlcnMucHVzaCh0aGlzLlpvbmVJbnN0YW5jZS5teVNlbGYpO1xyXG4gICAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5nZXRSb29tKCkuZ2V0VXNlckxpc3QoKS5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgICAgIGxldCB1ID0gdGhpcy5nZXRSb29tKCkuZ2V0VXNlckxpc3QoKVtpXTtcclxuICAgICAgICAgICAgICAgIGlmKHUubmFtZSAhPSB0aGlzLlpvbmVJbnN0YW5jZS5teVNlbGYubmFtZSAmJiB1c2Vycy5sZW5ndGggPCA2KXtcclxuICAgICAgICAgICAgICAgICAgICB1c2Vycy5wdXNoKHUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0VUkoKS5zaG93TGlzdFVzZXJzKHVzZXJzKTtcclxuICAgICAgICAgICAgdGhpcy5nZXRVSSgpLnVwZGF0ZUNhdSh0aGlzLm1fdGFibGVJbmZvLmFsbENhdSk7XHJcbiAgICAgICAgICAgIGlmKHRoaXMubV90YWJsZUluZm8uaXNCZXR0aW5nKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0VUkoKS5fdHVybk9uVGltZSh0aGlzLm1fdGFibGVJbmZvLnRpbWUsIHRoaXMubV90YWJsZUluZm8udGltZSwgdGhpcy5tX3RhYmxlSW5mby5pc0JldHRpbmcpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubV90YWJsZUluZm8udGltZSA+PTI5KXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdldFVJKCkuc2hvd05vdGkoXCJC4bqvdCDEkeG6p3UgY8aw4bujY1wiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0VUkoKS5ydW5FZmZlY3RHaXJsKFwiMVwiKTtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldFVJKCkuX3R1cm5PZmZUaW1lKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldFVJKCkuX3R1cm5PblRpbWUodGhpcy5tX3RhYmxlSW5mby50aW1lLCB0aGlzLm1fdGFibGVJbmZvLnRpbWUsIHRoaXMubV90YWJsZUluZm8uaXNCZXR0aW5nKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0VUkoKS5yZXN1bWVHYW1lKHRoaXMubV90YWJsZUluZm8uY2FyZFBsYXllciwgdGhpcy5tX3RhYmxlSW5mby5jYXJkQmFua2VyLCB0aGlzLm1fdGFibGVJbmZvLndpbnBvdCwgdGhpcy5tX3RhYmxlSW5mby50aW1lLCB0aGlzLm1fdGFibGVJbmZvLnVzZXJzT25ib2FyZCwgdGhpcy5tX3RhYmxlSW5mby5jaGlwVXNlck9uQm9hcmQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfS5iaW5kKHRoaXMpKVxyXG4gICAgfSxcclxuICAgIG9uVXNlckJldEV2ZW50KGV2ZW50KXtcclxuICAgICAgICBsZXQgdXNlckJldCA9IG5ldyBCYWNjYXJhdEV2ZW50LkJldEV2ZW50KCkuZnJvbUV2ZW50KGV2ZW50KTtcclxuICAgICAgICBsZXQgdXNlck5hbWUgPSB1c2VyQmV0LnVzZXJOYW1lO1xyXG4gICAgICAgIGxldCBiZXRDaGlwID0gdXNlckJldC5iZXRDaGlwO1xyXG4gICAgICAgIGxldCB0eXBlUG90ID0gdXNlckJldC50eXBlUG90O1xyXG4gICAgICAgIHRoaXMubV90YWJsZUluZm8ubGlzdENoaXBQb3RbdHlwZVBvdF0gKz0gYmV0Q2hpcDtcclxuICAgICAgICB0aGlzLmdldFVJKCkuc2hvd0xpc3RDaGlwQmV0KHRoaXMubV90YWJsZUluZm8ubGlzdENoaXBQb3QpO1xyXG4gICAgICAgIGlmKHRoaXMuWm9uZUluc3RhbmNlLm15U2VsZi5uYW1lID09IHVzZXJOYW1lKXtcclxuICAgICAgICAgICAgdGhpcy5tX3RhYmxlSW5mby5saXN0TXlDaGlwUG90W3R5cGVQb3RdICs9IGJldENoaXA7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0VUkoKS5zaG93TGlzdE15Q2hpcEJldCh0aGlzLm1fdGFibGVJbmZvLmxpc3RNeUNoaXBQb3QpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmdldFVJKCkucnVuQWN0aW9uQ2hhbmdlTW9uZXkodXNlck5hbWUsIC1iZXRDaGlwLCAxKTtcclxuICAgICAgICB0aGlzLmdldFVJKCkuYWN0aW9uRmx5Q2hpcFRvUG90KHVzZXJOYW1lLCB0eXBlUG90LCBiZXRDaGlwKTtcclxuICAgICAgICBsZXQgdXNlciA9IHRoaXMuZ2V0Um9vbSgpLmdldFVzZXJCeU5hbWUodXNlck5hbWUpO1xyXG4gICAgICAgIGlmKHVzZXIpXHJcbiAgICAgICAgICAgIHRoaXMuZ2V0VUkoKS51cGRhdGVDaGlwKHVzZXIpO1xyXG4gICAgfSxcclxuICAgIG9uRW5kQmV0dGluZ0V2ZW50KGV2ZW50KXtcclxuICAgICAgICBsZXQgZW5kQmV0dGluZyA9IG5ldyBCYWNjYXJhdEV2ZW50LkVuZEJldHRpbmcoKS5mcm9tRXZlbnQoZXZlbnQpO1xyXG4gICAgICAgIHRoaXMubV90YWJsZUluZm8uaXNCZXR0aW5nICAgICAgID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5tX3RhYmxlSW5mby5jaGlwVXNlck9uQm9hcmQgPSBlbmRCZXR0aW5nLmNoaXBVc2VyT25Cb2FyZDtcclxuICAgICAgICB0aGlzLm1fdGFibGVJbmZvLnVzZXJzT25ib2FyZCAgICA9IGVuZEJldHRpbmcudXNlcnNPbmJvYXJkO1xyXG4gICAgICAgIHRoaXMubV90YWJsZUluZm8uY2FyZFBsYXllciAgICAgID0gZW5kQmV0dGluZy5jYXJkUGxheWVyO1xyXG4gICAgICAgIHRoaXMubV90YWJsZUluZm8uY2FyZEJhbmtlciAgICAgID0gZW5kQmV0dGluZy5jYXJkQmFua2VyO1xyXG4gICAgICAgIHRoaXMubV90YWJsZUluZm8ud2lucG90ICAgICAgICAgID0gZW5kQmV0dGluZy53aW5wb3Q7XHJcbiAgICAgICAgdGhpcy5nZXRVSSgpLl90dXJuT2ZmVGltZSgpO1xyXG4gICAgICAgIHRoaXMuZ2V0VUkoKS5fdHVybk9uVGltZSgyMCwgMjAsIHRoaXMubV90YWJsZUluZm8uaXNCZXR0aW5nKTtcclxuICAgICAgICB0aGlzLmdldFVJKCkuc2hvd05vdGkoXCJE4burbmcgxJHhurd0IGPGsOG7o2NcIik7XHJcbiAgICAgICAgdGhpcy5nZXRVSSgpLnNob3dSZXN1bHQodGhpcy5tX3RhYmxlSW5mby5jYXJkUGxheWVyLCB0aGlzLm1fdGFibGVJbmZvLmNhcmRCYW5rZXIsIHRoaXMubV90YWJsZUluZm8ud2lucG90LCAgdGhpcy5tX3RhYmxlSW5mby5jaGlwVXNlck9uQm9hcmQsICB0aGlzLm1fdGFibGVJbmZvLnVzZXJzT25ib2FyZCwgMSk7XHJcbiAgICB9LFxyXG4gICAgb25IaXN0b3J5UmVzdWx0RXZlbnQoZXZlbnQpe1xyXG5cclxuICAgIH0sXHJcbiAgICBIaXN0b3J5RGV0YWlsRXZlbnQoZXZlbnQpe1xyXG4gICAgICAgIGxldCBhbGxDYXUgPSBuZXcgQmFjY2FyYXRFdmVudC5IaXN0b3J5RGV0YWlsRXZlbnQoKS5mcm9tRXZlbnQoZXZlbnQpO1xyXG4gICAgICAgIHRoaXMuZ2V0VUkoKS5zaG93U29pQ2F1KGFsbENhdSk7XHJcbiAgICB9LFxyXG4gICAgb25IaXN0b3J5RXZlbnQoZXZlbnQpe1xyXG4gICAgICAgIGxldCBpdGVtcyA9IG5ldyBCYWNjYXJhdEV2ZW50Lkhpc3RvcnlFdmVudCgpLmZyb21FdmVudChldmVudCk7XHJcbiAgICAgICAgdGhpcy5nZXRVSSgpLnNob3coXCJVSUJhY2NhcmF0VHJhbnNhY3Rpb25cIiwge3BvcDogdHJ1ZSwgc3JjOiAnYmFjY2FyYXQnLCBkYXRhOiB7aXRlbXM6IGl0ZW1zfX0pO1xyXG4gICAgfSxcclxuICAgIG9uTGVhZGVyQm9hcmRFdmVudChldmVudCl7XHJcbiAgICAgICAgbGV0IGl0ZW1zID0gbmV3IEJhY2NhcmF0RXZlbnQuTGVhZGVyQm9hcmRFdmVudCgpLmZyb21FdmVudChldmVudCk7XHJcbiAgICAgICAgdGhpcy5nZXRVSSgpLnNob3coXCJVSUJhY2NhcmF0UmFua1wiLCB7cG9wOiB0cnVlLCBzcmM6ICdiYWNjYXJhdCcsIGRhdGE6IHtpdGVtczogaXRlbXN9fSk7XHJcbiAgICB9LFxyXG4gICAgb25QdWJsaWNNZXNzYWdlKGV2ZW50KXtcclxuICAgICAgICBsZXQgc2VuZGVyID0gZXZlbnQuc2VuZGVyO1xyXG4gICAgICAgIGxldCBtc2cgPSBldmVudC5tZXNzYWdlO1xyXG4gICAgICAgIGxldCBkYXRhID0gZXZlbnQuZGF0YTtcclxuICAgICAgICBsZXQgZGF0YVNlbmRlciA9IGRhdGEgIT0gbnVsbCA/IHtkbjogZGF0YS5nZXQoXCJkblwiKSwgZmIgOiBkYXRhLmdldChcImZiXCIpfSA6IHtkbjogXCIuLi5cIiwgZmIgOiBcIlwifTtcclxuICAgICAgICBsZXQgbXNnSXRlbSA9IHt9O1xyXG4gICAgICAgIG1zZ0l0ZW0uc2VuZGVyID0gc2VuZGVyO1xyXG4gICAgICAgIG1zZ0l0ZW0ubXNnID0gbXNnO1xyXG4gICAgICAgIG1zZ0l0ZW0uZGF0YVNlbmRlciA9IGRhdGFTZW5kZXI7XHJcbiAgICAgICAgdGhpcy5nZXRVSSgpLm9uUHVibGljTWVzc2FnZShtc2dJdGVtKTtcclxuICAgIH0sXHJcbn0pO1xyXG5sZXQgaW5zdGFuY2UgPSBudWxsO1xyXG5sZXQgZ2V0SW5zdGFuY2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZihpbnN0YW5jZSA9PSBudWxsKVxyXG4gICAgICAgIGluc3RhbmNlID0gbmV3IEJhY2NhcmF0Q29udHJvbGxlcignVUlCYWNjYXJhdCcsICdiYWNjYXJhdCcpO1xyXG4gICAgcmV0dXJuIGluc3RhbmNlO1xyXG59XHJcblNtYXJ0Rm94U0RLLkJhY2NhcmF0Q29udHJvbGxlciA9IG1vZHVsZS5leHBvcnRzID0gZ2V0SW5zdGFuY2UoKTtcclxuIl19