{"version":3,"sources":["assets/scripts/taixiu/UITaiXiuSessionDetail.js"],"names":["Listview","require","cc","Class","VozBaseComponent","properties","lbPhien","Label","lbNgay","taiWin","Node","xiuWin","lightWin","lbResult","listDice","SpriteFrame","listDiceResultNode","Sprite","lbTaiTongDat","lbXiuTongDat","listTai","listXiu","txCurrentSession","onEnable","node","zIndex","lastZIndex","_data","getDataSession","init","detailSession","self","string","Utils","addDotToNumber","totalTai","totalXiu","total","Promise","all","map","diceItem","index","spriteFrame","dices","then","position","a1","fadeOut","a2","fadeIn","active","runAction","repeatForever","sequence","arrUserBetTai","numItems","length","arrUserBetXiu","day","dayTime","time","split","dayTimeArr","mm","Loading","hide","onDisable","stopAllActions","eventClose","back","onListRenderTai","item","idx","data","getComponent","onListRenderXiu","eventBackSession","parseInt","eventNextSession","show","sessionDetailRequest","TaiXiuRequest","SessionDetailRequest","setSessionId","SmartFoxSDK","TaiXiuController","ZoneInstance","send","toSRequest"],"mappings":"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","sourceRoot":"/","sourcesContent":["const Listview = require('Listview');\ncc.Class({\n    extends: cc.VozBaseComponent,\n\n    properties: {\n        lbPhien : cc.Label,\n        lbNgay  : cc.Label,\n        taiWin  : cc.Node,\n        xiuWin  : cc.Node,\n        lightWin: cc.Node,\n        lbResult: cc.Label,\n        listDice            : [cc.SpriteFrame],\n        listDiceResultNode  : [cc.Sprite],\n        lbTaiTongDat        : cc.Label,\n        lbXiuTongDat        : cc.Label,\n        listTai             : Listview,\n        listXiu             : Listview,\n        txCurrentSession    : 0\n    },\n    onEnable() {\n        if (this.node.zIndex <= cc.lastZIndex){\n            this.node.zIndex = cc.lastZIndex;\n        }\n        this.txCurrentSession    = this._data;\n        this.getDataSession();\n    },\n    init(detailSession){\n        let self = this;\n        this.lbPhien.string       = \"#\"+this.txCurrentSession;\n        this.lbTaiTongDat.string  = Utils.addDotToNumber(detailSession.totalTai);\n        this.lbXiuTongDat.string  = Utils.addDotToNumber(detailSession.totalXiu);\n        let total = 0;\n        Promise.all(this.listDiceResultNode.map(function(diceItem, index){\n            diceItem.spriteFrame = self.listDice[detailSession.dices[index]-1];\n            total += detailSession.dices[index];\n        })).then(function () {\n            self.lbResult.string = \" =\"+total+\" \";\n            if (total <=10){//xiu\n                self.lightWin.position = self.xiuWin.position;\n            }else{//Tai\n                self.lightWin.position = self.taiWin.position;\n            }\n            let a1 = cc.fadeOut(0.1);\n            let a2 = cc.fadeIn(0.1);\n            self.lightWin.active = true;\n            self.lightWin.runAction(cc.repeatForever(cc.sequence(a1, a2)));\n        });\n        this.arrUserBetTai = detailSession.arrUserBetTai;\n        this.listTai.numItems = this.arrUserBetTai.length;\n\n        this.arrUserBetXiu = detailSession.arrUserBetXiu;\n        this.listXiu.numItems = this.arrUserBetXiu.length;\n        let day = null;\n        if (detailSession.arrUserBetXiu.length > 0)\n            day = detailSession.arrUserBetXiu[0];\n        else if (detailSession.arrUserBetTai.length > 0)\n            day = detailSession.arrUserBetTai[0];\n        if (day != null){\n            let dayTime =  day.time.split(\" \")[0];\n            let dayTimeArr = dayTime.split(\"-\");\n            this.lbNgay.string        =  dayTimeArr[2]+\"/\"+dayTimeArr[1]+\"/\"+dayTimeArr[0];\n        }\n        mm.Loading.hide();\n    },\n    onDisable() {\n        this.lightWin.stopAllActions();\n    },\n\n    eventClose() {\n        this.back();\n    },\n    onListRenderTai(item, idx) {\n        let data = this.arrUserBetTai[idx];\n        item.getComponent('TXSessionDetail').init(data, idx);\n    },\n\n    onListRenderXiu(item, idx) {\n        let data = this.arrUserBetXiu[idx];\n        item.getComponent('TXSessionDetail').init(data, idx);\n    },\n\n    eventBackSession() {\n        this.txCurrentSession      = parseInt(this.txCurrentSession) - 1;\n        this.getDataSession();\n    },\n\n    eventNextSession() {\n        this.txCurrentSession      = parseInt(this.txCurrentSession) + 1;\n        this.getDataSession();\n    },\n    getDataSession(){\n        mm.Loading.show();\n        let sessionDetailRequest = new TaiXiuRequest.SessionDetailRequest();\n        sessionDetailRequest.setSessionId(parseInt(this.txCurrentSession));\n        SmartFoxSDK.TaiXiuController.ZoneInstance.send(sessionDetailRequest.toSRequest());\n    }\n\n});\n"]}