{"version":3,"sources":["assets/scripts/zeus/UIZeusBonus.js"],"names":["Helper","require","cc","Class","VozBaseComponent","properties","lbTime","Label","lbMoneyWin","lbTotalWin","specialSelect","Node","resultWin","totalMoneyWin","totalSelect","totalTime","listItemX","type","listXSpecial","SpriteFrame","gifts","xSpecial","onEnable","_data","active","length","string","schedule","countTime","unschedule","eventClose","showMoneyWin","scheduleOnce","Promise","all","map","itemX","index","eventSelect","event","data","target","getChildByName","getComponent","sp","Skeleton","setAnimation","lastMoney","numberTo","back","eventSelectSpecial","self","pos","parseInt","setCompleteListener","trackEntry","loopCount","xSpecialItem","Sprite","spriteFrame","total","i","xSpecialNew","ranPos","Math","floor","random"],"mappings":"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","sourceRoot":"/","sourcesContent":["let Helper = require(\"Helper\");\ncc.Class({\n    extends: cc.VozBaseComponent,\n\n    properties: {\n        lbTime      : cc.Label,\n        lbMoneyWin  : cc.Label,\n        lbTotalWin  : cc.Label,\n        specialSelect   : cc.Node,\n        resultWin   : cc.Node,\n        totalMoneyWin : 0,\n        totalSelect : 0,\n        totalTime   : 15,\n        listItemX  : {\n            type: cc.Node,\n            default: []\n        },\n        listXSpecial  : {\n            type: cc.SpriteFrame,\n            default: []\n        },\n        gifts   : [],\n        xSpecial   : 0,\n    },\n    onEnable () {\n        this.gifts              = this._data.gifts;\n        this.xSpecial           = this._data.xSpecial;\n        this.totalTime          = 20;\n        this.totalMoneyWin      = 0;\n        this.specialSelect.active   = false;\n        this.resultWin.active       = false;\n        this.totalSelect        = this.gifts.length;\n        this.lbTime.string      = this.totalTime;\n        this.schedule(this.countTime, 1);\n    },\n    countTime() {\n        this.totalTime--;\n        if ( this.totalTime < 1){\n            this.unschedule(this.countTime);\n            this.eventClose();\n        }\n        this.lbTime.string      = this.totalTime;\n    },\n    showMoneyWin() {\n        this.scheduleOnce(function (){\n            this.specialSelect.active   = true;\n            Promise.all(this.listItemX.map(function (itemX, index) {\n                itemX.active = true;\n            }));\n        }, 1);\n    },\n    eventSelect(event, data) {\n        if (this.totalSelect > 0){\n            this.totalSelect--;\n            if (this.gifts[this.totalSelect] > 0){\n                event.target.getChildByName(\"lb_money\").active = true;\n                event.target.getChildByName(\"Zeus-BonusGame\").getComponent(sp.Skeleton).setAnimation(0, \"Attack\", false);\n                let lastMoney = this.totalMoneyWin;\n                this.totalMoneyWin += this.gifts[this.totalSelect];\n                Helper.numberTo(event.target.getChildByName(\"lb_money\").getComponent(cc.Label), 0 , this.gifts[this.totalSelect], 1200, true);\n                Helper.numberTo(this.lbMoneyWin, lastMoney , this.totalMoneyWin, 1200, true);\n            } else{\n                event.target.getChildByName(\"Zeus-BonusGame\").getComponent(sp.Skeleton).setAnimation(0, \"Idle-Miss\", false);\n            }\n            if (this.totalSelect == 0){\n                this.showMoneyWin();\n            }\n        }\n    },\n    eventClose() {\n        this.back();\n    },\n    eventSelectSpecial(event, data) {\n        let self = this;\n        let pos = parseInt(data);\n        this.listItemX[pos].getComponent(sp.Skeleton).setAnimation(0, \"Attack\", false);\n        this.listItemX[pos].getComponent(sp.Skeleton).setCompleteListener((trackEntry, loopCount) => {\n            let xSpecialItem = self.listItemX[pos].getChildByName(\"xSpecial\");\n            xSpecialItem.active = true;\n            xSpecialItem.getComponent(cc.Sprite).spriteFrame = self.listXSpecial[self.xSpecial-1];\n            self.scheduleOnce(function (){\n                Promise.all(this.listItemX.map(function (itemX, index) {\n                    itemX.active = false;\n                }));\n                Helper.numberTo(self.lbTotalWin, 0 , self._data.total, 500, true);\n                self.resultWin.active    = true;\n                self.scheduleOnce(function (){\n                    self.eventClose();\n                }, 2);\n            }, 2);\n        });\n        self.scheduleOnce(function (){\n            for (let i=0; i< self.listItemX.length; i++){\n                if (i != pos){\n                    self.listItemX[i].getComponent(sp.Skeleton).setAnimation(0, \"Attack\", false);\n                    self.listItemX[i].getComponent(sp.Skeleton).setCompleteListener((trackEntry, loopCount) => {\n                        let xSpecialNew = self.listItemX[i].getChildByName(\"xSpecial\");\n                        xSpecialNew.active = true;\n                        let ranPos = Math.floor(Math.random()*5);\n                        xSpecialNew.getComponent(cc.Sprite).spriteFrame = self.listXSpecial[ranPos];\n                    });\n                }\n            }\n        }, 0.5);\n    }\n});\n"]}