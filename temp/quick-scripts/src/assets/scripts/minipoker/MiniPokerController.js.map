{"version":3,"sources":["assets/scripts/minipoker/MiniPokerController.js"],"names":["MiniPokerEvent","require","MiniPokerController","SmartFoxSDK","BaseController","extend","m_tableInfo","registerEvents","_super","ZoneInstance","addEventListenerExtension","RESPONSE_NAME","BET_RES","onUserBetEvent","removeEvents","removeEventListenerExtension","onEventLogin","event","_requestJoinRoom","zoneName","onHistoryEvent","data","getSArray","items","i","size","sItem","get","getObject","item","session","getDouble","time","getUtfString","stakes","win","resultMap","getByteArray","linewin","push","UIManger","show","pop","src","onLeaderBoardEvent","account","win_type","onEventUserExitRoom","user","isItMe","cc","currentUI","mm","Loading","hide","getUI","back","onEventRoomJoin","preLoadUI","bind","userBet","BetEvent","fromEvent","MiniPokerRun","instance","getInstance","module","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["let MiniPokerEvent = require('MiniPokerEvent')\nlet MiniPokerController = SmartFoxSDK.BaseController.extend({\n    m_tableInfo: null,\n    registerEvents(){\n        this._super();\n        this.ZoneInstance.addEventListenerExtension(MiniPokerEvent.RESPONSE_NAME.BET_RES, this.onUserBetEvent, this);\n    },\n    removeEvents(){\n        this._super();\n        this.ZoneInstance.removeEventListenerExtension(MiniPokerEvent.RESPONSE_NAME.BET_RES, this.onUserBetEvent, this);\n    },\n    onEventLogin(event){\n        this._super(event);\n        this._requestJoinRoom(this.zoneName);\n    },\n    onHistoryEvent(event){\n        let data = event.getSArray(\"d\");\n        let items = [];\n        for(let i = 0; i < data.size(); i++){\n            let sItem = data.get(i).getObject();\n            let item = {};\n            item.session = sItem.getDouble(\"id\");\n            item.time = sItem.getUtfString(\"t\");\n            item.stakes = sItem.getDouble(\"b\");\n            item.win = sItem.getDouble(\"w\");\n            item.resultMap = sItem.getByteArray(\"rs\");\n            item.linewin = sItem.getByteArray(\"lw\");\n            items.push(item);\n        }\n        UIManger.show(\"UIMiniPokerTransaction\", {pop: true, src: 'minipoker', data: {items: items}});\n    },\n    onLeaderBoardEvent(event){\n\n        let data = event.getSArray(\"d\");\n        let items = [];\n        for(let i = 0;i < data.size();i++){\n            let sItem = data.get(i).getObject();\n            let item = {};\n            item.session = i+1;\n            item.account = sItem.getUtfString(\"dn\");\n            item.win = sItem.getDouble(\"m\");\n            item.time = sItem.getUtfString(\"t\");\n            item.win_type = \"Tháº¯ng\";\n            items.push(item);\n        }\n        UIManger.show(\"UIMiniPokerRank\", {pop: true, src: 'minipoker', data: {items: items}});\n    },\n    onEventUserExitRoom(event){\n        let user = event.user;\n        if(user.isItMe){\n            cc.currentUI  = \"\";\n            mm.Loading.hide();\n            this.getUI().back();\n        }\n    },\n    onEventRoomJoin(user){\n        this.preLoadUI({pop: true}, function () {\n            // load user finish\n        }.bind(this))\n    },\n    onUserBetEvent(event){\n        if(this.getUI() == null)\n            return;\n        let userBet = new MiniPokerEvent.BetEvent().fromEvent(event);\n        this.getUI().MiniPokerRun(userBet);\n    },\n\n});\nlet instance = null;\nlet getInstance = function () {\n    if(instance == null)\n        instance = new MiniPokerController(\"UIMiniPoker\", \"minipoker\");\n    return instance;\n}\nSmartFoxSDK.MiniPokerController = module.exports = getInstance();\n"]}