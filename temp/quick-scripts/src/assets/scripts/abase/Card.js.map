{"version":3,"sources":["assets/scripts/abase/Card.js"],"names":["cc","Class","Component","properties","_isSelected","bg","Node","_card","_cbSelect","_removeSelect","over","onLoad","active","showOver","hideOver","addEventSelect","cb","isSelected","getCard","setCard","card","_loadCardBack","loader","loadRes","SpriteAtlas","err","atlas","console","log","getComponent","Sprite","spriteFrame","getSpriteFrame","bind","_loadCard","nameFile","init","node","undefined","reveal","pIsFaceUp","self","timeFlip","callFunc","skewY","action","skewBy","action2","skewTo","runAction","sequence","switchCard","reset","_zIndex","x","y","eventSelect","id","setScaleCard","scaleCard","width","height"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        _isSelected: false,\n        bg : cc.Node,\n        _card: null,\n        _cbSelect : null,\n        _removeSelect: true,\n        over: cc.Node\n    },\n    onLoad(){\n        this.over.active = false;\n    },\n    showOver(){\n        this.over.active = true;\n    },\n    hideOver(){\n        this.over.active = false;\n    },\n    addEventSelect(cb){\n        this._cbSelect = cb;\n    },\n    isSelected(){\n        return this._isSelected;\n    },\n    getCard(){\n        return this._card;\n    },\n    setCard(card){\n        this._card = card;\n    },\n    _loadCardBack(){\n        cc.loader.loadRes(\"images/cards\", cc.SpriteAtlas, function (err, atlas) {\n            if(err){\n                console.log(err);\n                return;\n            }\n            this.bg.getComponent(cc.Sprite).spriteFrame = atlas.getSpriteFrame(\"-1\");\n        }.bind(this));\n    },\n    _loadCard(){\n        cc.loader.loadRes(\"images/cards\", cc.SpriteAtlas, function (err, atlas) {\n            if(err){\n                console.log(err);\n                return;\n            }\n            this.bg.getComponent(cc.Sprite).spriteFrame = atlas.getSpriteFrame(this._card.nameFile);\n        }.bind(this));\n    },\n    init(card, _removeSelect){\n        this.node.active = true;\n        this.hideOver();\n        if(card == null){\n            this._loadCardBack();\n        }else{\n            this._card = card;\n            if(_removeSelect != undefined){\n                this._removeSelect = _removeSelect;\n            }else{\n                this._removeSelect = true;\n            }\n            this._loadCard();\n        }\n    },\n    reveal(card, pIsFaceUp){\n        this.node.active = true;\n        this.hideOver();\n        this._loadCardBack();\n        this._card = card;\n        let self = this;\n        let timeFlip = 0.45;\n        let callFunc = cc.callFunc(function () {\n            self._loadCard();\n            if(!pIsFaceUp)\n                self.node.skewY = 170;\n            else\n                self.node.skewY = 45;\n        });\n        if(!pIsFaceUp)\n        {\n            self.node.skewY = 0;\n            let action = cc.skewBy(timeFlip/2,0,10);\n            let action2 = cc.skewTo(timeFlip/2,0,180);\n            self.node.runAction(cc.sequence(action,callFunc,action2));\n        }else\n        {\n            self.node.skewY = 180;\n            let action = cc.skewBy(timeFlip/2,0,-35);\n            let action2 = cc.skewTo(timeFlip/2,0,0);\n            self.node.runAction(cc.sequence(action,callFunc,action2));\n        }\n    },\n    switchCard(pIsFaceUp) {\n        let self = this;\n        let timeFlip = 0.45;\n        let callFunc = cc.callFunc(function () {\n            self._loadCard();\n            if(!pIsFaceUp)\n                self.node.skewY = 170;\n            else\n                self.node.skewY = 45;\n        });\n        self.node.skewY = 0;\n        let action = cc.skewBy(timeFlip/2,0,10);\n        let action2 = cc.skewTo(timeFlip/2,0,180);\n        self.node.runAction(cc.sequence(action,callFunc,action2));\n        if(!pIsFaceUp)\n        {\n            self.node.skewY = 0;\n            let action = cc.skewBy(timeFlip/2,0,10);\n            let action2 = cc.skewTo(timeFlip/2,0,180);\n            self.node.runAction(cc.sequence(action,callFunc,action2));\n        }else\n        {\n            self.node.skewY = 180;\n            let action = cc.skewBy(timeFlip/2,0,-35);\n            let action2 = cc.skewTo(timeFlip/2,0,0);\n            self.node.runAction(cc.sequence(action,callFunc,action2));\n        }\n    },\n    reset(){\n        this._loadCardBack();\n        this.hideOver();\n        this.node._zIndex = 0;\n        this.node.x = 0;\n        this.node.y = 0;\n        this._isSelected = false;\n        this._card = null;\n        this._cbSelect = null;\n        this._removeSelect = true;\n    },\n    eventSelect(){\n        if(!this._removeSelect){\n            if(!this._isSelected){\n                this._isSelected = true;\n                this.node.y = this.node.y + 20;\n                if(this._cbSelect){\n                    this._cbSelect(this.getCard().id);\n                }\n            }else{\n                this._isSelected = false;\n                this.node.y = this.node.y - 20;\n            }\n        }\n    },\n    setScaleCard(scaleCard){\n        this.node.width  *= scaleCard;\n        this.node.height *= scaleCard;\n    }\n});\n"]}