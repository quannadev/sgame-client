{"version":3,"sources":["assets\\scripts\\bacay\\BaCayController.js"],"names":["BaCayEvent","require","BaCayController","SmartFoxSDK","BaseController","extend","m_tableInfo","registerEvents","_super","ZoneInstance","addEventListenerExtension","CasinoEvent","RESPONSE_NAME","GROUP_GAME_RES","onGroupRoomEvent","QUICK_JOIN_GAME_RES","onQuickJoinRoom","SIT_ON_RES","onUserSitOn","SIT_OUT_RES","onUserSitOut","STAND_UP_RES","onUserStandUp","PRE_START_RES","onPreStart","START_RES","onStartEvent","BET_RES","onUserBet","BET_GA_RES","onUserBetGa","KICK_RES","onKickUser","FINISH_GAME_RES","onFinishGame","LOAD_TABLE_RES","onLoadTableEvent","CAN_REGISTER_OWNER_RES","onCanRegisterOwnerEvent","REGISTER_OWNER_RES","onRegisterOwner","SELL_OWNER_RES","onSellOwner","removeEvents","removeEventListenerExtension","onEventLogin","event","groupRequest","CasinoRequest","GroupGameRequest","setGame","zoneName","send","toSRequest","getUILobby","scene","cc","director","getScene","uiLobby","find","getComponent","name","onLeaderBoardEvent","arrLeaderboard","data","getSArray","i","size","sItem","get","getObject","item","session","account","getUtfString","win","getDouble","push","updateRank","groupRoom","GroupGameEvent","fromEvent","mm","game","undefined","groups","displayname","GameVariables","getDisplayName","mySelf","chip","getChip","UIManger","show","pop","request","LeaderBoardRequest","quickJoin","QuickJoinGameEvent","roomId","JoinRoomRequest","Toast","showToast","resumeGame","getRoom","getUserList","length","getUI","resetUI","onEventUserExitRoom","user","isItMe","node","active","removePlayer","_data","room","preLoadUI","Loading","hide","controller","setInfoTable","id","Utils","formatCurrency","Poker","getBetChip","LoadTableInfoEvent","m_isGameStart","m_listActiveUserName","indexOf","requestSitOn","_updateNodePlayers","m_listDesk","m_isPrestart","setWaitingTimer","m_username","updateOwner","bind","ownerEvent","CanRegisterOwnerEvent","m_listUser","getAction","showRegisterOwner","RegisterOwnerEvent","owner","err","eventUserRegisterOwner","SellOwnerEvent","SellOwner","userSitOnEvent","UserSitOnEvent","desk","DeskId","m_deskId","UserName","m_userName","DeskState","m_deskState","UserChip","m_buyIn","sitOutRes","UserSitOutEvent","indexUser","m_listUserSitOut","m_isSitOut","splice","player","_getJSPlayerByName","setSitOut","preStart","PreStartEvent","m_prestartTime","_getJSPlayerById","onPreStartEvent","requestLeaveRoom","showDeskEmpty","start","StartEvent","m_owner","m_gameTime","userOut","_isPlayer","showActionStart","jsPlayer","hideDeskEmpty","bet","BetEvent","username","audio","playDatCua","showBetChip","getUserByName","money","setMoney","betGa","BetGaEvent","showBetGa","playChiaBai","hideAllActions","finishGameRes","FinishGameEvent","_dealCards","m_listHandCard","m_listPoint","onGameFinishEvent","m_listChipWin","Math","floor","random","m_winGa","onPublicMessage","sender","msg","message","dataSender","dn","fb","msgItem","instance","getInstance","module","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["let BaCayEvent = require('BaCayEvent');\r\nlet BaCayController = SmartFoxSDK.BaseController.extend({\r\n    m_tableInfo: null,\r\n    registerEvents(){\r\n        this._super();\r\n        this.ZoneInstance.addEventListenerExtension(CasinoEvent.RESPONSE_NAME.GROUP_GAME_RES, this.onGroupRoomEvent, this);\r\n        this.ZoneInstance.addEventListenerExtension(CasinoEvent.RESPONSE_NAME.QUICK_JOIN_GAME_RES, this.onQuickJoinRoom, this);\r\n\r\n        this.ZoneInstance.addEventListenerExtension(BaCayEvent.RESPONSE_NAME.SIT_ON_RES, this.onUserSitOn, this);\r\n        this.ZoneInstance.addEventListenerExtension(BaCayEvent.RESPONSE_NAME.SIT_OUT_RES, this.onUserSitOut, this);\r\n        this.ZoneInstance.addEventListenerExtension(BaCayEvent.RESPONSE_NAME.STAND_UP_RES, this.onUserStandUp, this);\r\n        this.ZoneInstance.addEventListenerExtension(BaCayEvent.RESPONSE_NAME.PRE_START_RES, this.onPreStart, this);\r\n        this.ZoneInstance.addEventListenerExtension(BaCayEvent.RESPONSE_NAME.START_RES, this.onStartEvent, this);\r\n        this.ZoneInstance.addEventListenerExtension(BaCayEvent.RESPONSE_NAME.BET_RES, this.onUserBet, this);\r\n        this.ZoneInstance.addEventListenerExtension(BaCayEvent.RESPONSE_NAME.BET_GA_RES, this.onUserBetGa, this);\r\n        this.ZoneInstance.addEventListenerExtension(BaCayEvent.RESPONSE_NAME.KICK_RES, this.onKickUser, this);\r\n        this.ZoneInstance.addEventListenerExtension(BaCayEvent.RESPONSE_NAME.FINISH_GAME_RES, this.onFinishGame, this);\r\n        this.ZoneInstance.addEventListenerExtension(BaCayEvent.RESPONSE_NAME.LOAD_TABLE_RES, this.onLoadTableEvent, this);\r\n        this.ZoneInstance.addEventListenerExtension(BaCayEvent.RESPONSE_NAME.CAN_REGISTER_OWNER_RES, this.onCanRegisterOwnerEvent, this);\r\n        this.ZoneInstance.addEventListenerExtension(BaCayEvent.RESPONSE_NAME.REGISTER_OWNER_RES, this.onRegisterOwner, this);\r\n        this.ZoneInstance.addEventListenerExtension(BaCayEvent.RESPONSE_NAME.SELL_OWNER_RES, this.onSellOwner, this);\r\n    },\r\n    removeEvents(){\r\n        this._super();\r\n        this.ZoneInstance.removeEventListenerExtension(CasinoEvent.RESPONSE_NAME.GROUP_GAME_RES, this.onGroupRoomEvent, this);\r\n        this.ZoneInstance.removeEventListenerExtension(CasinoEvent.RESPONSE_NAME.QUICK_JOIN_GAME_RES, this.onQuickJoinRoom, this);\r\n\r\n        this.ZoneInstance.removeEventListenerExtension(BaCayEvent.RESPONSE_NAME.SIT_ON_RES, this.onUserSitOn, this);\r\n        this.ZoneInstance.removeEventListenerExtension(BaCayEvent.RESPONSE_NAME.SIT_OUT_RES, this.onUserSitOut, this);\r\n        this.ZoneInstance.removeEventListenerExtension(BaCayEvent.RESPONSE_NAME.STAND_UP_RES, this.onUserStandUp, this);\r\n        this.ZoneInstance.removeEventListenerExtension(BaCayEvent.RESPONSE_NAME.PRE_START_RES, this.onPreStart, this);\r\n        this.ZoneInstance.removeEventListenerExtension(BaCayEvent.RESPONSE_NAME.START_RES, this.onStartEvent, this);\r\n        this.ZoneInstance.removeEventListenerExtension(BaCayEvent.RESPONSE_NAME.BET_RES, this.onUserBet, this);\r\n        this.ZoneInstance.removeEventListenerExtension(BaCayEvent.RESPONSE_NAME.BET_GA_RES, this.onUserBetGa, this);\r\n        this.ZoneInstance.removeEventListenerExtension(BaCayEvent.RESPONSE_NAME.KICK_RES, this.onKickUser, this);\r\n        this.ZoneInstance.removeEventListenerExtension(BaCayEvent.RESPONSE_NAME.FINISH_GAME_RES, this.onFinishGame, this);\r\n        this.ZoneInstance.removeEventListenerExtension(BaCayEvent.RESPONSE_NAME.LOAD_TABLE_RES, this.onLoadTableEvent, this);\r\n        this.ZoneInstance.removeEventListenerExtension(BaCayEvent.RESPONSE_NAME.CAN_REGISTER_OWNER_RES, this.onCanRegisterOwnerEvent, this);\r\n        this.ZoneInstance.removeEventListenerExtension(BaCayEvent.RESPONSE_NAME.REGISTER_OWNER_RES, this.onRegisterOwner, this);\r\n        this.ZoneInstance.removeEventListenerExtension(BaCayEvent.RESPONSE_NAME.SELL_OWNER_RES, this.onSellOwner, this);\r\n    },\r\n    onEventLogin(event){\r\n        this._super(event);\r\n        let groupRequest = new CasinoRequest.GroupGameRequest();\r\n        groupRequest.setGame(this.zoneName);\r\n        this.ZoneInstance.send(groupRequest.toSRequest());\r\n    },\r\n    getUILobby(){\r\n        const scene = cc.director.getScene();\r\n        let uiLobby =  cc.find(\"UILobby\", scene);\r\n        return uiLobby.getComponent(uiLobby.name);\r\n    },\r\n    onLeaderBoardEvent(event){\r\n        let arrLeaderboard =[];\r\n        let data = event.getSArray(\"d\");\r\n        for(let i = 0;i < data.size();i++){\r\n            let sItem = data.get(i).getObject();\r\n            let item = {};\r\n            item.session = i +1;\r\n            item.account = sItem.getUtfString(\"dn\");\r\n            item.win = sItem.getDouble(\"m\");\r\n            arrLeaderboard.push(item);\r\n        }\r\n        if(this.getUILobby()){\r\n            this.getUILobby().updateRank(arrLeaderboard);\r\n        }\r\n    },\r\n    onGroupRoomEvent(event){\r\n        let groupRoom = new CasinoEvent.GroupGameEvent().fromEvent(event);\r\n        if(mm.game == undefined)\r\n            mm.game = {};\r\n        mm.game[this.zoneName] = {};\r\n        mm.game[this.zoneName].groups = groupRoom.groups;\r\n        mm.game[this.zoneName].displayname = GameVariables.getDisplayName(this.ZoneInstance.mySelf);\r\n        mm.game[this.zoneName].chip = GameVariables.getChip(this.ZoneInstance.mySelf);\r\n        UIManger.show(\"UILobby\", {pop: true, data: {game: \"bacay\", ZoneInstance: this.ZoneInstance}}, function () {\r\n            let request = new CasinoRequest.LeaderBoardRequest();\r\n            SmartFoxSDK.BaCayController.ZoneInstance.send(request.toSRequest());\r\n        });\r\n    },\r\n    onQuickJoinRoom(event){\r\n        let quickJoin = new CasinoEvent.QuickJoinGameEvent().fromEvent(event);\r\n        if(quickJoin.roomId >= 0){\r\n            this.ZoneInstance.send(new CasinoRequest.JoinRoomRequest(quickJoin.roomId, \"1\", true).toSRequest());\r\n        }else{\r\n            mm.Toast.showToast(1, \"Phòng đã đầy vui vòng chọn phòng khác\");\r\n        }\r\n    },\r\n    resumeGame() {\r\n        if (this.getRoom().getUserList().length < 2)\r\n            this.getUI().resetUI();\r\n    },\r\n    onEventUserExitRoom(event){\r\n        let user = event.user;\r\n        if(user.isItMe){\r\n            if (this.getUI() != null)\r\n                this.getUI().node.active = false;\r\n            UIManger.show(\"UILobby\", {pop: true, data: {game: \"bacay\", ZoneInstance: this.ZoneInstance}});\r\n        }else{\r\n            this.getUI().removePlayer([user.name]);\r\n        }\r\n        if (this.getRoom().getUserList().length < 2)\r\n            this.getUI().resetUI();\r\n    },\r\n    onLoadTableEvent(event){\r\n        let _data = {pop: true, data: {room: this.room}};\r\n        this.preLoadUI(_data, function () {\r\n            mm.Loading.hide();\r\n            this.getUI().controller = this;\r\n            this.getUI().setInfoTable(\"Ba Cây / #\"+this.room.id, Utils.formatCurrency(GameVariables.Poker.getBetChip(this.room)));\r\n            this.m_tableInfo = new BaCayEvent.LoadTableInfoEvent().fromEvent(event);\r\n            this.m_tableInfo.room = this.room;\r\n            if(!this.m_tableInfo.m_isGameStart || this.m_tableInfo.m_listActiveUserName.indexOf(this.ZoneInstance.mySelf.name) < 0){\r\n                this.getUI().requestSitOn();\r\n            }\r\n            this.getUI()._updateNodePlayers(this.m_tableInfo.m_listDesk);\r\n            if(this.m_tableInfo.m_isPrestart && !this.m_tableInfo.m_isGameStart){\r\n                this.getUI().setWaitingTimer(true, 5, this.m_tableInfo.m_isPrestart / 100);\r\n            }\r\n            if (this.m_tableInfo.m_username != null)\r\n                this.getUI().updateOwner(this.m_tableInfo.m_username);\r\n        }.bind(this));\r\n    },\r\n    onCanRegisterOwnerEvent(event){\r\n        let ownerEvent = new BaCayEvent.CanRegisterOwnerEvent().fromEvent(event);\r\n        if(ownerEvent.m_listUser.indexOf(this.ZoneInstance.mySelf.name) >= 0){\r\n            this.getUI().getAction().showRegisterOwner();\r\n        }\r\n    },\r\n    onRegisterOwner(event){\r\n        let ownerEvent = new BaCayEvent.RegisterOwnerEvent().fromEvent(event);\r\n        let owner = ownerEvent.m_username;\r\n        let err = ownerEvent.err;\r\n        this.getUI().updateOwner(owner);\r\n        this.getUI().getAction().eventUserRegisterOwner(owner, err);\r\n    },\r\n    onSellOwner(event){\r\n        let ownerEvent = new BaCayEvent.SellOwnerEvent().fromEvent(event);\r\n        let owner = ownerEvent.m_username;\r\n        let err = ownerEvent.err;\r\n        if(owner != \"\"){\r\n            mm.Toast.showToast(1, owner +\" Bán chương\");\r\n        }\r\n        if(err != \"\"){\r\n            mm.Toast.showToast(1, err);\r\n        }\r\n        this.getUI().getAction().SellOwner.active = false;\r\n    },\r\n    onUserSitOn(event){\r\n        let userSitOnEvent = new BaCayEvent.UserSitOnEvent().fromEvent(event);\r\n        // add to list desk\r\n        let desk = {};\r\n        desk.DeskId = userSitOnEvent.m_deskId;\r\n        desk.UserName = userSitOnEvent.m_userName;\r\n        desk.DeskState = userSitOnEvent.m_deskState;\r\n        desk.UserChip = userSitOnEvent.m_buyIn;\r\n        this.m_tableInfo.m_listDesk.push(desk);\r\n\r\n        // add to list user\r\n        this.m_tableInfo.m_listUser.push(userSitOnEvent.m_userName);\r\n\r\n\r\n        this.getUI()._updateNodePlayers(this.m_tableInfo.m_listDesk);\r\n    },\r\n    onUserSitOut(event){\r\n        mm.Loading.hide();\r\n        let sitOutRes = new BaCayEvent.UserSitOutEvent().fromEvent(event);\r\n        let indexUser = this.m_tableInfo.m_listUserSitOut.indexOf(sitOutRes.m_username);\r\n        if(indexUser < 0){\r\n            this.m_tableInfo.m_listUserSitOut.push(sitOutRes.m_username);\r\n        }else if(!sitOutRes.m_isSitOut){\r\n            this.m_tableInfo.m_listUserSitOut.splice(indexUser, 1);\r\n        }\r\n        let player = this.getUI()._getJSPlayerByName(sitOutRes.m_username);\r\n        if(player)\r\n            player.setSitOut(sitOutRes.m_isSitOut);\r\n        if(this.ZoneInstance.mySelf.name == sitOutRes.m_username){\r\n            if(sitOutRes.m_isSitOut)\r\n                mm.Toast.showToast(1, \"Đăng ký rời bàn!\");\r\n            else\r\n                mm.Toast.showToast(1, \"Hủy rời bàn!\");\r\n        }\r\n    },\r\n    onPreStart(event){\r\n        let preStart = new BaCayEvent.PreStartEvent().fromEvent(event);\r\n        this.m_tableInfo.m_isPrestart = preStart.m_isPrestart;\r\n        this.m_tableInfo.m_prestartTime = preStart.m_prestartTime;\r\n        this.m_tableInfo.m_isGameStart = false;\r\n        for(let i = 0; i < this.m_tableInfo.m_listDesk.length;i++){\r\n            let desk = this.m_tableInfo.m_listDesk[i];\r\n            let player = this.getUI()._getJSPlayerById(desk.DeskId);\r\n            if(player)\r\n                player.onPreStartEvent(preStart);\r\n        }\r\n        this.getUI().onPreStartEvent();\r\n        if(preStart.m_isPrestart){\r\n            this.getUI().setWaitingTimer(true,preStart.m_prestartTime / 1000, preStart.m_prestartTime / 1000);\r\n        }\r\n        // remove me if register leave table\r\n        if(this.m_tableInfo.m_listUserSitOut.indexOf(this.ZoneInstance.mySelf.name) >= 0){\r\n            this.getUI().requestLeaveRoom();\r\n        }\r\n        this.getUI().showDeskEmpty();\r\n    },\r\n    onStartEvent(event){\r\n        let start = new BaCayEvent.StartEvent().fromEvent(event);\r\n        this.m_tableInfo.m_owner =  start.m_owner;\r\n        this.m_tableInfo.m_gameTime = start.m_gameTime;\r\n        this.m_tableInfo.m_isGameStart = true;\r\n        this.getUI().setWaitingTimer(true,this.m_tableInfo.m_gameTime / 1000, this.m_tableInfo.m_gameTime / 1000);\r\n        if(this.m_tableInfo.m_listActiveUserName){\r\n            let userOut = [];\r\n            for(let i = 0; i < this.m_tableInfo.m_listActiveUserName.length;i++){\r\n                if(start.m_listActiveUserName.indexOf(this.m_tableInfo.m_listActiveUserName[i]) < 0){\r\n                    userOut.push(this.m_tableInfo.m_listActiveUserName[i]);\r\n                }\r\n            }\r\n            this.getUI().removePlayer(userOut);\r\n        }\r\n        this.m_tableInfo.m_listActiveUserName = start.m_listActiveUserName;\r\n        this.getUI()._updateNodePlayers(this.m_tableInfo.m_listDesk);\r\n        this.getUI().onStartEvent();\r\n        if(this.getUI()._isPlayer(this.ZoneInstance.mySelf.name)){\r\n            this.getUI().getAction().showActionStart(this.ZoneInstance.mySelf.name == this.m_tableInfo.m_owner);\r\n        }\r\n        for(let i = 0; i < this.m_tableInfo.m_listDesk.length;i++){\r\n            let desk = this.m_tableInfo.m_listDesk[i];\r\n            let jsPlayer = this.getUI()._getJSPlayerById(desk.DeskId);\r\n            jsPlayer.onStartEvent(start);\r\n        }\r\n        this.getUI().hideDeskEmpty();\r\n    },\r\n    onUserBet(event){\r\n        let bet = new BaCayEvent.BetEvent().fromEvent(event);\r\n        let player = this.getUI()._getJSPlayerByName(bet.username);\r\n        if(player){\r\n            if (player.isItMe())\r\n                mm.audio.playDatCua();\r\n            player.showBetChip(bet);\r\n            let user = this.room.getUserByName(bet.username);\r\n            let money = GameVariables.getChip(user);\r\n            player.setMoney(money);\r\n        }\r\n    },\r\n    onUserBetGa(event){\r\n        let betGa = new BaCayEvent.BetGaEvent().fromEvent(event);\r\n        this.getUI().showBetGa(betGa);\r\n        let player = this.getUI()._getJSPlayerByName(betGa.username);\r\n        if(player){\r\n            if (player.isItMe())\r\n                mm.audio.playDatCua();\r\n            let user = this.room.getUserByName(betGa.username);\r\n            let money = GameVariables.getChip(user);\r\n            player.setMoney(money);\r\n        }\r\n    },\r\n    onFinishGame(event){\r\n        mm.audio.playChiaBai();\r\n        this.getUI().getAction().hideAllActions();\r\n        this.getUI().onFinishGame();\r\n        let finishGameRes = new BaCayEvent.FinishGameEvent().fromEvent(event);\r\n        for(let i = 0; i < finishGameRes.m_listActiveUserName.length;i++){\r\n            let name = finishGameRes.m_listActiveUserName[i];\r\n            let player = this.getUI()._getJSPlayerByName(name);\r\n            if(player){\r\n                this.m_tableInfo.m_isGameStart = false;\r\n                if (player.isItMe())\r\n                    this.getUI()._dealCards(finishGameRes.m_listActiveUserName, finishGameRes.m_listHandCard[i], finishGameRes.m_listPoint[i]);\r\n                player.onGameFinishEvent(finishGameRes.m_listHandCard[i],finishGameRes.m_listChipWin[i], finishGameRes.m_listPoint[i], 4+Math.floor(Math.random()*4), 8, finishGameRes.m_winGa);\r\n            }\r\n        }\r\n    },\r\n    onUserStandUp(event){\r\n\r\n    },\r\n    onKickUser(event){\r\n\r\n    },\r\n    onPublicMessage(event){\r\n        let sender = event.sender;\r\n        let msg = event.message;\r\n        let data = event.data;\r\n        let dataSender = data != null ? {dn: data.get(\"dn\"), fb : data.get(\"fb\")} : {dn: \"...\", fb : \"\"};\r\n        let msgItem = {};\r\n        msgItem.sender = sender;\r\n        msgItem.msg = msg;\r\n        msgItem.dataSender = dataSender;\r\n        this.getUI().onPublicMessage(msgItem);\r\n    },\r\n});\r\nlet instance = null;\r\nlet getInstance = function () {\r\n    if(instance == null)\r\n        instance = new BaCayController('UIBaCay','bacay');\r\n    return instance;\r\n}\r\nSmartFoxSDK.BaCayController = module.exports = getInstance();\r\n"]}