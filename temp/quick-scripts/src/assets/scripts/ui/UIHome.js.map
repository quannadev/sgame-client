{"version":3,"sources":["assets/scripts/ui/UIHome.js"],"names":["cc","Class","VozBaseComponent","properties","TopHome","Node","TopLogin","lb_name","Label","lb_chip","Avatar","Sprite","ALL","type","SLOT","MINI","CASINO","onLoad","Utils","loadRes","Config","getDefaultAvatar","MiniGame","showIcon","isFirstTx","onEnable","mm","isLogin","active","resetAllGameUI","audio","playMusic","ui","getUIFromName","_selectGame","completeLoadUIGame","updateUserVariable","subChip","SmartFoxSDK","PortalController","ZoneInstance","mySelf","string","formatText","GameVariables","Poker","getDisplayName","addDotToNumber","getChip","msg","getVariable","value","SystemMessage","node","getChildByName","js","getComponent","name","runMessage","onSelectGame","event","game","_selectGameNode","currentTarget","onLoadSubGame","playButton","onSelectTXGame","user","ret","reflection","callStaticMethod","onSelectXDGame","onToggleCategoryGame","_activeIconGame","_hideAllIconGame","i","length","list","Loading","show","pop","gameController","PortalManager","getGameController","loginZone","getUsername","getPass","onClickLogin","onClickRegister","eventShowWarning","self","UIManger","data","content","cbYes","_reset","disconnectAll","scene","director","getScene","index","childrenCount","element","children","startsWith","destroy"],"mappings":";;;;;;AAAAA,EAAE,CAACC,KAAH,CAAS;AACL,aAASD,EAAE,CAACE,gBADP;AAGLC,EAAAA,UAAU,EAAE;AACRC,IAAAA,OAAO,EAAEJ,EAAE,CAACK,IADJ;AAERC,IAAAA,QAAQ,EAAEN,EAAE,CAACK,IAFL;AAGRE,IAAAA,OAAO,EAAEP,EAAE,CAACQ,KAHJ;AAIRC,IAAAA,OAAO,EAAET,EAAE,CAACQ,KAJJ;AAKRE,IAAAA,MAAM,EAAEV,EAAE,CAACW,MALH;AAMRC,IAAAA,GAAG,EAAG;AACFC,MAAAA,IAAI,EAAEb,EAAE,CAACK,IADP;AAEF,iBAAS;AAFP,KANE;AAURS,IAAAA,IAAI,EAAE;AACFD,MAAAA,IAAI,EAAEb,EAAE,CAACK,IADP;AAEF,iBAAS;AAFP,KAVE;AAcRU,IAAAA,IAAI,EAAE;AACFF,MAAAA,IAAI,EAAEb,EAAE,CAACK,IADP;AAEF,iBAAS;AAFP,KAdE;AAkBRW,IAAAA,MAAM,EAAE;AACJH,MAAAA,IAAI,EAAEb,EAAE,CAACK,IADL;AAEJ,iBAAS;AAFL;AAlBA,GAHP;AA0BLY,EAAAA,MA1BK,oBA0BG;AACJC,IAAAA,KAAK,CAACC,OAAN,CAAc,KAAKT,MAAnB,EAA2B,mBAAiBU,MAAM,CAACC,gBAAP,EAA5C;AACAC,IAAAA,QAAQ,CAACC,QAAT;AACAvB,IAAAA,EAAE,CAACwB,SAAH,GAAe,IAAf;AACH,GA9BI;AA+BLC,EAAAA,QA/BK,sBA+BK;AACN,QAAGC,EAAE,CAACC,OAAN,EAAc;AACV,WAAKvB,OAAL,CAAawB,MAAb,GAAsB,IAAtB;AACA,WAAKtB,QAAL,CAAcsB,MAAd,GAAuB,KAAvB;AACH,KAHD,MAGK;AACD,WAAKxB,OAAL,CAAawB,MAAb,GAAsB,KAAtB;AACA,WAAKtB,QAAL,CAAcsB,MAAd,GAAuB,IAAvB;AACA,WAAKC,cAAL;AACH;;AACDH,IAAAA,EAAE,CAACI,KAAH,CAASC,SAAT;;AACA,QAAIL,EAAE,CAACC,OAAH,IAAc3B,EAAE,CAACwB,SAArB,EAA+B;AAC3BxB,MAAAA,EAAE,CAACwB,SAAH,GAAe,KAAf;AACA,UAAIQ,EAAE,GAAG,KAAKC,aAAL,CAAmB,UAAnB,CAAT;;AACA,UAAID,EAAE,IAAI,IAAV,EAAe;AACX,aAAKE,WAAL,GAAmB,QAAnB;AACA,aAAKC,kBAAL,CAAwB,KAAKD,WAA7B;AACH;AACJ;AACJ,GAjDI;AAkDLE,EAAAA,kBAlDK,8BAkDcC,OAlDd,EAkDuB;AACxB,QAAGC,WAAW,CAACC,gBAAZ,CAA6BC,YAA7B,CAA0CC,MAA7C,EAAoD;AAChD,WAAKlC,OAAL,CAAamC,MAAb,GAAsBxB,KAAK,CAACyB,UAAN,CAAiBC,aAAa,CAACC,KAAd,CAAoBC,cAApB,CAAmCR,WAAW,CAACC,gBAAZ,CAA6BC,YAA7B,CAA0CC,MAA7E,CAAjB,EAAuG,EAAvG,CAAtB;AACA,WAAKhC,OAAL,CAAaiC,MAAb,GAAsBxB,KAAK,CAAC6B,cAAN,CAAqBH,aAAa,CAACC,KAAd,CAAoBG,OAApB,CAA4BV,WAAW,CAACC,gBAAZ,CAA6BC,YAA7B,CAA0CC,MAAtE,IAA8EJ,OAAnG,CAAtB;AACA,UAAIY,GAAG,GAAGX,WAAW,CAACC,gBAAZ,CAA6BC,YAA7B,CAA0CC,MAA1C,CAAiDS,WAAjD,CAA6D,QAA7D,CAAV;;AACA,UAAGD,GAAG,IAAIA,GAAG,CAACE,KAAd,EAAoB;AAChB,YAAIC,aAAa,GAAG,KAAKC,IAAL,CAAUC,cAAV,CAAyB,SAAzB,EAAoCA,cAApC,CAAmD,eAAnD,CAApB;AACA,YAAIC,EAAE,GAAGH,aAAa,CAACI,YAAd,CAA2BJ,aAAa,CAACK,IAAzC,CAAT;AACAF,QAAAA,EAAE,CAACG,UAAH,CAAcT,GAAG,CAACE,KAAlB;AACH;AACJ;AACJ,GA7DI;AA8DLQ,EAAAA,YA9DK,wBA8DQC,KA9DR,EA8DeC,IA9Df,EA8DoB;AACrB,SAAK3B,WAAL,GAAmB2B,IAAnB;AACA7D,IAAAA,EAAE,CAAC8D,eAAH,GAAqBF,KAAK,CAACG,aAA3B;AACA,SAAKC,aAAL;AACAtC,IAAAA,EAAE,CAACI,KAAH,CAASmC,UAAT;AACH,GAnEI;AAoELC,EAAAA,cApEK,0BAoEUN,KApEV,EAoEiBC,IApEjB,EAoEuB;AACxB,QAAIM,IAAI,GAAGvB,aAAa,CAACC,KAAd,CAAoBC,cAApB,CAAmCR,WAAW,CAACC,gBAAZ,CAA6BC,YAA7B,CAA0CC,MAA7E,CAAX;AACA,QAAI2B,GAAG,GAAGpE,EAAE,UAAF,CAAUqE,UAAV,CAAqBC,gBAArB,CAAsC,aAAtC,EACuB,YADvB,EAEuB,OAFvB,EAGuBH,IAHvB,CAAV;AAKH,GA3EI;AA4ELI,EAAAA,cA5EK,0BA4EUX,KA5EV,EA4EiBC,IA5EjB,EA4EuB;AACxB,QAAIM,IAAI,GAAGvB,aAAa,CAACC,KAAd,CAAoBC,cAApB,CAAmCR,WAAW,CAACC,gBAAZ,CAA6BC,YAA7B,CAA0CC,MAA7E,CAAX;AACA,QAAI2B,GAAG,GAAGpE,EAAE,UAAF,CAAUqE,UAAV,CAAqBC,gBAArB,CAAsC,aAAtC,EACuB,YADvB,EAEuB,OAFvB,EAGuBH,IAHvB,CAAV;AAKH,GAnFI;AAoFLK,EAAAA,oBApFK,gCAoFgBZ,KApFhB,EAoFsB;AACvBlC,IAAAA,EAAE,CAACI,KAAH,CAASmC,UAAT;;AACA,QAAGL,KAAK,CAACP,IAAN,CAAWI,IAAX,IAAmB,KAAtB,EAA4B;AACxB,WAAKgB,eAAL,CAAqB,KAAK7D,GAA1B;AACH,KAFD,MAEM,IAAGgD,KAAK,CAACP,IAAN,CAAWI,IAAX,IAAmB,MAAtB,EAA6B;AAC/B,WAAKiB,gBAAL;;AACA,WAAKD,eAAL,CAAqB,KAAK3D,IAA1B;AACH,KAHK,MAGA,IAAG8C,KAAK,CAACP,IAAN,CAAWI,IAAX,IAAmB,UAAtB,EAAiC;AACnC,WAAKiB,gBAAL;;AACA,WAAKD,eAAL,CAAqB,KAAK1D,IAA1B;AACH,KAHK,MAGA,IAAG6C,KAAK,CAACP,IAAN,CAAWI,IAAX,IAAmB,QAAtB,EAA+B;AACjC,WAAKiB,gBAAL;;AACA,WAAKD,eAAL,CAAqB,KAAKzD,MAA1B;AACH;AACJ,GAlGI;AAmGL0D,EAAAA,gBAnGK,8BAmGa;AACd,SAAI,IAAIC,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAG,KAAK/D,GAAL,CAASgE,MAA5B,EAAmCD,CAAC,EAApC,EAAuC;AACnC,WAAK/D,GAAL,CAAS+D,CAAT,EAAY/C,MAAZ,GAAqB,KAArB;AACH;AACJ,GAvGI;AAwGL6C,EAAAA,eAxGK,2BAwGWI,IAxGX,EAwGgB;AACjB,SAAI,IAAIF,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGE,IAAI,CAACD,MAAxB,EAA+BD,CAAC,EAAhC,EAAmC;AAC/BE,MAAAA,IAAI,CAACF,CAAD,CAAJ,CAAQ/C,MAAR,GAAiB,IAAjB;AACH;AACJ,GA5GI;AA6GLoC,EAAAA,aA7GK,2BA6GU;AACX,QAAIH,IAAI,GAAG,KAAK3B,WAAhB;;AACA,QAAGR,EAAE,CAACC,OAAN,EAAc;AACV3B,MAAAA,EAAE,CAAC8D,eAAH,CAAmBR,cAAnB,CAAkC,MAAlC,EAA0C1B,MAA1C,GAAmD,IAAnD;AACAF,MAAAA,EAAE,CAACoD,OAAH,CAAWC,IAAX;AACA,WAAK5C,kBAAL,CAAwB0B,IAAxB;AACH,KAJD,MAIK;AACD,WAAKkB,IAAL,CAAU,SAAV,EAAqB;AAACC,QAAAA,GAAG,EAAE;AAAN,OAArB;AACH;AACJ,GAtHI;AAuHL7C,EAAAA,kBAvHK,8BAuHc0B,IAvHd,EAuHmB;AACpB,QAAIoB,cAAc,GAAGC,aAAa,CAACC,iBAAd,CAAgCtB,IAAhC,CAArB;AACA,QAAGoB,cAAH,EACIA,cAAc,CAACG,SAAf,CAAyBhE,MAAM,CAACiE,WAAP,EAAzB,EAA+CjE,MAAM,CAACkE,OAAP,EAA/C;AACP,GA3HI;AA4HLC,EAAAA,YA5HK,0BA4HS;AACV7D,IAAAA,EAAE,CAACI,KAAH,CAASmC,UAAT;AACA,SAAKc,IAAL,CAAU,SAAV,EAAqB;AAACC,MAAAA,GAAG,EAAE;AAAN,KAArB;AACH,GA/HI;AAgILQ,EAAAA,eAhIK,6BAgIY;AACb9D,IAAAA,EAAE,CAACI,KAAH,CAASmC,UAAT;AACA,SAAKc,IAAL,CAAU,YAAV,EAAwB;AAACC,MAAAA,GAAG,EAAE;AAAN,KAAxB;AACH,GAnII;AAoILS,EAAAA,gBApIK,8BAoIa;AACd,QAAIC,IAAI,GAAG,IAAX;AACAhE,IAAAA,EAAE,CAACI,KAAH,CAASmC,UAAT;AACA0B,IAAAA,QAAQ,CAACZ,IAAT,CAAc,aAAd,EAA6B;AACzBa,MAAAA,IAAI,EAAE;AACFC,QAAAA,OAAO,EAAE,8BADP;AAEF,iBAAS,SAASC,KAAT,GAAiB;AACtBJ,UAAAA,IAAI,CAACtF,OAAL,CAAawB,MAAb,GAAsB,KAAtB;AACA8D,UAAAA,IAAI,CAACpF,QAAL,CAAcsB,MAAd,GAAuB,IAAvB;AACAF,UAAAA,EAAE,CAACC,OAAH,GAAa,KAAb;;AACAW,UAAAA,WAAW,CAACC,gBAAZ,CAA6BwD,MAA7B;;AACAb,UAAAA,aAAa,CAACc,aAAd;AACAN,UAAAA,IAAI,CAAC7D,cAAL;AACH;AATC,OADmB;AAWtBmD,MAAAA,GAAG,EAAE;AAXiB,KAA7B;AAaH,GApJI;AAqJLnD,EAAAA,cArJK,4BAqJY;AACb,QAAMoE,KAAK,GAAGjG,EAAE,CAACkG,QAAH,CAAYC,QAAZ,EAAd;;AACA,SAAK,IAAIC,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGH,KAAK,CAACI,aAAlC,EAAiDD,KAAK,EAAtD,EAA0D;AACtD,UAAIE,OAAO,GAAGL,KAAK,CAACM,QAAN,CAAeH,KAAf,CAAd;;AACA,UAAIE,OAAO,CAAC7C,IAAR,CAAa+C,UAAb,CAAwB,IAAxB,CAAJ,EAAmC;AAC/B,YAAIF,OAAO,CAAC7C,IAAR,IAAgB,QAApB,EAA6B;AACzB6C,UAAAA,OAAO,CAACG,OAAR;AACH;AACJ;AACJ;AACJ;AA/JI,CAAT","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.VozBaseComponent,\n\n    properties: {\n        TopHome: cc.Node,\n        TopLogin: cc.Node,\n        lb_name: cc.Label,\n        lb_chip: cc.Label,\n        Avatar: cc.Sprite,\n        ALL : {\n            type: cc.Node,\n            default: []\n        },\n        SLOT: {\n            type: cc.Node,\n            default: []\n        },\n        MINI: {\n            type: cc.Node,\n            default: []\n        },\n        CASINO: {\n            type: cc.Node,\n            default: []\n        }\n    },\n    onLoad(){\n        Utils.loadRes(this.Avatar, \"images/avatar/\"+Config.getDefaultAvatar());\n        MiniGame.showIcon();\n        cc.isFirstTx = true;\n    },\n    onEnable(){\n        if(mm.isLogin){\n            this.TopHome.active = true;\n            this.TopLogin.active = false;\n        }else{\n            this.TopHome.active = false;\n            this.TopLogin.active = true;\n            this.resetAllGameUI();\n        }\n        mm.audio.playMusic();\n        if (mm.isLogin && cc.isFirstTx){\n            cc.isFirstTx = false;\n            var ui = this.getUIFromName(\"UITaiXiu\");\n            if (ui == null){\n                this._selectGame = \"taixiu\";\n                this.completeLoadUIGame(this._selectGame);\n            }\n        }\n    },\n    updateUserVariable(subChip) {\n        if(SmartFoxSDK.PortalController.ZoneInstance.mySelf){\n            this.lb_name.string = Utils.formatText(GameVariables.Poker.getDisplayName(SmartFoxSDK.PortalController.ZoneInstance.mySelf), 20);\n            this.lb_chip.string = Utils.addDotToNumber(GameVariables.Poker.getChip(SmartFoxSDK.PortalController.ZoneInstance.mySelf)-subChip);\n            let msg = SmartFoxSDK.PortalController.ZoneInstance.mySelf.getVariable(\"sysmsg\");\n            if(msg && msg.value){\n                let SystemMessage = this.node.getChildByName(\"content\").getChildByName(\"SystemMessage\");\n                let js = SystemMessage.getComponent(SystemMessage.name);\n                js.runMessage(msg.value);\n            }\n        }\n    },\n    onSelectGame(event, game){\n        this._selectGame = game;\n        cc._selectGameNode = event.currentTarget;\n        this.onLoadSubGame();\n        mm.audio.playButton();\n    },\n    onSelectTXGame(event, game) {\n        let user = GameVariables.Poker.getDisplayName(SmartFoxSDK.PortalController.ZoneInstance.mySelf);\n        var ret = cc.native.reflection.callStaticMethod(\"CocosBridge\",\n                                         \"openTXGame\",\n                                         \"token\",\n                                         user);\n\n    },\n    onSelectXDGame(event, game) {\n        let user = GameVariables.Poker.getDisplayName(SmartFoxSDK.PortalController.ZoneInstance.mySelf);\n        var ret = cc.native.reflection.callStaticMethod(\"CocosBridge\",\n                                         \"openXDGame\",\n                                         \"token\",\n                                         user);\n\n    },\n    onToggleCategoryGame(event){\n        mm.audio.playButton();\n        if(event.node.name == 'All'){\n            this._activeIconGame(this.ALL);\n        }else if(event.node.name == 'Slot'){\n            this._hideAllIconGame();\n            this._activeIconGame(this.SLOT);\n        }else if(event.node.name == 'MiniGame'){\n            this._hideAllIconGame();\n            this._activeIconGame(this.MINI);\n        }else if(event.node.name == 'Casino'){\n            this._hideAllIconGame();\n            this._activeIconGame(this.CASINO);\n        }\n    },\n    _hideAllIconGame(){\n        for(let i = 0; i < this.ALL.length;i++){\n            this.ALL[i].active = false;\n        }\n    },\n    _activeIconGame(list){\n        for(let i = 0; i < list.length;i++){\n            list[i].active = true;\n        }\n    },\n    onLoadSubGame(){\n        let game = this._selectGame;\n        if(mm.isLogin){\n            cc._selectGameNode.getChildByName(\"load\").active = true;\n            mm.Loading.show();\n            this.completeLoadUIGame(game);\n        }else{\n            this.show(\"UILogin\", {pop: true});\n        }\n    },\n    completeLoadUIGame(game){\n        let gameController = PortalManager.getGameController(game);\n        if(gameController)\n            gameController.loginZone(Config.getUsername(), Config.getPass());\n    },\n    onClickLogin(){\n        mm.audio.playButton();\n        this.show(\"UILogin\", {pop: true});\n    },\n    onClickRegister(){\n        mm.audio.playButton();\n        this.show(\"UIRegister\", {pop: true});\n    },\n    eventShowWarning(){\n        let self = this;\n        mm.audio.playButton();\n        UIManger.show('UIDialogTwo', {\n            data: {\n                content: \"Bạn có muốn đăng xuất không?\",\n                \"cbYes\": function cbYes() {\n                    self.TopHome.active = false;\n                    self.TopLogin.active = true;\n                    mm.isLogin = false;\n                    SmartFoxSDK.PortalController._reset();\n                    PortalManager.disconnectAll();\n                    self.resetAllGameUI();\n                }\n            }, pop: true\n        });\n    },\n    resetAllGameUI() {\n        const scene = cc.director.getScene();\n        for (let index = 0; index < scene.childrenCount; index++) {\n            let element = scene.children[index];\n            if (element.name.startsWith('UI')) {\n                if (element.name != \"UIHome\"){\n                    element.destroy();\n                }\n            }\n        }\n    }\n});\n"]}