{"version":3,"sources":["assets\\scripts\\tlmn\\PlayerTLMN.js"],"names":["cc","Class","Player","properties","preCard","Prefab","Hands","Node","CardUp","CardSize","Label","lbNoti","RichText","fontWin","Font","fontLose","onEnable","_super","node","active","sizeCard","isItMe","_desk","UserName","SmartFoxSDK","TLMNController","ZoneInstance","mySelf","name","getPosCardHand","newPos","v2","x","y","position","updateCardSize","size","string","addCardHand","cardIds","updatePosHand","undefined","onPreStartEvent","preStartRes","onStartEvent","startEvent","m_currentUser","time","m_userTime","setTotalProgress","setCurrentProgress","setTimeWarning","turnOnTimer","onTurnEvent","userTurnRes","Status","m_time","onFoldEvent","userFoldRes","Utils","loadRes","getComponent","Sprite","turnOffTimer","onGameFinishEvent","cardHands","chipWin","cb","showWinEffect","showMoneyWin","user","room","getUserByName","getDesk","money","GameVariables","getChip","setMoney","bind","fontTxt","MoneyWin","font","showBoLuot","showNoti","text","self","runAction","sequence","delayTime","moveTo","callFunc"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\r\n    extends: cc.Player,\r\n\r\n    properties: {\r\n        preCard: cc.Prefab,\r\n        Hands: cc.Node,\r\n        CardUp: cc.Node,\r\n        CardSize: cc.Label,\r\n        lbNoti: cc.RichText,\r\n        fontWin: cc.Font,\r\n        fontLose: cc.Font,\r\n    },\r\n    onEnable(){\r\n        this._super();\r\n        this.lbNoti.node.active = false;\r\n        this.sizeCard = 13;\r\n    },\r\n    isItMe(){\r\n        if(this._desk.UserName == SmartFoxSDK.TLMNController.ZoneInstance.mySelf.name){\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    getPosCardHand(){\r\n        if(this.newPos == 1){\r\n            return cc.v2(this.node.x - 100, this.node.y);\r\n        }else if(this.newPos == 2){\r\n            return cc.v2(this.node.x + 100, this.node.y);\r\n        }else if(this.newPos == 3){\r\n            return cc.v2(this.node.x + 100, this.node.y);\r\n        }\r\n        return this.node.position;\r\n    },\r\n    updateCardSize(size){\r\n        if(!this.isItMe()){\r\n            this.CardUp.active = true;\r\n            this.CardSize.string = size;\r\n        }\r\n    },\r\n    addCardHand(cardIds){\r\n    },\r\n    updatePosHand(){\r\n        if(this.newPos != undefined) {\r\n            if(this.newPos == 1){\r\n                this.CardUp.x = -100;\r\n            }else{\r\n                this.CardUp.x = 100;\r\n            }\r\n        }\r\n    },\r\n    onPreStartEvent(preStartRes){\r\n        this._super(preStartRes);\r\n        this.CardUp.active = false;\r\n    },\r\n    onStartEvent(startEvent){\r\n        if(startEvent.m_currentUser == this._desk.UserName){\r\n            let time = startEvent.m_userTime / 1000;\r\n            this.setTotalProgress(time);\r\n            this.setCurrentProgress(time);\r\n            this.setTimeWarning(5);\r\n            this.turnOnTimer();\r\n        }\r\n        this.sizeCard = 13;\r\n    },\r\n    onTurnEvent(userTurnRes){\r\n        this.Status.active = false;\r\n        let time = userTurnRes.m_time / 1000;\r\n        this.setTotalProgress(time);\r\n        this.setCurrentProgress(time);\r\n        this.setTimeWarning(5);\r\n        this.turnOnTimer();\r\n    },\r\n    onFoldEvent(userFoldRes){\r\n        Utils.loadRes(this.Status.getComponent(cc.Sprite), \"images/poker/PlayerStatus/fold-tag\");\r\n        this.turnOffTimer();\r\n    },\r\n    onGameFinishEvent(cardHands, chipWin, cb){\r\n        this.Status.active = false;\r\n        if(chipWin > 0){\r\n            this.showWinEffect();\r\n        }\r\n        this.showMoneyWin(chipWin, function () {\r\n            // update money\r\n            let user = SmartFoxSDK.TLMNController.room.getUserByName(this.getDesk().UserName);\r\n            let money = GameVariables.getChip(user);\r\n            this.setMoney(money);\r\n            if (cb)\r\n                cb();\r\n        }.bind(this));\r\n    },\r\n    showMoneyWin(money, cb) {\r\n        let fontTxt = money > 0? this.fontWin: this.fontLose;\r\n        this.MoneyWin.font   = fontTxt;\r\n        this._super(money, cb);\r\n    },\r\n    showBoLuot() {\r\n        this.showNoti(\"Bỏ lượt\");\r\n    },\r\n    showNoti(text) {\r\n        let self = this;\r\n        this.lbNoti.string      = text;\r\n        this.lbNoti.node.active = true;\r\n        this.lbNoti.node.y      = 0;\r\n        this.lbNoti.node.runAction(\r\n            cc.sequence(\r\n                cc.delayTime(0.5),\r\n                cc.moveTo(1.5, cc.v2(0, 100)),\r\n                cc.callFunc(function () {\r\n                    self.lbNoti.node.active = false;\r\n                })\r\n            )\r\n        );\r\n    }\r\n});\r\n"]}