{"version":3,"sources":["assets\\scripts\\tlmn\\TLMNController.js"],"names":["TLMNEvent","require","TLMNController","SmartFoxSDK","BaseController","extend","m_tableInfo","registerEvents","_super","ZoneInstance","addEventListenerExtension","CasinoEvent","RESPONSE_NAME","GROUP_GAME_RES","onGroupRoomEvent","QUICK_JOIN_GAME_RES","onQuickJoinRoom","SIT_ON_RES","onUserSitOn","SIT_OUT_RES","onUserSitOut","STAND_UP_RES","onUserStandUp","PRE_START_RES","onPreStart","START_RES","onStartEvent","FIRE_RES","onUserFire","KICK_RES","onKickUser","FINISH_GAME_RES","onFinishGame","LOAD_TABLE_RES","onLoadTableEvent","FOLD_RES","onUserFold","USER_TURN_RES","onUserTurn","NEW_ROUND","onNewRound","removeEvents","removeEventListenerExtension","onEventUserExitRoom","event","user","isItMe","getUI","node","active","UIManger","show","pop","data","game","zoneName","removePlayer","name","onEventLogin","groupRequest","CasinoRequest","GroupGameRequest","setGame","send","toSRequest","getUILobby","scene","cc","director","getScene","uiLobby","find","getComponent","onLeaderBoardEvent","arrLeaderboard","getSArray","i","size","sItem","get","getObject","item","session","account","getUtfString","win","getDouble","push","updateRank","groupRoom","GroupGameEvent","fromEvent","mm","undefined","groups","displayname","GameVariables","getDisplayName","mySelf","chip","getChip","request","LeaderBoardRequest","quickJoin","QuickJoinGameEvent","roomId","JoinRoomRequest","Toast","showToast","_data","room","preLoadUI","Loading","hide","controller","setInfoTable","id","Utils","formatCurrency","Poker","getBetChip","LoadTableInfoEvent","m_isGameStart","m_listActiveUserName","indexOf","requestSitOn","_updateNodePlayers","m_listDesk","m_isPrestart","setWaitingTimer","bind","userSitOnEvent","UserSitOnEvent","desk","DeskId","m_deskId","UserName","m_userName","DeskState","m_deskState","UserChip","m_buyIn","m_listUser","sitOutRes","UserSitOutEvent","indexUser","m_listUserSitOut","m_username","m_isSitOut","splice","player","_getJSPlayerByName","setSitOut","preStart","PreStartEvent","m_prestartTime","length","_getJSPlayerById","onPreStartEvent","newMatch","requestLeaveRoom","showDeskEmpty","self","start","StartEvent","m_currentUser","m_userTime","userOut","_dealCards","m_listCard","showAllButtonAction","jsPlayer","hideDeskEmpty","turnOffAllTimerPlayers","userTurnRes","UserTurnEvent","m_time","deskId","_getPlayerId","onTurnEvent","isNoNeedTurn","hideAllButtonAction","log","newRound","userFoldRes","UserFoldEvent","resetLastCard","onFoldEvent","userFireRes","FireEvent","err","m_cards","processUserFire","showEffectTypeFire","m_type","finishGameRes","FinishGameEvent","onGameFinishEvent","m_listHandCard","m_listChipWin","typePerfect","showEffectWinWhite","kickRes","KickUserEvent","m_resType","onPublicMessage","sender","msg","message","dataSender","dn","fb","msgItem","instance","getInstance","module","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["let TLMNEvent = require('TLMNEvent')\r\nlet TLMNController = SmartFoxSDK.BaseController.extend({\r\n    m_tableInfo: null,\r\n    registerEvents(){\r\n        this._super();\r\n        this.ZoneInstance.addEventListenerExtension(CasinoEvent.RESPONSE_NAME.GROUP_GAME_RES, this.onGroupRoomEvent, this);\r\n        this.ZoneInstance.addEventListenerExtension(CasinoEvent.RESPONSE_NAME.QUICK_JOIN_GAME_RES, this.onQuickJoinRoom, this);\r\n\r\n        this.ZoneInstance.addEventListenerExtension(TLMNEvent.RESPONSE_NAME.SIT_ON_RES, this.onUserSitOn, this);\r\n        this.ZoneInstance.addEventListenerExtension(TLMNEvent.RESPONSE_NAME.SIT_OUT_RES, this.onUserSitOut, this);\r\n        this.ZoneInstance.addEventListenerExtension(TLMNEvent.RESPONSE_NAME.STAND_UP_RES, this.onUserStandUp, this);\r\n        this.ZoneInstance.addEventListenerExtension(TLMNEvent.RESPONSE_NAME.PRE_START_RES, this.onPreStart, this);\r\n        this.ZoneInstance.addEventListenerExtension(TLMNEvent.RESPONSE_NAME.START_RES, this.onStartEvent, this);\r\n        this.ZoneInstance.addEventListenerExtension(TLMNEvent.RESPONSE_NAME.FIRE_RES, this.onUserFire, this);\r\n        this.ZoneInstance.addEventListenerExtension(TLMNEvent.RESPONSE_NAME.KICK_RES, this.onKickUser, this);\r\n        this.ZoneInstance.addEventListenerExtension(TLMNEvent.RESPONSE_NAME.FINISH_GAME_RES, this.onFinishGame, this);\r\n        this.ZoneInstance.addEventListenerExtension(TLMNEvent.RESPONSE_NAME.LOAD_TABLE_RES, this.onLoadTableEvent, this);\r\n        this.ZoneInstance.addEventListenerExtension(TLMNEvent.RESPONSE_NAME.FOLD_RES, this.onUserFold, this);\r\n        this.ZoneInstance.addEventListenerExtension(TLMNEvent.RESPONSE_NAME.USER_TURN_RES, this.onUserTurn, this);\r\n        this.ZoneInstance.addEventListenerExtension(TLMNEvent.RESPONSE_NAME.NEW_ROUND, this.onNewRound, this);\r\n    },\r\n    removeEvents(){\r\n        this._super();\r\n        this.ZoneInstance.removeEventListenerExtension(CasinoEvent.RESPONSE_NAME.GROUP_GAME_RES, this.onGroupRoomEvent, this);\r\n        this.ZoneInstance.removeEventListenerExtension(CasinoEvent.RESPONSE_NAME.QUICK_JOIN_GAME_RES, this.onQuickJoinRoom, this);\r\n\r\n        this.ZoneInstance.removeEventListenerExtension(TLMNEvent.RESPONSE_NAME.SIT_ON_RES, this.onUserSitOn, this);\r\n        this.ZoneInstance.removeEventListenerExtension(TLMNEvent.RESPONSE_NAME.SIT_OUT_RES, this.onUserSitOut, this);\r\n        this.ZoneInstance.removeEventListenerExtension(TLMNEvent.RESPONSE_NAME.STAND_UP_RES, this.onUserStandUp, this);\r\n        this.ZoneInstance.removeEventListenerExtension(TLMNEvent.RESPONSE_NAME.PRE_START_RES, this.onPreStart, this);\r\n        this.ZoneInstance.removeEventListenerExtension(TLMNEvent.RESPONSE_NAME.START_RES, this.onStartEvent, this);\r\n        this.ZoneInstance.removeEventListenerExtension(TLMNEvent.RESPONSE_NAME.FIRE_RES, this.onUserFire, this);\r\n        this.ZoneInstance.removeEventListenerExtension(TLMNEvent.RESPONSE_NAME.KICK_RES, this.onKickUser, this);\r\n        this.ZoneInstance.removeEventListenerExtension(TLMNEvent.RESPONSE_NAME.FINISH_GAME_RES, this.onFinishGame, this);\r\n        this.ZoneInstance.removeEventListenerExtension(TLMNEvent.RESPONSE_NAME.LOAD_TABLE_RES, this.onLoadTableEvent, this);\r\n        this.ZoneInstance.removeEventListenerExtension(TLMNEvent.RESPONSE_NAME.FOLD_RES, this.onUserFold, this);\r\n        this.ZoneInstance.removeEventListenerExtension(TLMNEvent.RESPONSE_NAME.USER_TURN_RES, this.onUserTurn, this);\r\n        this.ZoneInstance.removeEventListenerExtension(TLMNEvent.RESPONSE_NAME.NEW_ROUND, this.onNewRound, this);\r\n    },\r\n    onEventUserExitRoom(event){\r\n        let user = event.user;\r\n        if(user.isItMe){\r\n            if (this.getUI() != null)\r\n                this.getUI().node.active = false;\r\n            UIManger.show(\"UILobby\", {pop: true, data: {game: this.zoneName, ZoneInstance: this.ZoneInstance}});\r\n        }else{\r\n            this.getUI().removePlayer([user.name]);\r\n        }\r\n    },\r\n    onEventLogin(event){\r\n        this._super(event);\r\n        let groupRequest = new CasinoRequest.GroupGameRequest();\r\n        groupRequest.setGame(this.zoneName);\r\n        this.ZoneInstance.send(groupRequest.toSRequest());\r\n    },\r\n    getUILobby(){\r\n        const scene = cc.director.getScene();\r\n        let uiLobby =  cc.find(\"UILobby\", scene);\r\n        return uiLobby.getComponent(uiLobby.name);\r\n    },\r\n    onLeaderBoardEvent(event){\r\n        let arrLeaderboard =[];\r\n        let data = event.getSArray(\"d\");\r\n        for(let i = 0;i < data.size();i++){\r\n            let sItem = data.get(i).getObject();\r\n            let item = {};\r\n            item.session = i +1;\r\n            item.account = sItem.getUtfString(\"dn\");\r\n            item.win = sItem.getDouble(\"m\");\r\n            arrLeaderboard.push(item);\r\n        }\r\n        if(this.getUILobby()){\r\n            this.getUILobby().updateRank(arrLeaderboard);\r\n        }\r\n    },\r\n    onGroupRoomEvent(event){\r\n        let groupRoom = new CasinoEvent.GroupGameEvent().fromEvent(event);\r\n        if(mm.game == undefined)\r\n            mm.game = {};\r\n        mm.game[this.zoneName] = {};\r\n        mm.game[this.zoneName].groups = groupRoom.groups;\r\n        mm.game[this.zoneName].displayname = GameVariables.getDisplayName(this.ZoneInstance.mySelf);\r\n        mm.game[this.zoneName].chip = GameVariables.getChip(this.ZoneInstance.mySelf);\r\n        UIManger.show(\"UILobby\", {pop: true, data: {game: \"tlmn\", ZoneInstance: this.ZoneInstance}}, function () {\r\n            let request = new CasinoRequest.LeaderBoardRequest();\r\n            SmartFoxSDK.TLMNController.ZoneInstance.send(request.toSRequest());\r\n        });\r\n    },\r\n    onQuickJoinRoom(event){\r\n        let quickJoin = new CasinoEvent.QuickJoinGameEvent().fromEvent(event);\r\n        if(quickJoin.roomId >= 0){\r\n            this.ZoneInstance.send(new CasinoRequest.JoinRoomRequest(quickJoin.roomId, \"1\", true).toSRequest());\r\n        }else{\r\n            mm.Toast.showToast(1, \"Phòng đã đầy vui vòng chọn phòng khác\");\r\n        }\r\n    },\r\n    onEventUserExitRoom(event){\r\n        let user = event.user;\r\n        if(user.isItMe){\r\n            if (this.getUI() != null)\r\n                this.getUI().node.active = false;\r\n            UIManger.show(\"UILobby\", {pop: true, data: {game: \"tlmn\", ZoneInstance: this.ZoneInstance}});\r\n        }else{\r\n            this.getUI().removePlayer([user.name]);\r\n        }\r\n    },\r\n    onLoadTableEvent(event){\r\n        let _data = {pop: true, data: {room: this.room}};\r\n        this.preLoadUI(_data, function () {\r\n            mm.Loading.hide();\r\n            this.getUI().controller = this;\r\n            this.getUI().setInfoTable(\"TLMN / #\"+this.room.id, Utils.formatCurrency(GameVariables.Poker.getBetChip(this.room)));\r\n            this.m_tableInfo = new TLMNEvent.LoadTableInfoEvent().fromEvent(event);\r\n            this.m_tableInfo.room = this.room;\r\n            if(!this.m_tableInfo.m_isGameStart || this.m_tableInfo.m_listActiveUserName.indexOf(this.ZoneInstance.mySelf.name) < 0){\r\n                this.getUI().requestSitOn();\r\n            }\r\n            this.getUI()._updateNodePlayers(this.m_tableInfo.m_listDesk);\r\n            if(this.m_tableInfo.m_isPrestart && !this.m_tableInfo.m_isGameStart){\r\n                this.getUI().setWaitingTimer(true, 5, this.m_tableInfo.m_isPrestart / 100);\r\n            }\r\n        }.bind(this));\r\n    },\r\n    onUserSitOn(event){\r\n        let userSitOnEvent = new TLMNEvent.UserSitOnEvent().fromEvent(event);\r\n        // add to list desk\r\n        let desk = {};\r\n        desk.DeskId = userSitOnEvent.m_deskId;\r\n        desk.UserName = userSitOnEvent.m_userName;\r\n        desk.DeskState = userSitOnEvent.m_deskState;\r\n        desk.UserChip = userSitOnEvent.m_buyIn;\r\n        this.m_tableInfo.m_listDesk.push(desk);\r\n\r\n        // add to list user\r\n        this.m_tableInfo.m_listUser.push(userSitOnEvent.m_userName);\r\n\r\n\r\n        this.getUI()._updateNodePlayers(this.m_tableInfo.m_listDesk);\r\n    },\r\n    onUserSitOut(event){\r\n        mm.Loading.hide();\r\n        let sitOutRes = new TLMNEvent.UserSitOutEvent().fromEvent(event);\r\n        let indexUser = this.m_tableInfo.m_listUserSitOut.indexOf(sitOutRes.m_username);\r\n        if(indexUser < 0){\r\n            this.m_tableInfo.m_listUserSitOut.push(sitOutRes.m_username);\r\n        }else if(!sitOutRes.m_isSitOut){\r\n            this.m_tableInfo.m_listUserSitOut.splice(indexUser, 1);\r\n        }\r\n        let player = this.getUI()._getJSPlayerByName(sitOutRes.m_username);\r\n        if(player)\r\n            player.setSitOut(sitOutRes.m_isSitOut);\r\n        if(this.ZoneInstance.mySelf.name == sitOutRes.m_username){\r\n            if(sitOutRes.m_isSitOut)\r\n                mm.Toast.showToast(1, \"Đăng ký rời bàn!\");\r\n            else\r\n                mm.Toast.showToast(1, \"Hủy rời bàn!\");\r\n        }\r\n    },\r\n    onPreStart(event){\r\n        let preStart = new TLMNEvent.PreStartEvent().fromEvent(event);\r\n        this.m_tableInfo.m_isPrestart = preStart.m_isPrestart;\r\n        this.m_tableInfo.m_prestartTime = preStart.m_prestartTime;\r\n        this.m_tableInfo.m_isGameStart = false;\r\n        for(let i = 0; i < this.m_tableInfo.m_listDesk.length;i++){\r\n            let desk = this.m_tableInfo.m_listDesk[i];\r\n            let player = this.getUI()._getJSPlayerById(desk.DeskId);\r\n            if(player)\r\n                player.onPreStartEvent(preStart);\r\n        }\r\n        if(preStart.m_isPrestart){\r\n            this.getUI().setWaitingTimer(true,preStart.m_prestartTime / 1000, preStart.m_prestartTime / 1000);\r\n            this.getUI().newMatch();\r\n        }\r\n        // remove me if register leave table\r\n        if(this.m_tableInfo.m_listUserSitOut.indexOf(this.ZoneInstance.mySelf.name) >= 0){\r\n            this.getUI().requestLeaveRoom();\r\n        }\r\n        this.getUI().showDeskEmpty();\r\n    },\r\n    onStartEvent(event){\r\n        this.getUI().setWaitingTimer(false);\r\n        let self = this;\r\n        let start = new TLMNEvent.StartEvent().fromEvent(event);\r\n        this.m_tableInfo.m_currentUser =  start.m_currentUser;\r\n        this.m_tableInfo.m_userTime = start.m_userTime;\r\n        this.m_tableInfo.m_isGameStart = true;\r\n        if(this.m_tableInfo.m_listActiveUserName){\r\n            let userOut = [];\r\n            for(let i = 0; i < this.m_tableInfo.m_listActiveUserName.length;i++){\r\n                if(start.m_listActiveUserName.indexOf(this.m_tableInfo.m_listActiveUserName[i]) < 0){\r\n                    userOut.push(this.m_tableInfo.m_listActiveUserName[i]);\r\n                }\r\n            }\r\n            this.getUI().removePlayer(userOut);\r\n        }\r\n        this.m_tableInfo.m_listActiveUserName = start.m_listActiveUserName;\r\n        this.getUI()._updateNodePlayers(this.m_tableInfo.m_listDesk);\r\n        this.getUI()._dealCards(this.m_tableInfo.m_listDesk, start.m_listCard, function () {\r\n            if(self.ZoneInstance.mySelf.name == self.m_tableInfo.m_currentUser){\r\n                self.getUI().showAllButtonAction();\r\n            }\r\n        });\r\n        for(let i = 0; i < this.m_tableInfo.m_listDesk.length;i++){\r\n            let desk = this.m_tableInfo.m_listDesk[i];\r\n            let jsPlayer = this.getUI()._getJSPlayerById(desk.DeskId);\r\n            jsPlayer.onStartEvent(start);\r\n        }\r\n        this.getUI().hideDeskEmpty();\r\n    },\r\n    onUserTurn(event){\r\n        this.getUI().turnOffAllTimerPlayers();\r\n        let userTurnRes = new TLMNEvent.UserTurnEvent().fromEvent(event);\r\n        this.m_tableInfo.m_currentUser = userTurnRes.m_username;\r\n        this.m_tableInfo.m_userTime = userTurnRes.m_time;\r\n        let deskId = this.getUI()._getPlayerId(userTurnRes.m_username);\r\n        let player = this.getUI()._getJSPlayerById(deskId);\r\n        if(player){\r\n            player.onTurnEvent(userTurnRes);\r\n            if(player.isItMe() || this.getUI().isNoNeedTurn()){\r\n                // show action\r\n                this.getUI().showAllButtonAction();\r\n            }else{\r\n                this.getUI().hideAllButtonAction();\r\n            }\r\n        }\r\n    },\r\n    onNewRound(event){\r\n        cc.log('onNewRound');\r\n        this.getUI().newRound();\r\n    },\r\n    onUserFold(event){\r\n        let userFoldRes = new TLMNEvent.UserFoldEvent().fromEvent(event);\r\n        let player      = this.getUI()._getJSPlayerByName(userFoldRes.m_username);\r\n        this.getUI().resetLastCard();\r\n        if(player){\r\n            player.onFoldEvent(userFoldRes);\r\n            if(player.isItMe()){\r\n                this.getUI().hideAllButtonAction();\r\n            }\r\n        }\r\n    },\r\n    onUserFire(event){\r\n        cc.log('onUserFire');\r\n        let userFireRes = new TLMNEvent.FireEvent().fromEvent(event);\r\n        if(userFireRes.err){\r\n            mm.Toast.showToast(1, userFireRes.err);\r\n            return;\r\n        }\r\n        let m_username = userFireRes.m_username;\r\n        let m_cards = userFireRes.m_cards;\r\n        let player = this.getUI()._getJSPlayerByName(m_username);\r\n        if(player){\r\n            this.getUI().processUserFire(m_cards, player.node);\r\n            this.getUI().showEffectTypeFire(userFireRes.m_type);\r\n        }\r\n    },\r\n    onFinishGame(event){\r\n        this.getUI().turnOffAllTimerPlayers();\r\n        this.getUI().hideAllButtonAction();\r\n        let finishGameRes = new TLMNEvent.FinishGameEvent().fromEvent(event);\r\n        for(let i = 0; i < finishGameRes.m_listActiveUserName.length;i++){\r\n            let name = finishGameRes.m_listActiveUserName[i];\r\n            let player = this.getUI()._getJSPlayerByName(name);\r\n            if(player){\r\n                player.onGameFinishEvent(finishGameRes.m_listHandCard[i],finishGameRes.m_listChipWin[i], function () {\r\n                    this.getUI().newMatch();\r\n                }.bind(this));\r\n            }\r\n        }\r\n        if(finishGameRes.typePerfect > 0){\r\n            this.getUI().showEffectWinWhite(finishGameRes.typePerfect);\r\n        }\r\n    },\r\n    onUserStandUp(event){\r\n\r\n    },\r\n    onKickUser(event){\r\n        let kickRes = new TLMNEvent.KickUserEvent().fromEvent(event);\r\n        if(kickRes.m_resType == 2){\r\n            if(this.getUI()._getJSPlayerByName(kickRes.m_username) != null){\r\n                this.getUI().removePlayer([kickRes.m_username]);\r\n                if(this.ZoneInstance.mySelf.name == kickRes.m_username){\r\n                    this.getUI().requestLeaveRoom();\r\n                }\r\n            }\r\n        }\r\n    },\r\n    onPublicMessage(event){\r\n        let sender = event.sender;\r\n        let msg = event.message;\r\n        let data = event.data;\r\n        let dataSender = data != null ? {dn: data.get(\"dn\"), fb : data.get(\"fb\")} : {dn: \"...\", fb : \"\"};\r\n        let msgItem = {};\r\n        msgItem.sender = sender;\r\n        msgItem.msg = msg;\r\n        msgItem.dataSender = dataSender;\r\n        this.getUI().onPublicMessage(msgItem);\r\n    },\r\n});\r\nlet instance = null;\r\nlet getInstance = function () {\r\n    if(instance == null)\r\n        instance = new TLMNController('UITLMN','tlmn');\r\n    return instance;\r\n}\r\nSmartFoxSDK.TLMNController = module.exports = getInstance();\r\n"]}